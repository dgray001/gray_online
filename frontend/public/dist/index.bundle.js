(()=>{"use strict";var e={59:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(81),i=o.n(n),s=o(645),r=o.n(s)()(i());r.push([e.id,"dwg-chatbox{--input-box-height: 35px;background-color:#c8c8c8;color:#000;display:block;height:100%;width:100%}dwg-chatbox #chat-container{display:flex;flex-flow:column nowrap;height:calc(100% - var(--input-box-height));overflow-wrap:anywhere;overflow-y:scroll;width:100%;word-break:break-all}dwg-chatbox #chat-container :first-child{margin-top:auto}dwg-chatbox #chat-container>*{margin-top:.3em}dwg-chatbox #chat-container>.color-gray{color:#646464}dwg-chatbox #input-container{--margin: 8px;--send-button-width: 70px;display:flex;flex-flow:row nowrap;height:var(--input-box-height);width:100%}dwg-chatbox #input-container>*{box-sizing:border-box;height:calc(100% - var(--margin));margin-top:var(--margin)}dwg-chatbox #input-container #chat-input{width:calc(100% - var(--send-button-width))}dwg-chatbox #input-container #send-chat{width:var(--send-button-width)}",""]);const a=r},630:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(81),i=o.n(n),s=o(645),r=o.n(s)()(i());r.push([e.id,".dwg-element:not(.parsed){display:none}",""]);const a=r},713:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(81),i=o.n(n),s=o(645),r=o.n(s)()(i());r.push([e.id,"dwg-fiddlesticks #table-container{background-color:#8c4614;height:50%;position:relative;width:100%}dwg-fiddlesticks #table-container #header-message{display:flex;flex-flow:row wrap;gap:3em;left:1em;position:absolute;top:1em}dwg-fiddlesticks #table-container #trump-card-container{--width: calc(max(50px, min(200px, 15vw)));--height: calc(1.5em + var(--card-image-scale) * var(--width));height:var(--height);line-height:1.5em;position:absolute;right:calc(50% - .5*var(--width));text-align:center;top:calc(50% - .5*var(--height))}dwg-fiddlesticks #table-container #trump-card-container #trump-card{border:1px solid #000;border-radius:calc(.05*var(--width));height:calc(var(--card-image-scale)*var(--width));position:absolute;right:calc(50% - .5*var(--width));width:var(--width)}dwg-fiddlesticks #player-container{background-color:#5a5a5a;display:flex;flex-flow:row nowrap;gap:3px;height:50%;width:100%}dwg-fiddlesticks #player-container>*{border:1px solid #000;height:100%;max-width:16vw}",""]);const a=r},494:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(81),i=o.n(n),s=o(645),r=o.n(s)()(i());r.push([e.id,"",""]);const a=r},415:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(81),i=o.n(n),s=o(645),r=o.n(s)()(i());r.push([e.id,"dwg-game{--card-image-scale: 1.452;--header-height: 1.5em;background-color:#000}dwg-game #header{background-color:#323232;display:flex;flex-flow:row nowrap;height:var(--header-height);max-height:var(--header-height);min-height:var(--header-height);width:100%}dwg-game #header *{line-height:var(--header-height)}dwg-game #header #client-name{margin-left:1em}dwg-game #header #room-name,dwg-game #header #game-name{margin-left:3em}dwg-game #header #button-container{align-items:center;display:flex;flex-flow:row nowrap;gap:1px;justify-content:center;margin-left:auto;margin-right:4px}dwg-game #header #button-container button{border-radius:0;height:var(--header-height);width:var(--header-height)}dwg-game #waiting-room{align-items:center;background-color:#964007;display:flex;height:calc(100% - var(--header-height));justify-content:center}dwg-game #waiting-room.hide{display:none}dwg-game #waiting-room .player-waiting{display:flex;flex-flow:row nowrap;font-size:18px;gap:1em;margin:.3em 0}dwg-game #waiting-room .player-waiting :last-child{margin-left:auto}dwg-game #waiting-room .player-waiting .connected{color:#64ff64}dwg-game #game-container{height:calc(100% - var(--header-height))}dwg-game #game-container:not(.show){display:none}dwg-game #chatbox-container{background-color:rgba(0,0,0,0);height:80vh;left:1em;position:absolute;top:10vh;width:50vw}dwg-game #chatbox-container:not(.showing){pointer-events:none}dwg-game #chatbox-container #chatbox:not(.show){display:none}",""]);const a=r},732:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(81),i=o.n(n),s=o(645),r=o.n(s)()(i());r.push([e.id,"dwg-lobby{--name-header-height: 30px;--buttons-height: 50px;--chat-height: 200px;background-color:#143c78;display:flex;flex-flow:column nowrap}dwg-lobby.hide{display:none}dwg-lobby #page-header{background-color:#001e3c;box-sizing:border-box;display:block;font-size:18px;height:var(--name-header-height);line-height:var(--name-header-height);max-height:var(--name-header-height);min-height:var(--name-header-height);padding-left:1.5em;width:100%}dwg-lobby #page-header #ping-container{margin-left:2em}dwg-lobby #buttons{background-color:#0a3264;border-bottom:2px solid #000;box-sizing:border-box;display:flex;flex-flow:row nowrap;gap:8px;height:var(--buttons-height);max-height:var(--buttons-height);min-height:var(--buttons-height);width:100%}dwg-lobby #buttons>button{background-color:rgba(0,0,0,0);border:none;border-radius:16px;color:#fff;font-size:20px;padding:8px;transition:background-color 200ms,border-radius 200ms}dwg-lobby #buttons>button:hover:not(:disabled){background-color:rgba(50,100,200,.2)}dwg-lobby #buttons>button:active:not(:disabled){background-color:rgba(70,140,250,.4);border-radius:0px}dwg-lobby #buttons>button:disabled{background-color:rgba(150,150,150,.6);border-radius:8px;transition:none}dwg-lobby #horizontal-container{display:flex;flex-flow:row nowrap;flex:1 0 0;width:100%}dwg-lobby #horizontal-container #vertical-container{display:flex;flex-flow:column nowrap;flex:1 0 0;height:100%}dwg-lobby #horizontal-container #vertical-container #lobby-rooms{box-sizing:border-box;flex:1 0 0;padding:12px}dwg-lobby #horizontal-container #vertical-container #chatbox{box-sizing:border-box;height:var(--chat-height);max-height:var(--chat-height);min-height:var(--chat-height);padding:12px}dwg-lobby #horizontal-container #lobby-users{background-color:#0a1e32;box-sizing:border-box;height:100%;padding:8px;width:250px}dwg-lobby #lobby-room-wrapper{background-color:rgba(150,150,150,.5);bottom:0;left:0;position:absolute;right:0;top:0}dwg-lobby #lobby-room-wrapper:not(.show){display:none}dwg-lobby #lobby-room-wrapper #lobby-room{box-sizing:border-box;height:70vh;margin:15vh auto;padding:8px;width:70vw}",""]);const a=r},11:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(81),i=o.n(n),s=o(645),r=o.n(s)()(i());r.push([e.id,"dwg-lobby-connector{background-color:rgba(120,120,120,.8);height:100%;left:0px;position:absolute;top:0px;width:100%;z-index:2}dwg-lobby-connector.hide{display:none}dwg-lobby-connector #card{background-color:#dcdcdc;color:#000;height:200px;left:calc(50% - 100px);padding:16px;position:relative;top:calc(50% - 150px);width:300px}dwg-lobby-connector #card #nickname{font-size:24px;margin-top:20px;width:290px}dwg-lobby-connector #card #connect-button{font-size:24px;margin-top:50px;width:290px}",""]);const a=r},923:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(81),i=o.n(n),s=o(645),r=o.n(s)()(i());r.push([e.id,"dwg-lobby-game-settings{background-color:rgba(150,150,150,.4);bottom:0;left:0;position:absolute;right:0;top:0}dwg-lobby-game-settings:not(.show){display:none}dwg-lobby-game-settings #game-settings-wrapper{background-color:#d3d3d3;box-sizing:border-box;color:#000;display:flex;flex-flow:column nowrap;gap:12px;height:50vh;margin:25vh auto;padding:8px;width:50vw}dwg-lobby-game-settings #game-settings-wrapper *{font-size:18px;line-height:18px}dwg-lobby-game-settings #game-settings-wrapper .row-wrapper{display:flex;flex-flow:row nowrap;gap:8px}dwg-lobby-game-settings #game-settings-wrapper .row-wrapper>*{flex:1 0 0}",""]);const a=r},991:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(81),i=o.n(n),s=o(645),r=o.n(s)()(i());r.push([e.id,"dwg-lobby-room{background-color:#5ab4fa;box-shadow:0px 0px 3px 4px rgba(70,140,210,.8),0px 0px 6px 8px rgba(50,100,170,.8),0px 0px 9px 12px rgba(30,60,130,.8);display:flex;flex-flow:column nowrap;gap:8px}dwg-lobby-room:not(.show){display:none}dwg-lobby-room #room-header{background-color:#3c78d2;display:flex;flex-flow:row nowrap;height:36px;width:100%}dwg-lobby-room #room-header #room-name{flex:1 0 0;font-size:24px;height:100%;line-height:36px;padding-left:8px}dwg-lobby-room #room-header #room-name:not(.show){display:none}dwg-lobby-room #room-header #rename-input{box-sizing:border-box;flex:1 0 0;font-size:24px;height:100%;line-height:36px;padding-left:8px}dwg-lobby-room #room-header #rename-input:not(.show){display:none}dwg-lobby-room #room-header #rename-room:not(.show){display:none}dwg-lobby-room #room-header #cancel-rename{font-size:18px;width:80px}dwg-lobby-room #room-header #cancel-rename:not(.show){display:none}dwg-lobby-room #room-header>button{background-color:rgba(0,0,0,0);border:none;border-radius:6px;height:100%;margin:0px;padding:0px;width:36px}dwg-lobby-room #room-header>button:hover{background-color:rgba(220,220,220,.5)}dwg-lobby-room #room-header>button:active{background-color:rgba(220,220,220,.8)}dwg-lobby-room #room-body{display:flex;flex-flow:row nowrap;flex:1 0 0;width:100%}dwg-lobby-room #room-body #left-panel{background-color:#1e5ab4;display:flex;flex-flow:column nowrap;flex:0 0 320px;height:100%}dwg-lobby-room #room-body #left-panel #game-settings{box-sizing:border-box;flex:3 0 0;height:100%;overflow-y:auto;padding:8px 12px 0px;width:100%}dwg-lobby-room #room-body #left-panel #game-settings>*{box-sizing:border-box;min-height:1em;padding:4px;width:100%}dwg-lobby-room #room-body #left-panel #game-settings .settings-small{font-size:14px;line-height:14px}dwg-lobby-room #room-body #left-panel #game-settings .settings-medium{font-size:16px;line-height:16px}dwg-lobby-room #room-body #left-panel #game-settings .settings-large{font-size:18px;line-height:18px;margin-top:12px}dwg-lobby-room #room-body #left-panel #game-settings #settings-button-container{display:flex;flex-flow:row nowrap;gap:12px;margin-bottom:12px}dwg-lobby-room #room-body #left-panel #game-settings #settings-button-container.hide{display:none}dwg-lobby-room #room-body #left-panel #game-settings #settings-button-container .settings-button{font-size:18px;line-height:18px;height:30px;width:90px}dwg-lobby-room #room-body #left-panel #game-settings #settings-button-container .settings-button#settings-settings-button{background:linear-gradient(0deg, rgb(140, 140, 140), rgb(220, 220, 220));margin-left:auto}dwg-lobby-room #room-body #left-panel #game-settings #settings-button-container .settings-button#settings-launch-button{background:linear-gradient(0deg, rgb(40, 150, 40), rgb(80, 250, 80));margin-right:auto}dwg-lobby-room #room-body #left-panel #game-settings #settings-button-container .settings-button#settings-launch-button.launching{background:linear-gradient(0deg, rgb(50, 120, 50), rgb(100, 200, 100))}dwg-lobby-room #room-body #left-panel #user-list{background-color:rgba(220,220,220,.3);display:flex;flex-flow:column nowrap;flex:2 0 0}dwg-lobby-room #room-body #left-panel #user-list .container-label{background-color:rgba(220,220,220,.4);font-size:20px;height:24px;line-height:24px;margin-bottom:2px;margin-top:6px;padding:6px 12px 0px}dwg-lobby-room #room-body #left-panel #user-list .room-user{--user-height: 22px;display:flex;flex-flow:row nowrap;font-size:18px;gap:6px;height:var(--user-height);line-height:var(--user-height);padding:3px 6px;user-select:none}dwg-lobby-room #room-body #left-panel #user-list .room-user:hover{background-color:rgba(255,255,255,.2)}dwg-lobby-room #room-body #left-panel #user-list .room-user:hover>button{visibility:visible}dwg-lobby-room #room-body #left-panel #user-list .room-user :nth-child(2){margin-left:auto}dwg-lobby-room #room-body #left-panel #user-list .room-user>button{background-color:rgba(220,220,220,.5);border:none;border-radius:4px;display:inline-block;height:var(--user-height);margin:0px;padding:0px;visibility:hidden;width:var(--user-height)}dwg-lobby-room #room-body #left-panel #user-list .room-user>button:hover{background-color:rgba(250,250,250,.6)}dwg-lobby-room #room-body #left-panel #user-list .room-user>button:active{background-color:rgba(255,255,255,.7)}dwg-lobby-room #room-body #chatbox{box-sizing:border-box;flex:1 0 0;padding:8px}dwg-lobby-room #kick-img,dwg-lobby-room #promote-img,dwg-lobby-room #viewer-img,dwg-lobby-room #player-img{display:none}",""]);const a=r},562:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(81),i=o.n(n),s=o(645),r=o.n(s)()(i());r.push([e.id,"dwg-lobby-rooms>.lobby-room{font-size:18px;height:26px;line-height:26px;padding:2px;user-select:none;width:100%}dwg-lobby-rooms>.lobby-room:hover{background-color:rgba(180,180,180,.15)}dwg-lobby-rooms>.lobby-room:active{background-color:rgba(180,180,180,.3)}",""]);const a=r},391:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(81),i=o.n(n),s=o(645),r=o.n(s)()(i());r.push([e.id,"dwg-lobby-users{display:flex;flex-flow:column nowrap}dwg-lobby-users #header{height:36px}dwg-lobby-users #header #refresh-button{background-color:rgba(0,0,0,0);border:none;border-radius:6px;height:30px;margin:0px;padding:0px;position:relative;top:3px;user-select:none;width:30px}dwg-lobby-users #header #refresh-button:hover{background-color:rgba(180,180,180,.15)}dwg-lobby-users #header #refresh-button:active{background-color:rgba(180,180,180,.3)}dwg-lobby-users #header #refresh-button #refresh-img{filter:invert(1);left:3px;position:absolute;top:3px;user-select:none}dwg-lobby-users #user-container{display:flex;flex-flow:column nowrap;flex:1 0 0}dwg-lobby-users #user-container .lobby-user{box-sizing:border-box;font-size:16px;height:22px;padding:2px;user-select:none;width:100%}dwg-lobby-users #user-container .lobby-user:hover{background-color:rgba(180,180,180,.15)}dwg-lobby-users #user-container .lobby-user:active{background-color:rgba(180,180,180,.3)}dwg-lobby-users #user-container .lobby-user.left{text-decoration:line-through}",""]);const a=r},706:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(81),i=o.n(n),s=o(645),r=o.n(s)()(i());r.push([e.id,"dwg-page-home{--margin-size: 16px;--height: calc(100vh - 2 * var(--margin-size));--width: calc(100% - 2 * var(--margin-size));background-color:#05285a;display:block;height:var(--height);max-height:var(--height);max-width:var(--width);min-height:var(--height);min-width:var(--width);padding:var(--margin-size);width:var(--width)}dwg-page-home #lobby,dwg-page-home #game{bottom:0;left:0;position:absolute;right:0;top:0}dwg-page-home #game:not(.show){display:none}",""]);const a=r},197:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(81),i=o.n(n),s=o(645),r=o.n(s)()(i());r.push([e.id,"",""]);const a=r},99:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(81),i=o.n(n),s=o(645),r=o.n(s)()(i());r.push([e.id,'body{background-color:#000;color:#fff;font-family:"Fira Sans",sans-serif;margin:0;min-height:100vh;min-width:100%;padding:0}',""]);const a=r},645:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var o="",n=void 0!==t[5];return t[4]&&(o+="@supports (".concat(t[4],") {")),t[2]&&(o+="@media ".concat(t[2]," {")),n&&(o+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),o+=e(t),n&&(o+="}"),t[2]&&(o+="}"),t[4]&&(o+="}"),o})).join("")},t.i=function(e,o,n,i,s){"string"==typeof e&&(e=[[null,e,void 0]]);var r={};if(n)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(r[l]=!0)}for(var d=0;d<e.length;d++){var c=[].concat(e[d]);n&&r[c[0]]||(void 0!==s&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=s),o&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=o):c[2]=o),i&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=i):c[4]="".concat(i)),t.push(c))}},t}},81:e=>{e.exports=function(e){return e[1]}},91:e=>{e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),t.hash&&(e+=t.hash),t.maybeNeedQuotes&&/[\t\n\f\r "'=<>`]/.test(e)?'"'.concat(e,'"'):e):e}},379:e=>{var t=[];function o(e){for(var o=-1,n=0;n<t.length;n++)if(t[n].identifier===e){o=n;break}return o}function n(e,n){for(var s={},r=[],a=0;a<e.length;a++){var l=e[a],d=n.base?l[0]+n.base:l[0],c=s[d]||0,h="".concat(d," ").concat(c);s[d]=c+1;var m=o(h),g={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==m)t[m].references++,t[m].updater(g);else{var b=i(g,n);n.byIndex=a,t.splice(a,0,{identifier:h,updater:b,references:1})}r.push(h)}return r}function i(e,t){var o=t.domAPI(t);return o.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;o.update(e=t)}else o.remove()}}e.exports=function(e,i){var s=n(e=e||[],i=i||{});return function(e){e=e||[];for(var r=0;r<s.length;r++){var a=o(s[r]);t[a].references--}for(var l=n(e,i),d=0;d<s.length;d++){var c=o(s[d]);0===t[c].references&&(t[c].updater(),t.splice(c,1))}s=l}}},569:e=>{var t={};e.exports=function(e,o){var n=function(e){if(void 0===t[e]){var o=document.querySelector(e);if(window.HTMLIFrameElement&&o instanceof window.HTMLIFrameElement)try{o=o.contentDocument.head}catch(e){o=null}t[e]=o}return t[e]}(e);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(o)}},216:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,o)=>{e.exports=function(e){var t=o.nc;t&&e.setAttribute("nonce",t)}},795:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(o){!function(e,t,o){var n="";o.supports&&(n+="@supports (".concat(o.supports,") {")),o.media&&(n+="@media ".concat(o.media," {"));var i=void 0!==o.layer;i&&(n+="@layer".concat(o.layer.length>0?" ".concat(o.layer):""," {")),n+=o.css,i&&(n+="}"),o.media&&(n+="}"),o.supports&&(n+="}");var s=o.sourceMap;s&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),t.styleTagTransform(n,e,t.options)}(t,e,o)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},474:(e,t,o)=>{e.exports=o.p+"5c0badfd21808b14f424.png"},255:(e,t,o)=>{e.exports=o.p+"c3cb371e1616269849ad.png"},668:(e,t,o)=>{e.exports=o.p+"9450fc5737760e0abbf9.png"},816:(e,t,o)=>{e.exports=o.p+"7f6d3fc00d6841ca158b.png"},637:(e,t,o)=>{e.exports=o.p+"9b22161f83ea9e9a0e76.png"},36:(e,t,o)=>{e.exports=o.p+"cc2aeeb6cac4831124d8.png"},861:(e,t,o)=>{e.exports=o.p+"8787734a93d781fa44ad.png"}},t={};function o(n){var i=t[n];if(void 0!==i)return i.exports;var s=t[n]={id:n,exports:{}};return e[n](s,s.exports,o),s.exports}o.m=e,o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.p="dist/",o.b=document.baseURI||self.location.href,o.nc=void 0,(()=>{var e=o(379),t=o.n(e),n=o(795),i=o.n(n),s=o(569),r=o.n(s),a=o(565),l=o.n(a),d=o(216),c=o.n(d),h=o(589),m=o.n(h),g=o(99),b={};b.styleTagTransform=m(),b.setAttributes=l(),b.insert=r().bind(null,"head"),b.domAPI=i(),b.insertStyleElement=c(),t()(g.Z,b),g.Z&&g.Z.locals&&g.Z.locals;var u=o(197),p={};function _(e,t,o={}){const n=Object.assign({loading_text:void 0,disable_button:!0,re_enable_button:!0},o);e.addEventListener("click",(()=>{function o(t,o){"string"==typeof t&&(e.innerText=t),o&&(e.disabled=!1)}n.disable_button&&(e.disabled=!0),e.innerText,o(n.loading_text);const i=t();i instanceof Promise?i.then((e=>{o(e,n.re_enable_button)})):o(i,n.re_enable_button)}))}p.styleTagTransform=m(),p.setAttributes=l(),p.insert=r().bind(null,"head"),p.domAPI=i(),p.insertStyleElement=c(),t()(u.Z,p),u.Z&&u.Z.locals&&u.Z.locals;var y=o(630),v={};v.styleTagTransform=m(),v.setAttributes=l(),v.insert=r().bind(null,"head"),v.domAPI=i(),v.insertStyleElement=c(),t()(y.Z,v),y.Z&&y.Z.locals&&y.Z.locals;var f;class w extends HTMLElement{constructor(){super(...arguments),this.fully_parsed=!1,this.elsMetadata=[]}connectedCallback(){return e=this,t=void 0,n=function*(){this.classList.add("dwg-element"),this.innerHTML=this.htmlString,yield function(e,t=300){const o=n=>{e()?n():setTimeout((()=>o(n)),t)};return new Promise(o)}(this.elementsParsed.bind(this)),this.parsedCallback(),this.classList.add("parsed"),this.fully_parsed=!0},new((o=void 0)||(o=Promise))((function(i,s){function r(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}));var e,t,o,n}elementsParsed(){let e=!0;for(const t of this.elsMetadata){let o=t.found_element?this[t.name]:null;t.found_element||(o=this.querySelector(`#${t.element_id}`),o&&(this[t.name]=o,t.found_element=!0)),t.found_element?o instanceof w&&(o.fully_parsed||(e=!1)):e=!1}return e}parsedCallback(){}configureElement(e,t){t||(t=e.replace(/_/g,"-")),this.elsMetadata.push({element_id:t,name:e})}}function x(e,t,o,n){return JSON.stringify({sender:e,kind:t,content:o,data:n})}function k(e){var t;return{client_id:parseInt(e.client_id),nickname:e.nickname,ping:parseInt(e.ping),room_id:null!==(t=parseInt(e.room_id))&&void 0!==t?t:void 0}}function E(e){return{game_type:parseInt(e.game_type),max_players:parseInt(e.max_players),max_viewers:parseInt(e.max_viewers)}}function S(e){return{room_id:parseInt(e.room_id),room_name:e.room_name,host:k(e.host),players:new Map(e.players.map((e=>{const t=k(e);return[t.client_id,t]}))),viewers:new Map(e.viewers.map((e=>{const t=k(e);return[t.client_id,t]}))),game_settings:E(e.game_settings),game_id:e.game_id?parseInt(e.game_id):void 0}}!function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.FIDDLESTICKS=1]="FIDDLESTICKS"}(f||(f={}));var L=o(732),C={};C.styleTagTransform=m(),C.setAttributes=l(),C.insert=r().bind(null,"head"),C.domAPI=i(),C.insertStyleElement=c(),t()(L.Z,C),L.Z&&L.Z.locals&&L.Z.locals;var T=o(59),R={};R.styleTagTransform=m(),R.setAttributes=l(),R.insert=r().bind(null,"head"),R.domAPI=i(),R.insertStyleElement=c(),t()(T.Z,R),T.Z&&T.Z.locals&&T.Z.locals;class I extends w{constructor(){super(),this.htmlString='<div id="chat-container"></div> <div id="input-container"> <input id="chat-input" placeholder=""> <button id="send-chat">Send</button> </div>',this.configureElement("chat_container"),this.configureElement("chat_input"),this.configureElement("send_chat")}parsedCallback(){_(this.send_chat,(()=>{this.sendChat()})),this.chat_input.addEventListener("keyup",(e=>{"Enter"===e.key&&this.sendChat()}))}addChat(e){const t=this.chat_container.scrollHeight-this.chat_container.offsetHeight-this.chat_container.scrollTop<I.adjust_scroll_limit,o="server"===e.sender||"gray"===e.color?'<div class="color-gray">':"<div>",n=e.sender&&"server"!==e.sender?`${e.sender}: `:"";this.chat_container.innerHTML+=`${o}<b>${n}</b>${e.message}</div>`,t&&(this.chat_container.scrollTop=this.chat_container.scrollHeight-this.chat_container.offsetHeight)}sendChat(){if(this.inputEmpty())return;const e=new CustomEvent("chat_sent",{detail:this.getInput()});this.dispatchEvent(e)}setPlaceholder(e){this.chat_input.placeholder=e}clear(){this.chat_input.value="",this.chat_container.innerHTML=""}inputEmpty(){return!this.chat_input.value}getInput(){const e={message:this.chat_input.value};return this.chat_input.value="",e}}I.adjust_scroll_limit=5,customElements.define("dwg-chatbox",I);function Z(e){return t=this,o=void 0,i=function*(){try{const t=yield fetch(function(e){return`/api/${e}/`}(e),{method:"GET",headers:{"Content-Type":"application/json"}});return yield t.json()}catch(e){console.log(e)}return{success:!1,error_message:"Server error; please report this bug."}},new((n=void 0)||(n=Promise))((function(e,s){function r(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(t){var o;t.done?e(t.value):(o=t.value,o instanceof n?o:new n((function(e){e(o)}))).then(r,a)}l((i=i.apply(t,o||[])).next())}));var t,o,n,i}var $=o(91),U=o.n($),P=new URL(o(861),o.b);const z='<div id="header"> <button id="refresh-button"> <img id="refresh-img" src="'+U()(P)+'" alt="refresh" draggable="false"> </button> </div> <div id="user-container"></div>';var A=o(391),M={};M.styleTagTransform=m(),M.setAttributes=l(),M.insert=r().bind(null,"head"),M.domAPI=i(),M.insertStyleElement=c(),t()(A.Z,M),A.Z&&A.Z.locals&&A.Z.locals;customElements.define("dwg-lobby-users",class extends w{constructor(){super(),this.users=new Map,this.refresh_users_running=!1,this.htmlString=z,this.configureElement("refresh_button"),this.configureElement("user_container")}parsedCallback(){_(this.refresh_button,(()=>{this.refreshUsers()}),{}),this.refreshUsers()}refreshUsers(){return e=this,t=void 0,n=function*(){if(this.refresh_users_running)return;this.refresh_users_running=!0,this.user_container.innerHTML=" ... loading",this.users.clear();const e=yield Z("lobby/users/get");if(e.success){console.log(e);let t="";for(const o of e.result){const e=k(o);t+=this.addUserString(e),this.users.set(e.client_id,e)}this.user_container.innerHTML=t}else this.user_container.innerHTML=`Error loading users: ${e.error_message}`;this.refresh_users_running=!1},new((o=void 0)||(o=Promise))((function(i,s){function r(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}));var e,t,o,n}addUserString(e){return`<div class="lobby-user" id="user-${e.client_id}">${this.getUserInnerText(e)}</div>`}getUserInnerText(e){return`${e.nickname} (${e.ping})`}addUser(e){if(this.users.has(e.client_id)){const t=this.querySelector(`#user-${e.client_id}`);t&&t.replaceWith(this.addUserString(e))}else this.user_container.innerHTML+=this.addUserString(e);this.users.set(e.client_id,e)}updatePing(e,t){if(this.users.has(e)){this.users.get(e).ping=t;const o=this.querySelector(`#user-${e}`);o&&(o.innerText=this.getUserInnerText(this.users.get(e)))}}removeUser(e){this.users.delete(e);const t=this.querySelector(`#user-${e}`);t&&t.classList.add("left")}getUser(e){return this.users.get(e)}joinRoom(e,t){const o=this.getUser(e);o&&(o.room_id=t)}leaveRoom(e){const t=this.getUser(e);t&&(t.room_id=void 0)}});var j=o(562),N={};N.styleTagTransform=m(),N.setAttributes=l(),N.insert=r().bind(null,"head"),N.domAPI=i(),N.insertStyleElement=c(),t()(j.Z,N),j.Z&&j.Z.locals&&j.Z.locals;customElements.define("dwg-lobby-rooms",class extends w{constructor(){super(),this.rooms=new Map,this.refresh_rooms_running=!1,this.htmlString=""}parsedCallback(){}refreshRooms(){return e=this,t=void 0,n=function*(){if(this.refresh_rooms_running)return;this.refresh_rooms_running=!0,this.innerHTML=" ... loading",this.rooms.clear();const e=yield Z("lobby/rooms/get");if(e.success){const t=[];for(const o of e.result){const e=S(o);t.push(this.getRoomElement(e)),this.rooms.set(e.room_id,e)}this.innerHTML="";for(const e of t)this.appendChild(e)}else this.innerHTML=`Error loading rooms: ${e.error_message}`;this.refresh_rooms_running=!1},new((o=void 0)||(o=Promise))((function(i,s){function r(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}));var e,t,o,n}getRoomElement(e){const t=document.createElement("div");return t.classList.add("lobby-room"),t.id=`room-${e.room_id}`,t.innerText=e.room_name,t.addEventListener("click",(()=>{this.dispatchEvent(new CustomEvent("join_room",{detail:e.room_id}))})),t}addRoom(e){if(this.rooms.has(e.room_id)){const t=this.querySelector(`#room-${e.room_id}`);t&&t.replaceWith(this.getRoomElement(e))}else this.appendChild(this.getRoomElement(e));this.rooms.set(e.room_id,e)}removeRoom(e){this.rooms.delete(e);const t=this.querySelector(`#room-${e}`);t&&t.remove()}userDisconnected(e){const t=[];for(const o of this.rooms.values())e===o.host.client_id&&t.push(o.room_id);t.forEach((e=>this.removeRoom(e)))}getRoom(e){return this.rooms.get(e)}renameRoom(e,t){const o=this.getRoom(e);if(!o)return;o.room_name=t;const n=this.querySelector(`#room-${o.room_id}`);n&&n.replaceWith(this.getRoomElement(o))}promoteUser(e,t){const o=this.getRoom(e);o&&o.players.has(t)&&(o.host=o.players.get(t))}playerToViewer(e,t){const o=this.getRoom(e);o&&o.players.has(t)&&(o.viewers.set(t,o.players.get(t)),o.players.delete(t))}viewerToPlayer(e,t){const o=this.getRoom(e);o&&o.viewers.has(t)&&(o.players.set(t,o.viewers.get(t)),o.viewers.delete(t))}playerJoinsRoom(e,t){const o=this.getRoom(t.room_id);o&&(o.host.client_id===t.client_id?this.removeRoom(t.room_id):o.players.delete(t.client_id));const n=this.getRoom(e);n&&n.players.set(t.client_id,t)}viewerJoinsRoom(e,t){const o=this.getRoom(t.room_id);o&&(o.host.client_id===t.client_id?this.removeRoom(t.room_id):o.players.delete(t.client_id));const n=this.getRoom(e);n&&n.viewers.set(t.client_id,t)}clientLeavesRoom(e,t){const o=this.getRoom(e);o&&(o.host.client_id===t?this.removeRoom(e):(o.players.delete(t),o.viewers.delete(t)))}updateRoomSettings(e,t){const o=this.getRoom(e);o&&(o.game_settings=t)}launchRoom(e,t){const o=this.getRoom(e);o&&(o.game_id=t)}});var H=new URL(o(255),o.b),O=new URL(o(474),o.b),D=new URL(o(816),o.b),q=new URL(o(36),o.b),J=new URL(o(668),o.b),F=new URL(o(637),o.b);const W='<div id="room-header"> <button id="rename-room"> <img src="'+U()(H)+'" alt="rename" draggable="false"> </button> <button id="cancel-rename">cancel</button> <div id="room-name"></div> <input id="rename-input" placeholder="room name"> <button id="leave-room"> <img src="'+U()(O)+'" alt="close" draggable="false"> </button> </div> <div id="room-body"> <div id="left-panel"> <div id="game-settings"> <div id="settings-button-container" class="hide settings-medium"> <button id="settings-settings-button" class="settings-button">Settings</button> <button id="settings-launch-button" class="settings-button">Launch</button> </div> <dwg-lobby-game-settings id="lobby-game-settings"></dwg-lobby-game-settings> <div id="settings-title" class="settings-medium"></div> <div id="settings-players" class="settings-medium"> Players: <span id="num-players-current"></span>/<span id="num-players-max"></span> </div> <div id="settings-game-status" class="settings-small"></div> <div id="settings-settings-label" class="settings-large">Settings:</div> <div id="settings-settings"></div> <div id="settings-description-label" class="settings-large">Description:</div> <div id="settings-description" class="settings-small"></div> </div> <div id="user-list"> <div id="host-label" class="container-label">Host</div> <div id="host-container"></div> <div id="players-label" class="container-label">Players (<span id="players-label-amount">0</span>)</div> <div id="players-container"></div> <div id="viewers-label" class="container-label">Viewers (<span id="viewers-label-amount">0</span>)</div> <div id="viewers-container"></div> </div> </div> <dwg-chatbox id="chatbox"></dwg-chatbox> </div> <img id="kick-img" src="'+U()(D)+'"> <img id="promote-img" src="'+U()(q)+'"> <img id="viewer-img" src="'+U()(J)+'"> <img id="player-img" src="'+U()(F)+'">';var G=o(991),B={};B.styleTagTransform=m(),B.setAttributes=l(),B.insert=r().bind(null,"head"),B.domAPI=i(),B.insertStyleElement=c(),t()(G.Z,B),G.Z&&G.Z.locals&&G.Z.locals;var V=o(923),K={};K.styleTagTransform=m(),K.setAttributes=l(),K.insert=r().bind(null,"head"),K.domAPI=i(),K.insertStyleElement=c(),t()(V.Z,K),V.Z&&V.Z.locals&&V.Z.locals,customElements.define("dwg-lobby-game-settings",class extends w{constructor(){super(),this.htmlString='<div id="game-settings-wrapper"> <div id="game-settings-title">Game Settings</div> <select id="game-chooser"><option value="0" selected="selected" hidden>--Choose a game--</option></select> <span class="row-wrapper"> <input id="max-players-input" type="number" min="1" max="8" placeholder="max-players"> <input id="max-viewers-input" type="number" min="0" max="16" placeholder="min-players"> </span> <button id="save-button">Save</button> </div> ',this.configureElement("game_settings_wrapper"),this.configureElement("game_chooser"),this.configureElement("max_players_input"),this.configureElement("max_viewers_input"),this.configureElement("save_button")}parsedCallback(){for(const t of(e=f,Object.keys(e).filter((e=>Number.isNaN(parseInt(e)))))){if(!f[t])continue;const e=document.createElement("option");e.value=f[t].toString(),e.innerText=t,this.game_chooser.appendChild(e)}var e;_(this.save_button,(()=>{this.dispatchEvent(new Event("saved"))}))}setSettings(e){this.game_chooser.value=e.game_type.toString(),this.max_players_input.valueAsNumber=e.max_players,this.max_viewers_input.valueAsNumber=e.max_viewers}getSettings(){var e,t,o;return{game_type:null!==(e=parseInt(this.game_chooser.value))&&void 0!==e?e:0,max_players:null!==(t=parseInt(this.max_players_input.value))&&void 0!==t?t:0,max_viewers:null!==(o=parseInt(this.max_viewers_input.value))&&void 0!==o?o:0}}}),customElements.define("dwg-lobby-room",class extends w{constructor(){super(),this.settings_launching=!1,this.is_host=!1,this.htmlString=W,this.configureElement("room_name"),this.configureElement("chatbox"),this.configureElement("leave_room"),this.configureElement("rename_input"),this.configureElement("rename_room"),this.configureElement("cancel_rename"),this.configureElement("host_container"),this.configureElement("players_container"),this.configureElement("viewers_container"),this.configureElement("kick_img"),this.configureElement("promote_img"),this.configureElement("viewer_img"),this.configureElement("player_img"),this.configureElement("settings_title"),this.configureElement("num_players_current"),this.configureElement("num_players_max"),this.configureElement("settings_button_container"),this.configureElement("settings_settings_button"),this.configureElement("settings_launch_button"),this.configureElement("settings_game_status"),this.configureElement("lobby_game_settings")}parsedCallback(){this.chatbox.setPlaceholder("Chat with room"),this.chatbox.addEventListener("chat_sent",(e=>{this.dispatchEvent(new CustomEvent("chat_sent",{detail:e.detail}))})),this.leave_room.addEventListener("click",(()=>{this.dispatchEvent(new Event("leave_room"))})),this.rename_room.addEventListener("click",(()=>{this.openRename()})),this.cancel_rename.addEventListener("click",(()=>{this.cancelRename()})),this.rename_input.addEventListener("keyup",(e=>{"Enter"===e.key&&this.submitRename()})),this.settings_settings_button.addEventListener("click",(()=>{this.lobby_game_settings.setSettings(this.room.game_settings),this.lobby_game_settings.classList.add("show")})),this.lobby_game_settings.addEventListener("saved",(()=>{const e=x(`client-${this.room.host.client_id}`,"room-settings-update",JSON.stringify(this.lobby_game_settings.getSettings()),this.room.room_id.toString());this.dispatchEvent(new CustomEvent("save_settings",{detail:e})),this.lobby_game_settings.classList.remove("show")})),this.settings_launch_button.addEventListener("click",(()=>{if(this.settings_launching)this.settings_launching=!1,this.settings_launch_button.innerText="Launch",this.settings_launch_button.classList.remove("launching"),this.settings_launch_interval_id&&clearInterval(this.settings_launch_interval_id);else{this.settings_launching=!0,this.settings_launch_button.innerText="Cancel",this.settings_launch_button.classList.add("launching"),this.settings_game_status.innerText="Game launching";const e=5;this.dispatchEvent(new CustomEvent("chat_sent",{detail:{message:`Game is launching in ${e} ...`,color:"gray"}})),this.settings_launch_interval_id=function(e,t,o,n=(()=>{})){let i=0;const s=setInterval((()=>{i++,i>o?(clearInterval(s),n()):e(i)}),1e3);return s}((t=>{this.dispatchEvent(new CustomEvent("chat_sent",{detail:{message:e-t+" ...",color:"gray"}}))}),0,e-1,(()=>{this.dispatchEvent(new CustomEvent("chat_sent",{detail:{message:"Game is launching ...",color:"gray"}})),this.dispatchEvent(new Event("launch_game"))}))}})),this.room_name.classList.add("show")}setRoom(e,t){this.is_host=t,this.room=e,this.room_name.innerText=e.room_name,this.updateSettingsDependencies(),this.num_players_current.innerText=e.players.size.toString(),this.settings_game_status.innerText="Game not started",this.classList.add("show"),t?(this.rename_room.classList.add("show"),this.settings_button_container.classList.remove("hide")):(this.rename_room.classList.remove("show"),this.settings_button_container.classList.add("hide")),this.host_container.replaceChildren(this.getUserElement(e.host,!1,!0));const o=[];for(const n of e.players.values())n.client_id!==e.host.client_id&&o.push(this.getUserElement(n,t,!0));this.players_container.replaceChildren(...o);const n=[];for(const o of e.viewers.values())n.push(this.getUserElement(o,t,!1));this.viewers_container.replaceChildren(...n)}updateSettings(e){this.room&&(this.room.game_settings=e,this.updateSettingsDependencies())}updateSettingsDependencies(){var e;this.settings_title.innerText=null!==(e=f[this.room.game_settings.game_type||-1])&&void 0!==e?e:"",this.num_players_max.innerText=this.room.game_settings.max_players.toString()}getUserElement(e,t,o){const n=document.createElement("div");n.classList.add("room-user"),n.id=`user-${e.client_id}`;const i=document.createElement("span");return i.innerText=this.getUserElementText(e),n.appendChild(i),t&&(o?(n.appendChild(this.getUserButton(e.client_id,"kick",this.kick_img.src)),n.appendChild(this.getUserButton(e.client_id,"viewer",this.viewer_img.src)),n.appendChild(this.getUserButton(e.client_id,"promote",this.promote_img.src))):(n.appendChild(this.getUserButton(e.client_id,"kick",this.kick_img.src)),n.appendChild(this.getUserButton(e.client_id,"player",this.player_img.src)))),n}getUserButton(e,t,o){const n=document.createElement("button");n.id=`${t}-button-${e}`,n.classList.add(`${t}-button`);const i=document.createElement("img");return i.src=o,i.alt=t,i.draggable=!1,n.appendChild(i),n.addEventListener("click",(()=>{this.dispatchEvent(new CustomEvent(`${t}_player`,{detail:e}))})),n}getUserElementText(e){return`${e.nickname} (${e.ping})`}clearRoom(){this.room=void 0,this.chatbox.clear(),this.classList.remove("show")}renameRoom(e,t){this.room&&(this.room.room_name=e,this.room_name.innerText=e,t===this.room.host.client_id?this.chatbox.addChat({message:`The host has renamed the room to: ${e}`,color:"gray"}):this.room.players.has(t)?this.chatbox.addChat({message:`${this.room.players.get(t).nickname} renamed the room to: ${e}`,color:"gray"}):this.chatbox.addChat({message:`The room has been renamed to: ${e}`,color:"gray"}))}hasPlayer(e){return!(!this.classList.contains("show")||!this.room)&&this.room.players.has(e)}getClient(e){if(this.classList.contains("show")&&this.room)return this.room.players.has(e)?this.room.players.get(e):this.room.viewers.get(e)}getPlayer(e){if(this.classList.contains("show")&&this.room)return this.room.players.get(e)}getHost(){if(this.classList.contains("show")&&this.room)return this.room.host}updatePing(e,t){if(this.room&&this.room.players.has(e)){this.room.players.get(e).ping=t;const o=this.querySelector(`#user-${e} span`);o&&(o.innerText=this.getUserElementText(this.room.players.get(e)))}}joinRoom(e,t){if(!this.room)return;const o=this.querySelector(`#user-${e.client_id}`);o?o.replaceWith(this.getUserElement(e,this.is_host,!0)):t?this.players_container.appendChild(this.getUserElement(e,this.is_host,!0)):this.viewers_container.appendChild(this.getUserElement(e,this.is_host,!0)),t?(this.room.players.set(e.client_id,e),this.num_players_current.innerText=this.room.players.size.toString()):this.room.viewers.set(e.client_id,e),this.chatbox.addChat({message:`${e.nickname} (${e.client_id}) joined the room`,color:"gray"})}leaveRoom(e,t){var o;if(this.room)if(this.room.host.client_id===e)this.clearRoom();else{const n=null!==(o=this.room.players.get(e))&&void 0!==o?o:this.room.viewers.get(e);this.room.players.delete(e),this.room.viewers.delete(e),this.num_players_current.innerText=this.room.players.size.toString();const i=this.querySelector(`#user-${e}`);i&&i.remove(),n&&this.chatbox.addChat({message:`${n.nickname} (${n.client_id}) ${t} the room`,color:"gray"})}}promoteUser(e,t){this.room&&this.room.players.has(e)&&(this.room.host=this.room.players.get(e),this.setRoom(this.room,t))}playerToViewer(e){this.room&&this.room.players.has(e)&&(this.room.viewers.set(e,this.room.players.get(e)),this.room.players.delete(e),this.setRoom(this.room,this.is_host))}viewerToPlayer(e){this.room&&this.room.viewers.has(e)&&(this.room.players.set(e,this.room.viewers.get(e)),this.room.viewers.delete(e),this.setRoom(this.room,this.is_host))}launchRoom(e){this.room&&(this.room.game_id=e,this.settings_game_status.innerText="In progress")}openRename(){this.rename_room.classList.remove("show"),this.room_name.classList.remove("show"),this.rename_input.value=this.room.room_name,this.rename_input.classList.add("show"),this.cancel_rename.classList.add("show")}cancelRename(){this.rename_room.classList.add("show"),this.room_name.classList.add("show"),this.rename_input.classList.remove("show"),this.cancel_rename.classList.remove("show")}submitRename(){this.dispatchEvent(new CustomEvent("rename_room",{detail:this.rename_input.value})),this.cancelRename()}});var Q=function(e,t,o,n){return new(o||(o=Promise))((function(i,s){function r(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))};function Y(e,t){var o,n,i,s,r,a,l,d,c;if(e.socketActive()&&(c=t.kind,!["game","ping"].every((e=>!c.startsWith(`${e}-`)))))switch("ping-update"!==t.kind&&console.log(t),t.kind){case"ping-update":break;case"game-chat":const c=parseInt(t.sender.replace("game-",""));if(c){const l=null!==(i=null===(n=null===(o=e.game)||void 0===o?void 0:o.game_base)||void 0===n?void 0:n.players.get(c))&&void 0!==i?i:null===(r=null===(s=e.game)||void 0===s?void 0:s.game_base)||void 0===r?void 0:r.viewers.get(c);e.chatbox.addChat({message:t.content,sender:null!==(a=l.nickname)&&void 0!==a?a:c.toString()})}break;case"game-player-connected":const h=parseInt(t.data);if(h){const t=e.players_waiting_els.get(h);t&&(t.innerText="Connected",t.classList.add("connected"));const o=null===(d=null===(l=e.game)||void 0===l?void 0:l.game_base)||void 0===d?void 0:d.players.get(h);o&&(o.connected=!0)}break;case"game-start":e.game.game_base.game_started=!0,e.waiting_room.classList.add("hide"),e.game_container.classList.add("show");break;default:console.log("Unknown message type",t.kind,"from",t.sender)}}customElements.define("dwg-lobby",class extends w{constructor(){super(),this.connection_metadata={nickname:"Anonymous",ping:0},this.htmlString='<span id="page-header"> <span id="name-container"></span> <span id="ping-container"></span> </span> <span id="buttons"> <button id="refresh-lobby-button">Refresh</button> <button id="create-room-button">Create Room</button> </span> <span id="horizontal-container"> <span id="vertical-container"> <dwg-lobby-rooms id="lobby-rooms"></dwg-lobby-rooms> <dwg-chatbox id="chatbox"></dwg-chatbox> </span> <dwg-lobby-users id="lobby-users"></dwg-lobby-users> </span> <div id="lobby-room-wrapper"> <dwg-lobby-room id="lobby-room"></dwg-lobby-room> </div>',this.configureElement("name_container"),this.configureElement("ping_container"),this.configureElement("refresh_lobby_button"),this.configureElement("create_room_button"),this.configureElement("lobby_rooms"),this.configureElement("chatbox"),this.configureElement("lobby_users"),this.configureElement("lobby_room_wrapper"),this.configureElement("lobby_room")}parsedCallback(){this.chatbox.setPlaceholder("Chat with the entire lobby"),_(this.refresh_lobby_button,(()=>Q(this,void 0,void 0,(function*(){yield this.lobby_rooms.refreshRooms()})))),_(this.create_room_button,(()=>Q(this,void 0,void 0,(function*(){this.socket.send(x(`client-${this.connection_metadata.client_id}`,"room-create"))}))),{loading_text:"Creating Room ...",re_enable_button:!1}),this.lobby_rooms.addEventListener("join_room",(e=>Q(this,void 0,void 0,(function*(){this.socket.send(x(`client-${this.connection_metadata.client_id}`,"room-join","",e.detail.toString()))})))),this.chatbox.addEventListener("chat_sent",(e=>{this.sendChatMessage(this.chatbox,"client","lobby-chat",e.detail)})),this.lobby_room.addEventListener("chat_sent",(e=>{const t=e.detail;t.sender=`room-${this.connection_metadata.room_id}-${this.connection_metadata.client_id}`,this.sendChatMessage(this.lobby_room.chatbox,"room","room-chat",t)})),this.lobby_room.addEventListener("leave_room",(()=>Q(this,void 0,void 0,(function*(){var e;this.socket.send(x(`client-${this.connection_metadata.client_id}`,"room-leave","",null===(e=this.connection_metadata.room_id)||void 0===e?void 0:e.toString()))})))),this.lobby_room.addEventListener("rename_room",(e=>{var t;this.socket.send(x(`client-${this.connection_metadata.client_id}`,"room-rename",e.detail,null===(t=this.connection_metadata.room_id)||void 0===t?void 0:t.toString()))})),this.lobby_room.addEventListener("kick_player",(e=>{var t;this.socket.send(x(`client-${this.connection_metadata.client_id}`,"room-kick",e.detail.toString(),null===(t=this.connection_metadata.room_id)||void 0===t?void 0:t.toString()))})),this.lobby_room.addEventListener("viewer_player",(e=>{var t;this.socket.send(x(`client-${this.connection_metadata.client_id}`,"room-set-viewer",e.detail.toString(),null===(t=this.connection_metadata.room_id)||void 0===t?void 0:t.toString()))})),this.lobby_room.addEventListener("player_player",(e=>{var t;this.socket.send(x(`client-${this.connection_metadata.client_id}`,"room-set-player",e.detail.toString(),null===(t=this.connection_metadata.room_id)||void 0===t?void 0:t.toString()))})),this.lobby_room.addEventListener("promote_player",(e=>{var t;this.socket.send(x(`client-${this.connection_metadata.client_id}`,"room-promote",e.detail.toString(),null===(t=this.connection_metadata.room_id)||void 0===t?void 0:t.toString()))})),this.lobby_room.addEventListener("save_settings",(e=>{this.socket.send(e.detail)})),this.lobby_room.addEventListener("launch_game",(()=>{var e;this.socket.send(x(`client-${this.connection_metadata.client_id}`,"room-launch","",null===(e=this.connection_metadata.room_id)||void 0===e?void 0:e.toString()))})),this.lobby_rooms.refreshRooms()}setSocket(e){this.socket&&this.socket.close(3e3,"opening new connection"),this.socket=e,this.lobby_rooms.refreshRooms(),this.lobby_users.refreshUsers(),this.socket.addEventListener("message",(e=>{try{!function(e,t){var o,n,i,s,r,a;if(e.socketActive()&&(a=t.kind,!["room","lobby","ping"].every((e=>!a.startsWith(`${e}-`)))))switch("ping-update"!==t.kind&&console.log(t),t.kind){case"lobby-you-joined":const a=parseInt(t.data);a?(e.connection_metadata.client_id=a,e.setNickname(t.content),e.chatbox.addChat({message:`You (${e.connection_metadata.nickname}) joined lobby with client id ${a}`,sender:"server"}),e.lobby_users.addUser({client_id:a,nickname:e.connection_metadata.nickname,ping:0})):(e.socket.close(3001,"you-joined-lobby message did not return properly formed client id"),e.dispatchEvent(new Event("connection_lost")));break;case"lobby-joined":const l=parseInt(t.data);l&&(e.chatbox.addChat({message:`${t.content} joined lobby with client id ${l}`,sender:"server"}),e.lobby_users.addUser({client_id:l,nickname:t.content,ping:0}));break;case"lobby-left":const d=parseInt(t.data);if(d){e.chatbox.addChat({message:`${t.content} (client id ${d}) left lobby`,sender:"server"});const n=e.lobby_users.getUser(d);e.lobby_users.removeUser(d),e.lobby_rooms.userDisconnected(d),n&&n.room_id===e.connection_metadata.room_id&&n.client_id===(null===(o=e.lobby_room.getHost())||void 0===o?void 0:o.client_id)?e.leaveRoom():e.lobby_room.leaveRoom(d,"disconnected from")}break;case"lobby-chat":const c=parseInt(t.sender.replace("client-",""));c&&e.chatbox.addChat({message:t.content,sender:null!==(i=null===(n=e.lobby_users.getUser(c))||void 0===n?void 0:n.nickname)&&void 0!==i?i:c.toString()});break;case"ping-update":const h=parseInt(t.data),m=parseInt(t.content);h&&!isNaN(m)&&(e.connection_metadata.client_id===h&&e.setPing(m),e.lobby_room.updatePing(h,m),e.lobby_users.updatePing(h,m));break;case"room-created":const g=(t,o)=>{e.lobby_rooms.addRoom(t),e.connection_metadata.client_id===o&&(e.enterRoom(t,!0),setTimeout((()=>{e.create_room_button.innerText="Room Created"}),1))};try{const o=parseInt(t.sender.replace("client-","")),n=e.lobby_users.getUser(o),i=S(JSON.parse(t.content));n.room_id=i.room_id,g.bind(this,i,o)()}catch(e){parseInt(t.data)}break;case"room-closed":const b=parseInt(t.data);if(b){e.connection_metadata.room_id===b&&e.leaveRoom();const t=e.lobby_rooms.getRoom(b);if(e.lobby_rooms.removeRoom(b),t)for(const o of t.players.keys())e.lobby_users.leaveRoom(o)}break;case"room-left":const u=parseInt(t.sender.replace("room-","")),p=parseInt(t.data.replace("client-",""));u&&p&&e.userLeftRoom(u,p,"left");break;case"room-joined-player":const _=parseInt(t.sender.replace("room-","")),y=parseInt(t.data.replace("client-","")),v=e.lobby_users.getUser(y),f=e.lobby_rooms.getRoom(_);_&&y&&v&&(e.lobby_users.joinRoom(y,_),e.lobby_rooms.playerJoinsRoom(_,v),_===e.connection_metadata.room_id?e.lobby_room.joinRoom(v,!0):y===e.connection_metadata.client_id&&f&&e.enterRoom(e.lobby_rooms.getRoom(_),!1));break;case"room-joined-viewer":const w=parseInt(t.sender.replace("room-","")),x=parseInt(t.data.replace("client-","")),k=e.lobby_users.getUser(y),E=e.lobby_rooms.getRoom(_);w&&x&&k&&(e.lobby_users.joinRoom(x,w),e.lobby_rooms.viewerJoinsRoom(w,k),w===e.connection_metadata.room_id?e.lobby_room.joinRoom(k,!1):x===e.connection_metadata.client_id&&E&&e.enterRoom(e.lobby_rooms.getRoom(w),!1));break;case"room-chat":const L=t.sender.split("-");if(L.length<3)break;const C=parseInt(L[1]),T=parseInt(L[2]);C&&T&&e.connection_metadata.room_id===C&&e.lobby_room.hasPlayer(T)&&e.lobby_room.chatbox.addChat({message:t.content,sender:null!==(r=null===(s=e.lobby_room.getClient(T))||void 0===s?void 0:s.nickname)&&void 0!==r?r:T.toString()});break;case"room-renamed":const R=parseInt(t.sender.replace("room-","")),I=parseInt(t.data);R&&I&&(e.connection_metadata.client_id,e.lobby_room.room&&e.lobby_room.room.room_id===R&&e.lobby_room.renameRoom(t.content,I),e.lobby_rooms.renameRoom(R,t.content));break;case"room-kicked":const Z=parseInt(t.sender.replace("room-","")),$=parseInt(t.data);Z&&$&&e.userLeftRoom(Z,$,"was kicked from");break;case"room-promoted":const U=parseInt(t.sender.replace("room-","")),P=parseInt(t.data);U&&P&&(U===e.connection_metadata.room_id&&e.lobby_room.promoteUser(P,P===e.connection_metadata.client_id),e.lobby_rooms.promoteUser(U,P));break;case"room-viewer-set":const z=parseInt(t.sender.replace("room-","")),A=parseInt(t.data);z&&A&&(z===e.connection_metadata.room_id&&e.lobby_room.playerToViewer(A),e.lobby_rooms.playerToViewer(z,A));break;case"room-player-set":const M=parseInt(t.sender.replace("room-","")),j=parseInt(t.data);M&&j&&(M===e.connection_metadata.room_id&&e.lobby_room.viewerToPlayer(j),e.lobby_rooms.viewerToPlayer(M,j));break;case"room-settings-updated":try{const o=parseInt(t.sender.replace("room-","")),n=JSON.parse(t.data);e.lobby_rooms.updateRoomSettings(o,n),o===e.connection_metadata.room_id&&e.lobby_room.updateSettings(n)}catch(e){}break;case"room-launched":const N=parseInt(t.sender.replace("room-","")),H=parseInt(t.data);N&&H&&(e.lobby_rooms.launchRoom(N,H),N===e.connection_metadata.room_id&&(e.lobby_room.launchRoom(H),e.dispatchEvent(new CustomEvent("game_launched",{detail:e.lobby_room.room}))));break;case"room-join-failed":case"room-leave-failed":case"room-rename-failed":case"room-kick-failed":case"room-promote-failed":case"room-set-player-failed":case"room-set-viewer-failed":case"room-settings-updated-failed":case"room-launch-failed":throw new Error(t.content);default:console.log("Unknown message type",t.kind,"from",t.sender)}}(this,JSON.parse(e.data))}catch(t){console.log("Error parsing message: ",e,t)}}))}userLeftRoom(e,t,o){e===this.connection_metadata.room_id&&(this.lobby_room.leaveRoom(t,o),t===this.connection_metadata.client_id&&this.leaveRoom()),this.lobby_users.leaveRoom(t),this.lobby_rooms.clientLeavesRoom(e,t)}socketActive(){return!!this.socket&&this.socket.readyState==WebSocket.OPEN}setNickname(e){this.connection_metadata.nickname=e,this.name_container.innerText=e}setPing(e){this.connection_metadata.ping=e,this.ping_container.innerText=`ping: ${Math.round(e)}`}enterRoom(e,t){this.connection_metadata.room_id=e.room_id,this.lobby_room.setRoom(e,t),this.lobby_room_wrapper.classList.add("show")}leaveRoom(){this.connection_metadata.room_id=void 0,this.lobby_room_wrapper.classList.remove("show"),this.lobby_room.clearRoom(),this.create_room_button.disabled=!1,this.create_room_button.innerText="Create Room"}sendChatMessage(e,t,o,n){var i;let s=!1;try{this.socketActive()&&(this.socket.send(x(null!==(i=n.sender)&&void 0!==i?i:`${t}-${this.connection_metadata.client_id}`,o,n.message,n.color)),s=!0),s?e.addChat(Object.assign(Object.assign({},n),{sender:this.connection_metadata.nickname})):e.addChat({message:`Message unable to be sent: "${n.message}"`,color:"gray"})}catch(t){e.addChat({message:"Error trying to send message",color:"gray"})}}});var X=o(415),ee={};ee.styleTagTransform=m(),ee.setAttributes=l(),ee.insert=r().bind(null,"head"),ee.domAPI=i(),ee.insertStyleElement=c(),t()(X.Z,ee),X.Z&&X.Z.locals&&X.Z.locals;var te=o(713),oe={};oe.styleTagTransform=m(),oe.setAttributes=l(),oe.insert=r().bind(null,"head"),oe.domAPI=i(),oe.insertStyleElement=c(),t()(te.Z,oe),te.Z&&te.Z.locals&&te.Z.locals;var ne=o(494),ie={};ie.styleTagTransform=m(),ie.setAttributes=l(),ie.insert=r().bind(null,"head"),ie.domAPI=i(),ie.insertStyleElement=c(),t()(ne.Z,ie),ne.Z&&ne.Z.locals&&ne.Z.locals,customElements.define("dwg-fiddlesticks-player",class extends w{constructor(){super(),this.htmlString='<div id="example">Hello from fiddlesticks-player!</div> ',this.configureElement("example")}parsedCallback(){console.log("DwgFiddlesticksPlayer parsed!")}initialize(e){this.player=e}}),customElements.define("dwg-fiddlesticks",class extends w{constructor(){super(),this.player_els=new Map,this.htmlString='<div id="table-container"> <div id="header-message"> <div>Round: <span id="round-number"></span></div> <div>Trick: <span id="trick-number"></span></div> <div>Trump: <span id="trump-suit"></span></div> </div> <div id="trump-card-container"> <div>Trump Card</div> <div id="trump-card"><img id="trump-card-img" alt="Trump Card"></div> </div> <div id="trick-cards"></div> </div> <div id="player-container"></div>',this.configureElement("round_number"),this.configureElement("trick_number"),this.configureElement("trump_suit"),this.configureElement("trump_card_img"),this.configureElement("trick_cards"),this.configureElement("player_container")}parsedCallback(){}initialize(e){this.game=e;for(const[t,o]of e.players.entries()){const e=document.createElement("dwg-fiddlesticks-player");e.initialize(o),this.player_container.appendChild(e),this.player_els.set(t,e)}}});customElements.define("dwg-game",class extends w{constructor(){super(),this.players_waiting_els=new Map,this.htmlString='<div id="header"> <div id="client-name"> <span id="client-name-string"></span> <span id="client-ping"></span> </div> <div id="room-name"></div> <div id="game-name"></div> <div id="button-container"> <button id="button-game-info"></button> <button id="button-lobby-clients"></button> <button id="button-exit"></button> </div> </div> <div id="waiting-room"> <div id="players-waiting"></div> </div> <div id="game-container"></div> <div id="chatbox-container"> <dwg-chatbox id="chatbox"></dwg-chatbox> </div>',this.configureElement("client_name_string"),this.configureElement("client_ping"),this.configureElement("room_name"),this.configureElement("game_name"),this.configureElement("waiting_room"),this.configureElement("players_waiting"),this.configureElement("game_container"),this.configureElement("chatbox_container"),this.configureElement("chatbox")}parsedCallback(){document.addEventListener("keyup",(e=>{"Enter"===e.key&&(this.chatbox_container.classList.toggle("showing"),this.chatbox.classList.toggle("show"))})),this.chatbox.addEventListener("chat_sent",(e=>{var t;const o=e.detail;this.socket.send(x(null!==(t=o.sender)&&void 0!==t?t:`game-${this.connection_metadata.client_id}`,"game-chat",o.message,o.color))}))}launchGame(e,t,o){return n=this,i=void 0,r=function*(){if(!this.launched&&e&&e.game_id&&t&&t.readyState===WebSocket.OPEN&&o&&o.client_id&&o.room_id&&e.room_id===o.room_id){this.socket=t,this.connection_metadata=o,this.client_name_string.innerText=this.connection_metadata.nickname,this.client_ping.innerText=` (${this.connection_metadata.ping})`,this.room_name.innerText=e.room_name;try{const t=[];this.socket.addEventListener("message",(e=>{try{const o=JSON.parse(e.data);if(this.launched){for(const e of t)Y(this,e);Y(this,o)}else t.push(o)}catch(t){console.log("Error parsing message: ",e,t)}}));const o=yield Z(`lobby/games/get/${e.game_id}`);if(o.success&&o.result){this.game=(n=o.result,Object.assign(Object.assign({},n),{game_base:{game_id:n.game_base.game_id,game_type:n.game_base.game_type,game_started:n.game_base.game_started,game_ended:n.game_base.game_ended,players:new Map(n.game_base.players.map((e=>[e.client_id,e]))),viewers:new Map(n.game_base.viewers.map((e=>[e.client_id,e])))}}));const t=e=>{const t=document.createElement(e);this.game_container.appendChild(t),this.game_el=t,this.game_el.initialize(this.game)};switch(this.game.game_base.game_type){case f.FIDDLESTICKS:t("dwg-fiddlesticks");break;case f.UNSPECIFIED:default:throw new Error(`Unknown game type: ${this.game.game_base.game_type}`)}this.game_name.innerText=f[this.game.game_base.game_type].toLowerCase().trim().split(" ").map((e=>{const t=e.toLowerCase();return e.charAt(0).toUpperCase()+t.slice(1)})).join(" ");for(const[e,t]of this.game.game_base.players){const o=document.createElement("div"),n=document.createElement("div"),i=document.createElement("div");o.appendChild(n),o.appendChild(i),o.classList.add("player-waiting"),n.innerText=t.nickname,i.innerText=t.connected?"Connected":"Connecting ...",t.connected&&i.classList.add("connected"),this.players_waiting_els.set(e,i),this.players_waiting.appendChild(o)}return this.classList.add("show"),this.socket.send(x(`client-${this.connection_metadata.client_id}`,"game-connected","",e.game_id.toString())),this.launched=!0,!0}console.log(o.error_message)}catch(e){}return!1}var n},new((s=void 0)||(s=Promise))((function(e,t){function o(e){try{l(r.next(e))}catch(e){t(e)}}function a(e){try{l(r.throw(e))}catch(e){t(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof s?n:new s((function(e){e(n)}))).then(o,a)}l((r=r.apply(n,i||[])).next())}));var n,i,s,r}socketActive(){return!!this.socket&&this.socket.readyState==WebSocket.OPEN}});var se=o(11),re={};re.styleTagTransform=m(),re.setAttributes=l(),re.insert=r().bind(null,"head"),re.domAPI=i(),re.insertStyleElement=c(),t()(se.Z,re),se.Z&&se.Z.locals&&se.Z.locals,customElements.define("dwg-lobby-connector",class extends w{constructor(){super(),this.submitted=new Event("submitted"),this.htmlString='<div id="card"> <input id="nickname" placeholder="Nickname"> <button id="connect-button">Connect to Lobby</button> <div id="status-message"></div> </div> ',this.configureElement("card"),this.configureElement("nickname"),this.configureElement("connect_button"),this.configureElement("status_message")}parsedCallback(){this.connect_button.disabled=!0,this.nickname.addEventListener("keyup",(e=>{const t=this.validName(this.nickname.value);this.connect_button.disabled=!t,t&&"Enter"===e.key&&this.dispatchEvent(this.submitted)})),_(this.connect_button,(()=>(this.dispatchEvent(this.submitted),"Connecting ...")),{re_enable_button:!1})}validName(e){return!!e.length}});var ae=o(706),le={};le.styleTagTransform=m(),le.setAttributes=l(),le.insert=r().bind(null,"head"),le.domAPI=i(),le.insertStyleElement=c(),t()(ae.Z,le),ae.Z&&ae.Z.locals&&ae.Z.locals;customElements.define("dwg-page-home",class extends w{constructor(){super(),this.htmlString='<dwg-lobby id="lobby"></dwg-lobby> <dwg-game id="game"></dwg-game> <dwg-lobby-connector id="lobby-connector"></dwg-lobby-connector>',this.configureElement("lobby"),this.configureElement("game"),this.configureElement("lobby_connector")}parsedCallback(){this.lobby_connector.addEventListener("submitted",(()=>{const e=this.lobby_connector.nickname.value,t=new WebSocket(`ws://127.0.0.1:6807/api/lobby/connect/${e}`);t.addEventListener("error",(e=>{console.log(e),this.tryConnectionAgain("Could not connect. Check your connection and try again.")})),t.addEventListener("open",(()=>{this.lobby.setSocket(t),this.lobby.setNickname(e),this.lobby.setPing(0),this.lobby_connector.classList.add("hide")}))})),this.lobby.addEventListener("connection_lost",(()=>{this.tryConnectionAgain("Connection was lost. Check your connection and try again.")})),this.lobby.addEventListener("game_launched",(e=>{return t=this,o=void 0,i=function*(){(yield this.game.launchGame(e.detail,this.lobby.socket,this.lobby.connection_metadata))&&this.lobby.classList.add("hide")},new((n=void 0)||(n=Promise))((function(e,s){function r(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(t){var o;t.done?e(t.value):(o=t.value,o instanceof n?o:new n((function(e){e(o)}))).then(r,a)}l((i=i.apply(t,o||[])).next())}));var t,o,n,i}))}tryConnectionAgain(e){this.lobby_connector.classList.remove("hide"),this.lobby_connector.status_message.innerText=e,this.lobby_connector.connect_button.disabled=!1,this.lobby_connector.connect_button.innerText="Connect to Lobby"}})})()})();