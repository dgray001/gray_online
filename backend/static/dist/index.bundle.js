(()=>{"use strict";var e={4059:(e,t,i)=>{i.d(t,{Z:()=>r});var s=i(8081),a=i.n(s),n=i(3645),o=i.n(n)()(a());o.push([e.id,"dwg-chatbox{--input-box-height: calc(2 * var(--font-size-medium));--gray-color: rgb(100, 100, 100);background-color:#c8c8c8;color:#000;display:block;height:100%;width:100%}dwg-chatbox #chat-container{display:flex;flex-flow:column nowrap;font-size:var(--font-size-small);height:calc(100% - var(--input-box-height));overflow-wrap:anywhere;overflow-y:scroll;width:100%;word-break:break-all}dwg-chatbox #chat-container :first-child{margin-top:auto}dwg-chatbox #chat-container>*{margin-top:.3em;transition:background-color 1s}dwg-chatbox #chat-container>*.new-message{background-color:rgba(255,255,0,.4);transition:none}dwg-chatbox #chat-container>*.color-gray{color:var(--gray-color)}dwg-chatbox #new-messages-container{height:0;position:relative;width:100%}dwg-chatbox #new-messages-container #new-messages-button{--width: max(130px, 20%);background-color:#6e8cff;bottom:0;border:0px;border-radius:1.6em;height:1.5em;left:calc(50% - .5*var(--width));margin:0;padding:0;position:absolute;width:var(--width)}dwg-chatbox #new-messages-container #new-messages-button:not(.show){display:none}dwg-chatbox #new-messages-container #new-messages-button:hover{background-color:#82a0ff}dwg-chatbox #new-messages-container #new-messages-button:active{background-color:#5a6ef0}dwg-chatbox #new-messages-container #new-messages-button #new-messages-number{font-weight:bold}dwg-chatbox #new-messages-container #new-messages-button.new-message{font-weight:bolder}dwg-chatbox #new-messages-container #new-messages-button.new-message #new-messages-number{font-weight:bolder}dwg-chatbox #input-container{--margin: 8px;--send-button-width: calc(2.2 * var(--input-box-height));display:flex;flex-flow:row nowrap;height:var(--input-box-height);width:100%}dwg-chatbox #input-container>*{box-sizing:border-box;height:calc(100% - var(--margin));margin-top:var(--margin)}dwg-chatbox #input-container #chat-input{font-size:var(--font-size-medium);flex:0 0 calc(100% - var(--send-button-width) - 2px);line-height:var(--input-box-height);padding-left:.5em}dwg-chatbox #input-container #send-chat{font-size:1rem;margin-left:auto;width:var(--send-button-width)}dwg-chatbox.transparent-fade{background-color:rgba(0,0,0,0);color:#fff}dwg-chatbox.transparent-fade #chat-container{background-color:rgba(80,80,80,.5);border-radius:1em;box-sizing:border-box;line-height:1.1em;padding:1em}dwg-chatbox.transparent-fade #chat-container>*{transition:background-color 1s}dwg-chatbox.transparent-fade #chat-container>*.new-message{background-color:rgba(70,70,70,.7);transition:none}dwg-chatbox.transparent-fade #input-container{background-color:rgba(0,0,0,0)}dwg-chatbox.transparent-fade #input-container #chat-input{background-color:rgba(90,90,90,.8);border:1px solid #fff;color:#fff}dwg-chatbox.transparent-fade #input-container #send-chat{background-color:red;color:#fff}dwg-chatbox.transparent-fade:not(.show){pointer-events:none}dwg-chatbox.transparent-fade:not(.show).new-message{color:#fff}dwg-chatbox.transparent-fade:not(.show):not(.new-message){color:rgba(0,0,0,0);transition:color 1.5s 2s}dwg-chatbox.transparent-fade:not(.show) #chat-container{background-color:rgba(0,0,0,0);scrollbar-width:none;transition:background-color 1s .1s}dwg-chatbox.transparent-fade:not(.show) #chat-container::-webkit-scrollbar{display:none}dwg-chatbox.transparent-fade:not(.show) #new-messages-container{display:none}dwg-chatbox.transparent-fade:not(.show) #input-container{display:none}",""]);const r=o},9429:(e,t,i)=>{i.d(t,{Z:()=>r});var s=i(8081),a=i.n(s),n=i(3645),o=i.n(n)()(a());o.push([e.id,"dwg-confirm-dialog #wrapper{align-items:center;display:flex;flex-flow:column nowrap;height:35vh;gap:1em;max-height:400px;max-width:500px;min-height:220px;min-width:220px;width:35vw}dwg-confirm-dialog #wrapper>#button-wrapper{align-items:center;display:flex;flex-flow:row nowrap;gap:.5em;margin-top:auto}dwg-confirm-dialog #wrapper>#button-wrapper>buttom{color:#000;padding:.3em .6em}body.mobile dwg-confirm-dialog #wrapper{height:50svh;width:50vw}",""]);const r=o},5125:(e,t,i)=>{i.d(t,{Z:()=>r});var s=i(8081),a=i.n(s),n=i(3645),o=i.n(n)()(a());o.push([e.id,".dwg-dialog-box{align-items:center;background-color:rgba(120,120,120,.8);bottom:0;display:flex;left:0;justify-content:center;position:absolute;right:0;top:0;z-index:100}.dwg-dialog-box #wrapper{background-color:#505050;box-shadow:0px 0px 3px 3px rgba(200,200,200,.8);color:#fff;font-size:var(--font-size-medium);padding:1em;position:relative}.dwg-dialog-box #wrapper button{border-radius:.2em;font-size:var(--font-size-medium);padding:.1em .4em}",""]);const r=o},3411:(e,t,i)=>{i.d(t,{Z:()=>r});var s=i(8081),a=i.n(s),n=i(3645),o=i.n(n)()(a());o.push([e.id,"dwg-message-dialog #wrapper{align-items:center;display:flex;flex-flow:column nowrap;height:35vh;gap:1em;max-height:400px;max-width:500px;min-height:220px;min-width:220px;width:35vw}dwg-message-dialog #wrapper>#ok-button{color:#000;margin-top:auto;padding:.3em .6em}body.mobile dwg-message-dialog #wrapper{height:50svh;width:50vw}",""]);const r=o},1630:(e,t,i)=>{i.d(t,{Z:()=>r});var s=i(8081),a=i.n(s),n=i(3645),o=i.n(n)()(a());o.push([e.id,".dwg-element:not(.parsed),.dwg-element.hide{display:none}.dwg-element.hidden{visibility:hidden}",""]);const r=o},6415:(e,t,i)=>{i.d(t,{Z:()=>r});var s=i(8081),a=i.n(s),n=i(3645),o=i.n(n)()(a());o.push([e.id,"dwg-game{--card-image-scale: 1.452;--header-height: calc(1.5 * var(--font-size-small));background-color:#000}dwg-game>#header{background-color:#323232;display:flex;flex-flow:row nowrap;height:var(--header-height);max-height:var(--header-height);min-height:var(--header-height);width:100%}dwg-game>#header *{line-height:var(--header-height)}dwg-game>#header>#client-name{margin-left:1em}dwg-game>#header>#room-name,dwg-game>#header #game-name{margin-left:3em}dwg-game>#header>#button-container{align-items:center;display:flex;flex-flow:row nowrap;gap:2px;justify-content:center;margin-left:auto;margin-right:4px}dwg-game>#header>#button-container>button{border-radius:0;height:var(--header-height);padding:0;width:calc(1.3*var(--header-height))}dwg-game>#header>#button-container>button>img{height:100%;width:76.9230769231%}dwg-game>#header>#button-container>button>img.hide{display:none}dwg-game>#waiting-room{align-items:center;background-color:#964007;display:flex;height:calc(100% - var(--header-height));justify-content:center}dwg-game>#waiting-room.hide{display:none}dwg-game>#waiting-room .player-waiting{display:flex;flex-flow:row nowrap;font-size:18px;gap:1em;margin:.3em 0}dwg-game>#waiting-room .player-waiting :last-child{margin-left:auto}dwg-game>#waiting-room .player-waiting .connected{color:#64ff64}dwg-game>#game-container{--padding: var(--font-size-medium);--game-height: calc(100vh - var(--header-height) - 2 * var(--padding));--game-width: calc(100vw - 2 * var(--padding));--color-background: rgb(90, 40, 10);background-color:#461e05;box-sizing:border-box;height:calc(100vh - var(--header-height));padding:var(--padding)}dwg-game>#game-container:not(.show){display:none}dwg-game>#chatbox-container{--left: 3px;background-color:rgba(0,0,0,0);height:75vh;left:var(--left);position:absolute;top:10vh;width:50vw;z-index:9}dwg-game>#chatbox-container:not(.showing){pointer-events:none}dwg-game>#chatbox-container>#open-chatbox-button{--size: 36px;--img-size: 32px;align-items:center;background-color:rgba(250,250,250,.2);border:none;border-radius:calc(2*(var(--size) - var(--img-size)));display:flex;height:var(--size);justify-content:center;left:calc(-0.9*var(--size));pointer-events:all;position:relative;top:0;transition:left .3s;width:var(--size)}dwg-game>#chatbox-container>#open-chatbox-button:hover{background-color:rgba(250,250,250,.5);left:calc(-1*var(--left))}dwg-game>#chatbox-container>#open-chatbox-button:active{background-color:rgba(250,250,250,.8)}dwg-game>#chatbox-container>#open-chatbox-button>img{height:var(--img-size);width:var(--img-size)}body.mobile dwg-game{--header-height: calc(1.5 * var(--font-size-medium))}body.mobile dwg-game>#header>#client-name{display:none}body.mobile dwg-game>#header>#room-name{margin-left:1em}body.mobile dwg-game>#header>#game-name{display:none}body.mobile dwg-game>#header>#button-container{gap:3px}body.mobile dwg-game>#game-container{--padding: var(--font-size-small);--game-height: calc(100svh - var(--header-height) - 2 * var(--padding));height:calc(100svh - var(--header-height))}body.mobile dwg-game>#chatbox-container{height:75svh;top:10svh}body.mobile dwg-game>#chatbox-container>#open-chatbox-button{--size: 24px;--img-size: 20px;left:calc(-1*var(--left))}",""]);const r=o},2365:(e,t,i)=>{i.d(t,{Z:()=>r});var s=i(8081),a=i.n(s),n=i(3645),o=i.n(n)()(a());o.push([e.id,"dwg-game-history-dialog #wrapper{--button-size: 36px;align-items:center;background-color:#646464;border-radius:8px;color:#fff;height:80vh;max-height:1200px;max-width:800px;min-height:300px;min-width:250px;padding:var(--font-size-medium);position:relative;width:80vw}dwg-game-history-dialog #wrapper #close-button{background-color:rgba(0,0,0,0);border:none;border-radius:0px;border-top-right-radius:8px;height:var(--button-size);margin:0;padding:0;position:absolute;right:0;top:0;width:var(--button-size)}dwg-game-history-dialog #wrapper #close-button:hover{background-color:rgba(255,100,100,.6)}dwg-game-history-dialog #wrapper #close-button:active{background-color:rgba(255,180,180,.8)}dwg-game-history-dialog #wrapper #updates-container{--margin-top: calc(6px + var(--button-size) - var(--font-size-medium));height:calc(100% - var(--margin-top));margin-top:var(--margin-top);overflow-y:auto;width:100%}body.mobile dwg-game-history-dialog #wrapper{height:80svh}",""]);const r=o},7992:(e,t,i)=>{i.d(t,{Z:()=>r});var s=i(8081),a=i.n(s),n=i(3645),o=i.n(n)()(a());o.push([e.id,"dwg-game-info-dialog #wrapper{--button-size: 36px;align-items:center;background-color:#646464;border-radius:8px;color:#fff;height:80vh;max-height:1200px;max-width:800px;min-height:300px;min-width:250px;padding:var(--font-size-medium);position:relative;width:80vw}dwg-game-info-dialog #wrapper #close-button{background-color:rgba(0,0,0,0);border:none;border-radius:0px;border-top-right-radius:8px;height:var(--button-size);margin:0;padding:0;position:absolute;right:0;top:0;width:var(--button-size)}dwg-game-info-dialog #wrapper #close-button:hover{background-color:rgba(255,100,100,.6)}dwg-game-info-dialog #wrapper #close-button:active{background-color:rgba(255,180,180,.8)}dwg-game-info-dialog #wrapper>#content{display:flex;flex-flow:column nowrap;margin-top:var(--button-size);padding:1em;overflow-y:auto}dwg-game-info-dialog #wrapper>#content>*{box-sizing:border-box;min-height:1em;padding:4px;width:100%}dwg-game-info-dialog #wrapper>#content .size-small{font-size:var(--font-size-small);line-height:var(--font-size-small)}dwg-game-info-dialog #wrapper>#content .size-medium{font-size:var(--font-size-medium);line-height:var(--font-size-medium)}dwg-game-info-dialog #wrapper>#content .size-large{font-size:var(--font-size-large);line-height:var(--font-size-large);margin-top:.6em}dwg-game-info-dialog #wrapper>#content .size-larger{font-size:var(--font-size-larger);line-height:var(--font-size-larger);margin:.8em 0}body.mobile dwg-game-history-dialog #wrapper{height:80svh}",""]);const r=o},8596:(e,t,i)=>{i.d(t,{Z:()=>r});var s=i(8081),a=i.n(s),n=i(3645),o=i.n(n)()(a());o.push([e.id,"dwg-euchre{--height-players-cards: 182px;--width-messages: 180px;--size-player: 130px;--table-diameter: min( calc(var(--game-height) - var(--height-players-cards) - var(--size-player)), calc(var(--game-width) - 2 * var(--width-messages)) );background-color:var(--color-background);display:block;height:100%;position:relative;width:100%}dwg-euchre>#header-messages-container{--width: calc(var(--width-messages) - 2em);font-size:var(--font-size-medium);left:calc(.5*(100% - var(--table-diameter)) - var(--width-messages) + 1em);line-height:1.7em;position:absolute;top:1em;width:var(--width)}dwg-euchre>#header-messages-container>* .span-align{display:inline-block;text-align:right;width:50%}dwg-euchre>#header-messages-container>* .span-center{display:block;margin-top:.6em;text-align:center;text-decoration:underline}dwg-euchre>#card-face-up-container{--line-height: 1.7em;--width: calc(var(--width-messages) - 2em);--height: calc(var(--line-height) + var(--card-image-scale) * var(--width));border-radius:.4em;left:calc(1em + .5*(100% + var(--table-diameter)));line-height:var(--line-height);font-size:var(--font-size-medium);height:var(--height);position:absolute;text-align:center;top:1em;width:var(--width)}dwg-euchre>#card-face-up-container>#card-face-up-text{border-radius:.4em;letter-spacing:1.2px}dwg-euchre>#card-face-up-container>#card-face-up{height:calc(var(--card-image-scale)*var(--width));position:absolute;top:var(--line-height);width:var(--width)}dwg-euchre>#card-face-up-container>#card-face-up>#card-face-up-img{height:100%;width:100%}dwg-euchre>#card-face-up-container>#card-face-up>#card-face-up-img:not(.show){display:none}dwg-euchre>#table-container{background-position:center;background-repeat:no-repeat;background-size:contain;height:var(--table-diameter);left:calc(.5*(100% - var(--table-diameter)));position:absolute;top:calc(.5*var(--size-player));width:var(--table-diameter)}dwg-euchre>#table-container>#trick-cards{--width: min(125px, calc(0.18 * var(--table-diameter)));--height: calc(var(--card-image-scale) * var(--width));--num-players: 0;--winner: 0;--winner-rotation: calc((var(--winner) / var(--num-players)) * 1turn);--winner-turns: calc(var(--winner-rotation) + 0.25turn);--x-winner: calc(0.5 * (var(--table-diameter) + var(--table-diameter) * cos(var(--winner-turns))) - 0.5 * var(--width));--y-winner: calc(0.5 * (var(--table-diameter) + var(--table-diameter) * sin(var(--winner-turns))) - 0.5 * var(--height))}dwg-euchre>#table-container>#trick-cards>.card{--i: 0;--rotation: calc((var(--i) / var(--num-players)) * 1turn);--turns: calc(var(--rotation) + 0.25turn);--x-start: calc(0.5 * (var(--table-diameter) + var(--table-diameter) * cos(var(--turns))) - 0.5 * var(--width));--y-start: calc(0.5 * (var(--table-diameter) + var(--table-diameter) * sin(var(--turns))) - 0.5 * var(--height));--x-played: calc(0.5 * (var(--table-diameter) + var(--height) * cos(var(--turns))) - 0.5 * var(--width));--y-played: calc(0.5 * (var(--table-diameter) + var(--height) * sin(var(--turns))) - 0.5 * var(--height));--x-center: calc(0.5 * var(--table-diameter) - 0.5 * var(--width));--y-center: calc(0.5 * var(--table-diameter) - 0.5 * var(--height));display:block;height:var(--height);left:var(--x-start);position:absolute;top:var(--y-start);transform:rotate(var(--rotation));transition-duration:0s;transition-property:left,top,transform;transition-timing-function:ease-out;width:var(--width)}dwg-euchre>#table-container>#trick-cards>.card.played{left:var(--x-played);top:var(--y-played)}dwg-euchre>#table-container>#trick-cards>.card.center{left:var(--x-center);top:var(--y-center)}dwg-euchre>#table-container>#trick-cards>.card.winner{left:var(--x-winner);top:var(--y-winner);transform:rotate(var(--winner-rotation))}dwg-euchre>#table-container>#trick-cards>.card>img{height:100%;width:100%}dwg-euchre>#player-container{height:var(--table-diameter);left:calc(.5*(100% - var(--table-diameter)));position:absolute;top:calc(.5*var(--size-player));width:var(--table-diameter)}dwg-euchre>#player-container>dwg-euchre-player{--diameter: var(--table-diameter);--size: var(--size-player);height:var(--size);width:var(--size)}dwg-euchre>#players-cards{--width: min(calc(var(--table-diameter) + 2 * var(--width-messages)), 100%);height:var(--height-players-cards);left:calc(.5*(100% - var(--width)));position:absolute;top:calc(var(--size-player) + var(--table-diameter));width:var(--width);z-index:4}",""]);const r=o},4833:(e,t,i)=>{i.d(t,{Z:()=>r});var s=i(8081),a=i.n(s),n=i(3645),o=i.n(n)()(a());o.push([e.id,'dwg-euchre-player{--order: 0;--num-players: 0;--turns: calc((0.25 + var(--order) / var(--num-players)) * 1turn);--x: calc(0.5 * var(--diameter) * (1 + cos(var(--turns))) - 0.5 * var(--size));--y: calc(0.5 * var(--diameter) * (1 + sin(var(--turns))) - 0.5 * var(--size));--icon-size: 48px;--turn-color: rgba(250, 140, 140, 0.95);--background-color: rgba(240, 240, 240, 0.7);background-color:var(--background-color);border-radius:calc(.08*var(--size));color:#000;display:block;left:var(--x);position:absolute;top:var(--y);z-index:4}dwg-euchre-player.turn{box-shadow:0 0 6px 6px var(--turn-color)}dwg-euchre-player.team0{--background-color: rgba(60, 120, 255, 0.85)}dwg-euchre-player.team1{--background-color: rgba(20, 255, 20, 0.7)}dwg-euchre-player.going-alone-ally{opacity:60%}dwg-euchre-player>*{box-sizing:border-box;font-size:calc(.13*var(--size));height:calc(.25*var(--size));line-height:calc(.2*var(--size));width:100%}dwg-euchre-player>#icons-wrapper{display:flex;flex-flow:row nowrap;gap:5px;height:var(--icon-size);left:min(10%,10px);position:absolute;top:calc(-0.75*var(--icon-size));width:fit-content}dwg-euchre-player>#icons-wrapper>.icon-wrapper{height:var(--icon-size);opacity:75%;width:var(--icon-size)}dwg-euchre-player>#icons-wrapper>.icon-wrapper>.icon{height:100%;rotate:-30deg;width:100%}dwg-euchre-player>#icons-wrapper>.icon-wrapper>.icon-tooltip{background-color:rgba(60,60,60,.95);border-radius:.6em;bottom:-1em;color:#fff;padding:.2em .4em;position:absolute;transition:opacity .5s;user-select:none;white-space:nowrap}dwg-euchre-player>#icons-wrapper>.icon-wrapper:not(:hover)>.icon-tooltip{opacity:0%}dwg-euchre-player>#name-container{font-weight:bold;padding:.5em .4em .2em;text-align:center}dwg-euchre-player>#status-container{padding:.1em .3em;text-align:center}dwg-euchre-player .fixed-width{display:inline-block;padding:0 .2em;text-align:right;width:40%}dwg-euchre-player #bid-animation{background-color:rgba(60,60,60,.7);border-radius:.5em;color:#fff;font-size:0;font-weight:bold;left:0px;margin:0 auto;padding:.5em;position:relative;text-align:center;top:calc(-1em - 6px);transition-property:font-size;transition-timing-function:ease;width:fit-content}dwg-euchre-player #bid-animation.transition{font-size:var(--font-size-large)}dwg-euchre-player>#bid-input-wrapper{--height: 32px;--gap: 5px;--padding: 0.5em;--total-height: calc(4 * var(--height) + 3 * var(--gap) + 2 * var(--padding));background-color:var(--background-color);border-radius:calc(.08*var(--size));box-shadow:0 0 6px 6px var(--turn-color);display:flex;flex-flow:column nowrap;font-size:calc(.13*var(--size));gap:var(--gap);height:var(--total-height);line-height:calc(.2*var(--size));padding:var(--padding);position:absolute;text-align:center;top:calc(-1.1*var(--total-height));width:100%;z-index:2}dwg-euchre-player>#bid-input-wrapper:not(.show){display:none}dwg-euchre-player>#bid-input-wrapper.choosing-trump{--total-height: calc(5 * var(--height) + 4 * var(--gap) + 2 * var(--padding))}dwg-euchre-player>#bid-input-wrapper.choosing-trump>#bid-button{display:none}dwg-euchre-player>#bid-input-wrapper:not(.choosing-trump)>.suits-button-row{display:none}dwg-euchre-player>#bid-input-wrapper>*{flex:0 0 var(--height);height:var(--height);max-height:var(--height);min-height:var(--height)}dwg-euchre-player>#bid-input-wrapper>.suits-button-row>button{height:var(--height);margin:0;padding:0;width:var(--height)}dwg-euchre-player>#bid-input-wrapper>.suits-button-row>button:disabled{opacity:80%}dwg-euchre-player>#bid-input-wrapper>.suits-button-row>button.disabled:after{border-top:2px solid darkred;content:"";display:block;position:absolute;transform:translateX(calc(-1 * var(--height) / 4.8284271247)) translateY(calc(1px - var(--gap) - 0.5 * var(--height))) rotate(-45deg);width:calc(1.414*var(--height))}dwg-euchre-player>#bid-input-wrapper>.suits-button-row>button>img{height:100%;width:100%}dwg-euchre-player>#bid-input-wrapper>button{font-size:calc(.13*var(--size))}body.mobile dwg-euchre-player{--icon-size: 40px}body.mobile dwg-euchre-player>.icon-wrapper.show-tooltip>.icon-tooltip{opacity:100%}',""]);const r=o},7868:(e,t,i)=>{i.d(t,{Z:()=>r});var s=i(8081),a=i.n(s),n=i(3645),o=i.n(n)()(a());o.push([e.id,"dwg-fiddlesticks{--height-players-cards: 182px;--width-messages: 180px;--size-player: 130px;--table-diameter: min( calc(var(--game-height) - var(--height-players-cards) - var(--size-player)), calc(var(--game-width) - 2 * var(--width-messages)) );background-color:var(--color-background);display:block;height:100%;position:relative;width:100%}dwg-fiddlesticks>#header-messages-container{--width: calc(var(--width-messages) - 2em);font-size:var(--font-size-medium);left:calc(.5*(100% - var(--table-diameter)) - var(--width-messages) + .2em);line-height:1.7em;position:absolute;top:1em;width:var(--width)}dwg-fiddlesticks>#header-messages-container>* .span-align{display:inline-block;text-align:right;width:50%}dwg-fiddlesticks>#header-messages-container>* .span-center{display:block;margin-top:.6em;text-align:center;text-decoration:underline}dwg-fiddlesticks>#trump-card-container{--line-height: 1.7em;--width: calc(var(--width-messages) - 2em);--height: calc(var(--line-height) + var(--card-image-scale) * var(--width));border-radius:.4em;left:calc(1.8em + .5*(100% + var(--table-diameter)));line-height:var(--line-height);font-size:var(--font-size-medium);height:var(--height);position:absolute;text-align:center;top:1em;width:var(--width)}dwg-fiddlesticks>#trump-card-container>#trump-text{border-radius:.4em;letter-spacing:1.2px}dwg-fiddlesticks>#trump-card-container>#trump-card{height:calc(var(--card-image-scale)*var(--width));position:absolute;top:var(--line-height);width:var(--width)}dwg-fiddlesticks>#trump-card-container>#trump-card>#trump-card-img{height:100%;width:100%}dwg-fiddlesticks>#trump-card-container>#trump-card>#trump-card-img:not(.show){display:none}dwg-fiddlesticks>#table-container{background-position:center;background-repeat:no-repeat;background-size:contain;height:var(--table-diameter);left:calc(.5*(100% - var(--table-diameter)));position:absolute;top:calc(.5*var(--size-player));width:var(--table-diameter)}dwg-fiddlesticks>#table-container>#trick-cards{--width: min(125px, calc(0.18 * var(--table-diameter)));--height: calc(var(--card-image-scale) * var(--width));--num-players: 0;--winner: 0;--winner-rotation: calc((var(--winner) / var(--num-players)) * 1turn);--winner-turns: calc(var(--winner-rotation) + 0.25turn);--x-winner: calc(0.5 * (var(--table-diameter) + var(--table-diameter) * cos(var(--winner-turns))) - 0.5 * var(--width));--y-winner: calc(0.5 * (var(--table-diameter) + var(--table-diameter) * sin(var(--winner-turns))) - 0.5 * var(--height))}dwg-fiddlesticks>#table-container>#trick-cards>.card{--i: 0;--rotation: calc((var(--i) / var(--num-players)) * 1turn);--turns: calc(var(--rotation) + 0.25turn);--x-start: calc(0.5 * (var(--table-diameter) + var(--table-diameter) * cos(var(--turns))) - 0.5 * var(--width));--y-start: calc(0.5 * (var(--table-diameter) + var(--table-diameter) * sin(var(--turns))) - 0.5 * var(--height));--x-played: calc(0.5 * (var(--table-diameter) + var(--height) * cos(var(--turns))) - 0.5 * var(--width));--y-played: calc(0.5 * (var(--table-diameter) + var(--height) * sin(var(--turns))) - 0.5 * var(--height));--x-center: calc(0.5 * var(--table-diameter) - 0.5 * var(--width));--y-center: calc(0.5 * var(--table-diameter) - 0.5 * var(--height));display:block;height:var(--height);left:var(--x-start);position:absolute;top:var(--y-start);transform:rotate(var(--rotation));transition-duration:0s;transition-property:left,top,transform;transition-timing-function:ease-out;width:var(--width)}dwg-fiddlesticks>#table-container>#trick-cards>.card.played{left:var(--x-played);top:var(--y-played)}dwg-fiddlesticks>#table-container>#trick-cards>.card.center{left:var(--x-center);top:var(--y-center)}dwg-fiddlesticks>#table-container>#trick-cards>.card.winner{left:var(--x-winner);top:var(--y-winner);transform:rotate(var(--winner-rotation))}dwg-fiddlesticks>#table-container>#trick-cards>.card>img{height:100%;width:100%}dwg-fiddlesticks>#player-container{height:var(--table-diameter);left:calc(.5*(100% - var(--table-diameter)));position:absolute;top:calc(.5*var(--size-player));width:var(--table-diameter)}dwg-fiddlesticks>#player-container>dwg-fiddlesticks-player{--diameter: var(--table-diameter);--size: var(--size-player);height:var(--size);width:var(--size)}dwg-fiddlesticks>#players-cards{--width: min(calc(var(--table-diameter) + 2 * var(--width-messages)), 100%);height:var(--height-players-cards);left:calc(.5*(100% - var(--width)));position:absolute;top:calc(var(--size-player) + var(--table-diameter));width:var(--width);z-index:4}body.mobile dwg-fiddlesticks{--height-players-cards: min(120px, 18svh);--width-messages: calc(0.5 * var(--game-width));--height-messages: calc(5 * 1.7em + 0.6em);--size-player: min(90px, 13svh);--messages-gap: var(--font-size-smallest);--table-diameter: min( calc(var(--game-height) - var(--height-players-cards) - var(--size-player) - var(--height-messages) - var(--messages-gap)), calc(var(--game-width) - var(--size-player)) );--total-height: calc(var(--height-messages) + var(--messages-gap) + var(--table-diameter) + var(--size-player) + var(--height-players-cards));--leftover-height: calc(var(--game-height) - var(--total-height));--margin-top: max(0px, max(calc(var(--leftover-height) - 5em), calc(0.5 * var(--leftover-height))));font-size:var(--font-size-smaller)}body.mobile dwg-fiddlesticks>#header-messages-container{font-size:var(--font-size-smallest);left:1em;top:calc(.7*var(--margin-top))}body.mobile dwg-fiddlesticks>#trump-card-container{--height: var(--height-messages);font-size:var(--font-size-smallest);left:calc(1em + var(--width-messages));top:calc(.7*var(--margin-top))}body.mobile dwg-fiddlesticks>#trump-card-container>#trump-text{border-radius:.4em;letter-spacing:1.2px}body.mobile dwg-fiddlesticks>#trump-card-container>#trump-card{--height-trump: calc(var(--height-messages) - var(--line-height));--width-trump: calc(var(--height-trump) / var(--card-image-scale));height:var(--height-trump);left:calc(.5*(var(--width-messages) - 2em - var(--width-trump)));width:var(--width-trump)}body.mobile dwg-fiddlesticks>#trump-card-container>#trump-card>#trump-card-img{height:100%;width:100%}body.mobile dwg-fiddlesticks>#trump-card-container>#trump-card>#trump-card-img:not(.show){display:none}body.mobile dwg-fiddlesticks>#table-container{left:calc(.5*(var(--game-width) - var(--table-diameter)));top:calc(var(--margin-top) + var(--height-messages) + var(--messages-gap) + .5*var(--size-player))}body.mobile dwg-fiddlesticks>#player-container{left:calc(.5*(var(--game-width) - var(--table-diameter)));top:calc(var(--margin-top) + var(--height-messages) + var(--messages-gap) + .5*var(--size-player))}body.mobile dwg-fiddlesticks>#players-cards{--width: var(--game-width);left:0;top:calc(var(--margin-top) + var(--height-messages) + var(--messages-gap) + var(--size-player) + var(--table-diameter))}",""]);const r=o},8561:(e,t,i)=>{i.d(t,{Z:()=>r});var s=i(8081),a=i.n(s),n=i(3645),o=i.n(n)()(a());o.push([e.id,"dwg-fiddlesticks-player{--order: 0;--num-players: 0;--turns: calc((0.25 + var(--order) / var(--num-players)) * 1turn);--x: calc(0.5 * var(--diameter) * (1 + cos(var(--turns))) - 0.5 * var(--size));--y: calc(0.5 * var(--diameter) * (1 + sin(var(--turns))) - 0.5 * var(--size));--icon-size: 64px;--turn-color: rgba(90, 10, 240, 0.8);background-color:rgba(240,240,240,.7);border-radius:calc(.08*var(--size));color:#000;display:block;left:var(--x);position:absolute;top:var(--y);z-index:4}dwg-fiddlesticks-player.turn{box-shadow:0 0 6px 6px var(--turn-color)}dwg-fiddlesticks-player>*{box-sizing:border-box;font-size:calc(.13*var(--size));height:calc(.2*var(--size));line-height:calc(.2*var(--size));width:100%}dwg-fiddlesticks-player>#name-container{font-weight:bold;padding:.3em .4em .2em;text-align:center}dwg-fiddlesticks-player>#status-container{padding-left:.3em;text-align:center}dwg-fiddlesticks-player .fixed-width{display:inline-block;padding:0 .2em;text-align:right;width:40%}dwg-fiddlesticks-player #bet-input-wrapper{--height: calc(0.2 * var(--size));--gap: 5px;--padding: 0.5em;--total-height: calc(3 * var(--height) + 2 * var(--gap) + 2 * var(--padding));background-color:rgba(240,240,240,.6);border-radius:calc(.08*var(--size));box-shadow:0 0 6px 6px var(--turn-color);display:flex;flex-flow:column nowrap;font-size:calc(.13*var(--size));gap:var(--gap);height:var(--total-height);line-height:calc(.2*var(--size));padding:var(--padding);position:absolute;text-align:center;top:calc(-1.1*var(--total-height));width:100%;z-index:2}dwg-fiddlesticks-player #bet-input-wrapper:not(.show){display:none}dwg-fiddlesticks-player #bet-input-wrapper>*{flex:0 0 var(--height);height:var(--height);max-height:var(--height);min-height:var(--height)}dwg-fiddlesticks-player #bet-input-wrapper>#bet-input{font-size:calc(.13*var(--size))}dwg-fiddlesticks-player #bet-input-wrapper>#bet-button{font-size:calc(.18*var(--size));line-height:calc(.18*var(--size))}dwg-fiddlesticks-player #bet-animation{background-color:rgba(60,60,60,.7);border-radius:.5em;color:#fff;font-size:0;font-weight:bold;left:0px;margin:0 auto;padding:.5em;position:relative;text-align:center;top:calc(-1em - 6px);transition-property:font-size;transition-timing-function:ease;width:fit-content}dwg-fiddlesticks-player #bet-animation.transition{font-size:var(--font-size-largest)}dwg-fiddlesticks-player>.icon-wrapper{height:var(--icon-size);left:min(10%,10px);opacity:75%;position:absolute;top:calc(-0.75*var(--icon-size));width:var(--icon-size)}dwg-fiddlesticks-player>.icon-wrapper:not(.show){display:none}dwg-fiddlesticks-player>.icon-wrapper>.icon{height:100%;rotate:-30deg;width:100%}dwg-fiddlesticks-player>.icon-wrapper>.icon-tooltip{background-color:rgba(60,60,60,.95);border-radius:.6em;bottom:-1em;color:#fff;padding:.2em .4em;position:absolute;transition:opacity .5s;user-select:none;white-space:nowrap}dwg-fiddlesticks-player>.icon-wrapper:not(:hover)>.icon-tooltip{opacity:0%}body.mobile dwg-fiddlesticks-player{--icon-size: 40px}body.mobile dwg-fiddlesticks-player>.icon-wrapper.show-tooltip>.icon-tooltip{opacity:100%}",""]);const r=o},3217:(e,t,i)=>{i.d(t,{Z:()=>r});var s=i(8081),a=i.n(s),n=i(3645),o=i.n(n)()(a());o.push([e.id,"dwg-risq #board{height:100%;overflow:hidden;width:100%}",""]);const r=o},2506:(e,t,i)=>{i.d(t,{Z:()=>r});var s=i(8081),a=i.n(s),n=i(3645),o=i.n(n)()(a());o.push([e.id,"dwg-space-dialog #wrapper{align-items:center;display:flex;flex-flow:column nowrap;height:var(--h);gap:1em;padding:0 !important;width:var(--w)}dwg-space-dialog #wrapper>#close-button{--size: 36px;right:0;margin:0;padding:4px;position:absolute;top:calc(-1*var(--size))}",""]);const r=o},2311:(e,t,i)=>{i.d(t,{Z:()=>r});var s=i(8081),a=i.n(s),n=i(3645),o=i.n(n)()(a());o.push([e.id,"dwg-players-dialog #wrapper{--button-size: 36px;align-items:center;background-color:#646464;border-radius:8px;color:#fff;height:80vh;max-height:1200px;max-width:800px;min-height:300px;min-width:250px;padding:var(--font-size-medium);position:relative;width:80vw}dwg-players-dialog #wrapper #close-button{background-color:rgba(0,0,0,0);border:none;border-radius:0px;border-top-right-radius:8px;height:var(--button-size);margin:0;padding:0;position:absolute;right:0;top:0;width:var(--button-size)}dwg-players-dialog #wrapper #close-button:hover{background-color:rgba(255,100,100,.6)}dwg-players-dialog #wrapper #close-button:active{background-color:rgba(255,180,180,.8)}dwg-players-dialog #wrapper #players-container{--margin-top: calc(6px + var(--button-size) - var(--font-size-medium));display:flex;flex-flow:column nowrap;gap:var(--font-size-small);height:calc(100% - var(--margin-top));margin-top:var(--margin-top);overflow-y:auto;width:100%}body.mobile dwg-players-dialog #wrapper{height:80svh}",""]);const r=o},9936:(e,t,i)=>{i.d(t,{Z:()=>r});var s=i(8081),a=i.n(s),n=i(3645),o=i.n(n)()(a());o.push([e.id,"dwg-players-dialog-player{display:flex;color:#fff;flex-flow:row nowrap;font-size:var(--font-size-large);gap:var(--font-size-small);height:var(--font-size-largest);line-height:var(--font-size-largest);overflow:hidden;user-select:none;width:100%}dwg-players-dialog-player>#ping{flex:0 0 calc(.8*var(--font-size-largest));padding:calc(.1*var(--font-size-largest));position:relative}dwg-players-dialog-player>#ping:not(:hover)>#ping-text{display:none}dwg-players-dialog-player>#ping>#ping-text{background-color:rgba(90,90,90,.9);bottom:calc(50% - .5*(var(--font-size-medium) + .6em));font-size:var(--font-size-medium);left:calc(100% + var(--font-size-small));line-height:var(--font-size-medium);padding:.3em;position:absolute;white-space:nowrap;z-index:2}dwg-players-dialog-player>#nickname{white-space:nowrap}dwg-players-dialog-player>#rejoin-link{background-color:rgba(0,0,0,0);border:none;border-radius:1em !important;color:#fff;display:block;font-size:var(--font-size-medium) !important;margin-left:auto;min-width:0;padding:0 1em !important;position:relative}dwg-players-dialog-player>#rejoin-link:hover{background-color:rgba(150,150,150,.2)}dwg-players-dialog-player>#rejoin-link:active{background-color:rgba(150,150,150,.4)}dwg-players-dialog-player>#rejoin-link:not(:hover)>#rejoin-link-image{display:none}dwg-players-dialog-player>#rejoin-link>#rejoin-link-text{overflow-x:hidden;text-overflow:ellipsis;white-space:nowrap}dwg-players-dialog-player>#rejoin-link>#rejoin-link-image{background-color:rgba(90,90,90,.9);height:calc(.6*var(--font-size-largest));position:absolute;right:calc(.2*var(--font-size-largest));top:calc(.2*var(--font-size-largest));width:calc(.6*var(--font-size-largest));z-index:2}",""]);const r=o},5254:(e,t,i)=>{i.d(t,{Z:()=>r});var s=i(8081),a=i.n(s),n=i(3645),o=i.n(n)()(a());o.push([e.id,"dwg-canvas-board{background-color:#000;border:1px solid #fff;box-sizing:border-box;cursor:none;display:block;overflow:hidden}dwg-canvas-board #canvas{--h: 0px;--w: 0px;height:var(--h);position:relative;width:var(--w)}dwg-canvas-board #cursor{--x: -120px;--y: -120px;left:var(--x);position:absolute;top:var(--y);user-select:none;z-index:2}dwg-canvas-board #cursor.hide{display:none}",""]);const r=o},3697:(e,t,i)=>{i.d(t,{Z:()=>r});var s=i(8081),a=i.n(s),n=i(3645),o=i.n(n)()(a());o.push([e.id,"dwg-card-hand{--height: 0;--width: 0;--play-drop-margin: 0;display:block;height:100%;width:100%}dwg-card-hand>#cards-container{--min-padding: 3px;--num-cards: 0;--card-width: calc((var(--height) - var(--min-padding)) / var(--card-image-scale));--card-overlap: min( calc(-0.3 * var(--card-width)), calc(((var(--width) - var(--card-width)) / (var(--num-cards) - 1)) - var(--card-width)) );--total-card-width: calc(var(--card-width) + (var(--num-cards) - 1) * (var(--card-width) + var(--card-overlap)));box-sizing:border-box;display:flex;flex-flow:row nowrap;height:calc(100% - var(--min-padding));justify-content:flex-start;margin-top:var(--min-padding);padding-left:max(var(--min-padding),.5*(var(--width) - var(--total-card-width)));width:100%}dwg-card-hand>#cards-container>.card{--i: 0;flex:0 0 var(--card-width);height:100%;max-width:var(--card-width);min-width:var(--card-width);order:var(--i);touch-action:none;transform:translateX(calc(var(--i) * var(--card-overlap))) rotate(-3deg);user-select:none;width:var(--card-width)}dwg-card-hand>#cards-container>.card.hovering{transform:translate(calc(var(--i) * var(--card-overlap)), calc(-0.1 * var(--height))) rotate(-1deg);z-index:3}dwg-card-hand>#cards-container>.card.dragging{transform:translate(calc(var(--i) * var(--card-overlap) + var(--x)), calc(-0.1 * var(--height) + var(--y)));z-index:3}dwg-card-hand>#cards-container>.card>img{height:100%;width:100%}dwg-card-hand>#play-drop{background-color:rgba(100,250,100,.15);height:100vh;left:-100vw;position:absolute;top:calc(-100vh - var(--play-drop-margin));width:200vw;z-index:2}dwg-card-hand>#play-drop.hovering{background-color:rgba(100,250,100,.3)}dwg-card-hand>#cancel-drop{background-color:rgba(250,100,100,.15);height:100vh;left:-100vw;position:absolute;top:calc(-1*var(--play-drop-margin));width:200vw;z-index:2}dwg-card-hand>#cancel-drop.hovering{background-color:rgba(250,100,100,.3)}dwg-card-hand:not(.dragging-playing)>#play-drop{display:none}dwg-card-hand:not(.dragging-playing)>#cancel-drop{display:none}",""]);const r=o},2732:(e,t,i)=>{i.d(t,{Z:()=>r});var s=i(8081),a=i.n(s),n=i(3645),o=i.n(n)()(a());o.push([e.id,"dwg-lobby{--name-header-height: calc(1.6 * var(--font-size-small));--buttons-height: calc(1.5 * var(--font-size-large));--chat-height: calc(min(450px, max(180px, 25vh)));--lobby-users-width: 250px;--lobby-rooms-height: calc(100vh - var(--name-header-height) - var(--buttons-height) - var(--chat-height));background-color:#143c78;display:flex;flex-flow:column nowrap}dwg-lobby.hide{display:none}dwg-lobby>#page-header{background-color:#001e3c;box-sizing:border-box;display:block;font-size:var(--font-size-small);height:var(--name-header-height);line-height:var(--name-header-height);max-height:var(--name-header-height);min-height:var(--name-header-height);padding-left:1.5em;width:100%}dwg-lobby>#page-header #ping-container{margin-left:2em}dwg-lobby>#buttons{--padding: 6px;background-color:#0a3264;border-bottom:2px solid #000;box-sizing:border-box;display:flex;flex-flow:row nowrap;gap:var(--padding);height:var(--buttons-height);padding-left:var(--padding);max-height:var(--buttons-height);min-height:var(--buttons-height);width:100%}dwg-lobby>#buttons>button{background-color:rgba(0,0,0,0);border:none;border-radius:calc(2*var(--padding));color:#fff;font-size:calc(.7*(var(--buttons-height) - 2*var(--padding)));line-height:calc(var(--buttons-height) - 2*var(--padding));padding:var(--padding);transition:background-color 200ms,border-radius 200ms}dwg-lobby>#buttons>button:hover:not(:disabled){background-color:rgba(50,100,200,.2)}dwg-lobby>#buttons>button:active:not(:disabled){background-color:rgba(70,140,250,.4);border-radius:0px}dwg-lobby>#buttons>button:disabled{background-color:rgba(150,150,150,.6);border-radius:8px;transition:none}dwg-lobby>#buttons>button#lobby-users-button{display:none;margin-left:auto;z-index:2}dwg-lobby>#horizontal-container{display:flex;flex-flow:row nowrap;flex:1 0 0;width:100%}dwg-lobby>#horizontal-container>#vertical-container{display:flex;flex-flow:column nowrap;flex:1 0 0;height:100%}dwg-lobby>#horizontal-container>#vertical-container>#lobby-rooms{box-sizing:border-box;flex:0 0 var(--lobby-rooms-height);height:var(--lobby-rooms-height);max-height:var(--lobby-rooms-height);min-height:var(--lobby-rooms-height);padding:.5em}dwg-lobby>#horizontal-container>#vertical-container>#chatbox{box-sizing:border-box;flex:1 1 var(--chat-height);height:var(--chat-height);max-height:var(--chat-height);min-height:var(--chat-height);padding:.5em}dwg-lobby>#horizontal-container>#lobby-users-backdrop{background-color:rgba(150,150,150,.5);display:none;height:100vh;left:0px;position:absolute;top:0px;width:100vw}dwg-lobby>#horizontal-container>#lobby-users{background-color:#0a1e32;box-sizing:border-box;height:100%;padding:8px;width:var(--lobby-users-width)}dwg-lobby>#lobby-room-wrapper{background-color:rgba(150,150,150,.5);bottom:0;left:0;position:absolute;right:0;top:0;z-index:3}dwg-lobby>#lobby-room-wrapper:not(.show){display:none}dwg-lobby>#lobby-room-wrapper #lobby-room{--width: max(70vw, min(530px, calc(100vw - 16px)));box-sizing:border-box;height:70vh;margin:15vh auto;padding:8px;width:var(--width)}dwg-lobby>#lobby-connected-wrapper{align-items:center;background-color:rgba(150,150,150,.5);bottom:0;display:flex;font-size:3vw;justify-content:center;left:0;position:absolute;right:0;top:0;z-index:4}dwg-lobby.connected #lobby-connected-wrapper{display:none}dwg-lobby.connector-open #connecting-message{display:none}body.mobile dwg-lobby{--lobby-rooms-height: calc(100svh - var(--name-header-height) - var(--buttons-height) - var(--chat-height))}body.mobile dwg-lobby>#buttons>#lobby-users-button{display:block}body.mobile dwg-lobby>#horizontal-container{width:calc(100% + var(--lobby-users-width))}body.mobile dwg-lobby>#horizontal-container>#lobby-users-backdrop{height:100svh}body.mobile dwg-lobby>#horizontal-container>#lobby-users-backdrop.show{display:block}body.mobile dwg-lobby>#horizontal-container>#lobby-users{left:0px;position:relative;transition:left 400ms ease-in-out}body.mobile dwg-lobby>#horizontal-container>#lobby-users.show{left:calc(-1*var(--lobby-users-width))}body.mobile dwg-lobby>#lobby-room-wrapper #lobby-room{box-sizing:border-box;height:90svh;margin:5svh 5vw;padding:6px;width:90vw}",""]);const r=o},2011:(e,t,i)=>{i.d(t,{Z:()=>r});var s=i(8081),a=i.n(s),n=i(3645),o=i.n(n)()(a());o.push([e.id,"dwg-lobby-connector{font-size:var(--font-size-large);height:100vh;left:0px;position:absolute;top:0px;width:100vw}dwg-lobby-connector.hide{display:none}dwg-lobby-connector>#card{--width: calc(12 * var(--font-size-large));background-color:#dcdcdc;box-shadow:0 0 8px 8px rgba(60,60,60,.7);color:#000;height:calc(11*var(--font-size-large));left:calc(50% - 100px);padding:16px;position:relative;top:calc(50% - 150px);width:var(--width)}dwg-lobby-connector>#card button{display:block;font-size:var(--font-size-large);margin:20px auto 0;width:var(--width)}dwg-lobby-connector>#card>#reconnect-wrapper:not(.show){display:none}dwg-lobby-connector>#card>#reconnect-wrapper>#previous-nickname{height:calc(1.8*var(--font-size-large));text-align:center}dwg-lobby-connector>#card>#reconnect-wrapper>#new-connection-info{font-size:var(--font-size-small);text-align:center}dwg-lobby-connector>#card>#connect-wrapper:not(.show){display:none}dwg-lobby-connector>#card>#connect-wrapper>#nickname{display:block;font-size:var(--font-size-large);margin:20px auto 30px;width:var(--width)}dwg-lobby-connector>#card>#status-message{color:#b42828;font-size:var(--font-size-small);margin-top:.5em;text-align:center}body.mobile dwg-lobby-connector{height:100svh}body.mobile dwg-lobby-connector #card{box-sizing:border-box;left:6px;width:calc(100% - 12px)}body.mobile dwg-lobby-connector #card #nickname{width:calc(100% - 24px)}body.mobile dwg-lobby-connector #card #connect-button{width:calc(100% - 24px)}",""]);const r=o},7923:(e,t,i)=>{i.d(t,{Z:()=>r});var s=i(8081),a=i.n(s),n=i(3645),o=i.n(n)()(a());o.push([e.id,"dwg-lobby-game-settings{background-color:rgba(150,150,150,.4);bottom:0;left:0;position:absolute;right:0;top:0}dwg-lobby-game-settings:not(.show){display:none}dwg-lobby-game-settings>#game-settings-wrapper{background-color:#d3d3d3;box-shadow:0 0 6px 6px rgba(70,70,70,.5);box-sizing:border-box;color:#000;display:flex;flex-flow:column nowrap;font-size:var(--font-size-medium);gap:1.6em;height:50vh;margin:25vh auto;overflow-y:auto;padding:8px;width:50vw}dwg-lobby-game-settings>#game-settings-wrapper *{font-size:var(--font-size-medium);line-height:var(--font-size-medium)}dwg-lobby-game-settings>#game-settings-wrapper label{font-size:.8rem}dwg-lobby-game-settings>#game-settings-wrapper input{font-size:var(--font-size-medium)}dwg-lobby-game-settings>#game-settings-wrapper .row-wrapper{display:flex;flex-flow:row nowrap;gap:8px}dwg-lobby-game-settings>#game-settings-wrapper .row-wrapper>.input-wrapper{flex:1 0 0;min-width:0}dwg-lobby-game-settings>#game-settings-wrapper .row-wrapper>.input-wrapper>input{min-width:0;width:100%}dwg-lobby-game-settings>#game-settings-wrapper>#game-settings-title{font-size:var(--font-size-large);line-height:calc(2*var(--font-size-large));text-align:center}dwg-lobby-game-settings>#game-settings-wrapper>#game-specific-settings{display:flex;flex-flow:column nowrap;gap:12px;height:fit-content}dwg-lobby-game-settings>#game-settings-wrapper>#room-description{resize:vertical}dwg-lobby-game-settings>#game-settings-wrapper>#save-button{font-size:var(--font-size-medium);margin-top:.4em}body.mobile dwg-lobby-game-settings>#game-settings-wrapper{height:80svh;margin:10svh auto;padding:8px;width:90vw}body.mobile dwg-lobby-game-settings>#game-settings-wrapper .row-wrapper{flex-direction:column}",""]);const r=o},2991:(e,t,i)=>{i.d(t,{Z:()=>r});var s=i(8081),a=i.n(s),n=i(3645),o=i.n(n)()(a());o.push([e.id,"dwg-lobby-room{background-color:#5ab4fa;box-shadow:0px 0px 3px 4px rgba(70,140,210,.8),0px 0px 6px 8px rgba(50,100,170,.8),0px 0px 9px 12px rgba(30,60,130,.8);display:flex;flex-flow:column nowrap;gap:8px}dwg-lobby-room:not(.show){display:none}dwg-lobby-room #room-header{--font-size-header: min(28px, var(--font-size-large));--header-height: calc(1.6 * var(--font-size-header));background-color:#3c78d2;display:flex;flex-flow:row nowrap;height:var(--header-height);width:100%}dwg-lobby-room #room-header #room-name{flex:1 0 0;font-size:var(--font-size-header);height:100%;line-height:var(--header-height);padding-left:.35em}dwg-lobby-room #room-header #room-name:not(.show){display:none}dwg-lobby-room #room-header #rename-input{box-sizing:border-box;flex:1 0 0;font-size:var(--font-size-header);height:100%;line-height:var(--header-height);min-width:0px;padding-left:.35em}dwg-lobby-room #room-header #rename-input:not(.show){display:none}dwg-lobby-room #room-header #rename-room:not(.show){display:none}dwg-lobby-room #room-header #cancel-rename{font-size:var(--font-size-medium);width:calc(4*var(--font-size-medium))}dwg-lobby-room #room-header #cancel-rename:not(.show){display:none}dwg-lobby-room #room-header>button{background-color:rgba(0,0,0,0);border:none;border-radius:6px;height:100%;margin:0px;padding:0px;width:var(--header-height)}dwg-lobby-room #room-header>button:hover{background-color:rgba(220,220,220,.5)}dwg-lobby-room #room-header>button:active{background-color:rgba(220,220,220,.8)}dwg-lobby-room #room-header>button>img{--img-height: min(32px, 0.8 * var(--header-height));height:var(--img-height);width:var(--img-height)}dwg-lobby-room>#room-body{display:flex;flex-flow:row nowrap;flex:1 0 0;min-height:0px;width:100%}dwg-lobby-room>#room-body>#left-panel{--width: min(320px, calc(100% - 300px));background-color:#1e5ab4;display:flex;flex-flow:column nowrap;flex:0 0 var(--width);height:100%;max-width:var(--width);min-width:var(--width);width:var(--width)}dwg-lobby-room>#room-body>#left-panel>#game-settings{box-sizing:border-box;flex:3 0 0;height:100%;overflow-y:auto;padding:8px 12px 0px;width:100%}dwg-lobby-room>#room-body>#left-panel>#game-settings>*{box-sizing:border-box;min-height:1em;padding:4px;width:100%}dwg-lobby-room>#room-body>#left-panel>#game-settings .settings-small{font-size:var(--font-size-smaller);line-height:var(--font-size-smaller)}dwg-lobby-room>#room-body>#left-panel>#game-settings .settings-medium{font-size:var(--font-size-small);line-height:var(--font-size-small)}dwg-lobby-room>#room-body>#left-panel>#game-settings .settings-large{font-size:var(--font-size-medium);line-height:var(--font-size-medium);margin-top:.6em}dwg-lobby-room>#room-body>#left-panel>#game-settings>.button-container{display:flex;flex-flow:row nowrap;gap:.5em;margin-bottom:.5em}dwg-lobby-room>#room-body>#left-panel>#game-settings>.button-container.hide{display:none}dwg-lobby-room>#room-body>#left-panel>#game-settings>.button-container>button{font-size:18px;line-height:18px;height:30px;width:90px}dwg-lobby-room>#room-body>#left-panel>#game-settings>#settings-button-container>#settings-settings-button{background:linear-gradient(0deg, rgb(140, 140, 140), rgb(220, 220, 220));margin-left:auto}dwg-lobby-room>#room-body>#left-panel>#game-settings>#settings-button-container>#settings-launch-button{background:linear-gradient(0deg, rgb(40, 150, 40), rgb(80, 250, 80));margin-right:auto}dwg-lobby-room>#room-body>#left-panel>#game-settings>#settings-button-container>#settings-launch-button.launching{background:linear-gradient(0deg, rgb(50, 120, 50), rgb(100, 200, 100))}dwg-lobby-room>#room-body>#left-panel>#game-settings>#lobby-game-settings{z-index:2}dwg-lobby-room>#room-body>#left-panel>#game-settings>#game-button-container>#game-resign-button{background:linear-gradient(0deg, rgb(200, 25, 25), rgb(230, 60, 60));margin-left:auto}dwg-lobby-room>#room-body>#left-panel>#game-settings>#game-button-container>#game-rejoin-button{background:linear-gradient(0deg, rgb(180, 180, 35), rgb(210, 210, 60));margin-right:auto}dwg-lobby-room>#room-body>#left-panel>#game-settings>#settings-settings{display:flex;flex-flow:column nowrap;gap:.3em}dwg-lobby-room>#room-body>#left-panel>#user-list{--height: calc(1.5 * var(--font-size-medium));--font-size: var(--font-size-medium);background-color:rgba(220,220,220,.3);display:flex;flex-flow:column nowrap;flex:2 0 0}dwg-lobby-room>#room-body>#left-panel>#user-list .container-label{background-color:rgba(220,220,220,.4);font-size:var(--font-size);height:var(--height);line-height:var(--height);margin-bottom:2px;margin-top:.3em;padding:.2em .6em .1em}dwg-lobby-room>#room-body>#chatbox{box-sizing:border-box;flex:1 0 0;min-width:0px;padding:8px}dwg-lobby-room #kick-img,dwg-lobby-room #promote-img,dwg-lobby-room #viewer-img,dwg-lobby-room #player-img{display:none}body.mobile dwg-lobby-room>#room-body{flex-direction:column}body.mobile dwg-lobby-room>#room-body>#left-panel{--width: 100%;flex-direction:row;flex:0 0 320px}body.mobile dwg-lobby-room>#room-body>#left-panel>#game-settings{flex:1 1 0;padding:6px}body.mobile dwg-lobby-room>#room-body>#left-panel>#game-settings>.button-container{display:flex;flex-flow:row nowrap}body.mobile dwg-lobby-room>#room-body>#left-panel>#game-settings>.button-container.hide{display:none}body.mobile dwg-lobby-room>#room-body>#left-panel>#game-settings>.button-container>button{font-size:var(--font-size-smaller);line-height:var(--font-size-smaller);height:calc(2*var(--font-size-smaller))}body.mobile dwg-lobby-room>#room-body>#left-panel>#user-list{--height: calc(1.2 * var(--font-size-medium));--font-size: calc(var(--font-size-medium) - 2px);flex:1 1 0}body.mobile dwg-lobby-room>#room-body>#left-panel>#user-list .room-user>button{visibility:visible}body.mobile dwg-lobby-room>#room-body #chatbox{min-height:0px}",""]);const r=o},7850:(e,t,i)=>{i.d(t,{Z:()=>r});var s=i(8081),a=i.n(s),n=i(3645),o=i.n(n)()(a());o.push([e.id,"dwg-room-user{--user-height: calc(var(--height) - 2px);display:block;font-size:calc(var(--font-size) - 1px);height:var(--user-height);line-height:var(--user-height);padding:.15em .3em;position:relative;user-select:none}dwg-room-user:hover{background-color:rgba(255,255,255,.2)}dwg-room-user:hover>#buttons{display:flex}dwg-room-user>#ping{height:calc(.8*var(--user-height));left:.3em;position:absolute;top:calc(.1*var(--user-height) + .15em);width:calc(.8*var(--user-height))}dwg-room-user>#ping:hover>#ping-text{display:block}dwg-room-user>#ping>#ping-text{background-color:rgba(90,90,90,.6);bottom:100%;border-radius:.3em;display:none;font-size:var(--font-size-medium);line-height:var(--font-size-medium);padding:.3em;position:absolute;white-space:nowrap}dwg-room-user>#user-name{margin-left:calc(.8*var(--user-height) + .5em)}dwg-room-user>#buttons{align-items:center;bottom:0;display:none;flex-flow:row nowrap;gap:4px;position:absolute;right:4px;top:0}dwg-room-user>#buttons>button{align-items:center;background-color:rgba(220,220,220,.5);border:none;border-radius:4px;display:inline-flex;height:var(--user-height);justify-content:center;margin:0px;padding:0px;width:var(--user-height)}dwg-room-user>#buttons>button:hover{background-color:rgba(250,250,250,.6)}dwg-room-user>#buttons>button:active{background-color:rgba(255,255,255,.7)}dwg-room-user>#buttons>button>img{--size: min(18px, 80%);height:var(--size);width:var(--size)}",""]);const r=o},4562:(e,t,i)=>{i.d(t,{Z:()=>r});var s=i(8081),a=i.n(s),n=i(3645),o=i.n(n)()(a());o.push([e.id,"dwg-lobby-rooms{display:block}dwg-lobby-rooms.loading>#room-container{display:none}dwg-lobby-rooms:not(.loading)>#loading-message{display:none}dwg-lobby-rooms>#user-container{display:flex;flex-flow:column nowrap;flex:1 0 0}dwg-lobby-rooms>#user-container>.lobby-room{margin:2px 0;width:100%}",""]);const r=o},5651:(e,t,i)=>{i.d(t,{Z:()=>r});var s=i(8081),a=i.n(s),n=i(3645),o=i.n(n)()(a());o.push([e.id,"dwg-room-selector{--font-size: var(--font-size-medium);--height: calc(2 * var(--font-size));background-color:rgba(0,0,0,0);display:flex;flex-flow:row nowrap;font-size:var(--font-size);height:var(--height);line-height:var(--height);position:relative;user-select:none}dwg-room-selector:hover{background-color:rgba(180,180,180,.15)}dwg-room-selector:hover>#room-buttons{display:flex}dwg-room-selector>#room-players{margin-left:.3em;text-align:left;width:3em}dwg-room-selector>#room-game{--width: 8em;margin-left:1em;max-width:var(--width);min-width:var(--width);text-align:left;width:var(--width)}dwg-room-selector>#room-name{margin-left:1em}dwg-room-selector>#room-buttons{--margin: 6px;bottom:var(--margin);display:none;flex-flow:row nowrap;gap:var(--margin);position:absolute;right:var(--margin);top:var(--margin)}dwg-room-selector>#room-buttons>button{--width: calc(var(--height) - 2 * var(--margin));background-color:rgba(240,240,240,.8);border:none;border-radius:5px;display:inline-block;height:var(--width);margin:0;padding:0;width:var(--width)}dwg-room-selector>#room-buttons>button:hover{background-color:rgba(250,250,250,.9)}dwg-room-selector>#room-buttons>button:active{background-color:rgba(230,230,230,.7)}dwg-room-selector>#room-buttons>button>img{--size: min(24px, 100%);height:var(--size);width:var(--size)}body.mobile dwg-room-selector{--font-size: var(--font-size-small)}body.mobile dwg-room-selector>#room-players{margin-left:.2em;width:2em}body.mobile dwg-room-selector>#room-game{--width: 7em;margin-left:.4em}body.mobile dwg-room-selector>#room-name{margin-left:.4em}body.mobile dwg-room-selector>#room-buttons{--margin: 1px;display:flex}body.mobile dwg-room-selector>#room-buttons>button{background-color:rgba(240,240,240,.5)}body.mobile dwg-room-selector>#room-buttons>button:active{background-color:rgba(230,230,230,.7)}",""]);const r=o},7365:(e,t,i)=>{i.d(t,{Z:()=>r});var s=i(8081),a=i.n(s),n=i(3645),o=i.n(n)()(a());o.push([e.id,"dwg-lobby-user{box-sizing:border-box;display:block;font-size:calc(.6*var(--height));height:var(--height);line-height:calc(var(--height) - .3em);max-height:var(--height);max-width:100%;min-height:var(--height);min-width:100%;padding:.15em .3em;position:relative;user-select:none;width:100%}dwg-lobby-user:hover{background-color:rgba(180,180,180,.15)}dwg-lobby-user:active{background-color:rgba(180,180,180,.3)}dwg-lobby-user>#ping{height:calc(.8*var(--height) - .3em);left:.3em;position:absolute;top:calc(.1*var(--height) + .15em);width:calc(.8*var(--height) - .3em)}dwg-lobby-user>#ping:hover>#ping-text{display:block}dwg-lobby-user>#ping>#ping-text{background-color:rgba(90,90,90,.6);border-radius:.3em;display:none;font-size:var(--font-size-medium);line-height:var(--font-size-medium);padding:.3em;position:absolute;right:calc(100% + .3em);top:calc(-0.1*var(--height) - .075em);white-space:nowrap}dwg-lobby-user>#user-name{margin-left:calc(.8*var(--height) + .3em)}",""]);const r=o},2391:(e,t,i)=>{i.d(t,{Z:()=>r});var s=i(8081),a=i.n(s),n=i(3645),o=i.n(n)()(a());o.push([e.id,"dwg-lobby-users{display:flex;flex-flow:column nowrap}dwg-lobby-users.loading>#user-container{display:none}dwg-lobby-users:not(.loading)>#loading-message{display:none}dwg-lobby-users>#header{height:36px}dwg-lobby-users>#header #refresh-button{background-color:rgba(0,0,0,0);border:none;border-radius:6px;height:30px;margin:0px;padding:0px;position:relative;top:3px;user-select:none;width:30px}dwg-lobby-users>#header #refresh-button:hover{background-color:rgba(180,180,180,.15)}dwg-lobby-users>#header #refresh-button:active{background-color:rgba(180,180,180,.3)}dwg-lobby-users>#header #refresh-button #refresh-img{left:3px;position:absolute;top:3px;user-select:none}dwg-lobby-users>#loading-message{color:rgba(250,250,250,.9);font-size:var(--size-medium)}dwg-lobby-users>#user-container{display:flex;flex-flow:column nowrap;flex:1 0 0}dwg-lobby-users>#user-container .lobby-user{--height: var(--font-size-larger);width:100%}",""]);const r=o},9706:(e,t,i)=>{i.d(t,{Z:()=>r});var s=i(8081),a=i.n(s),n=i(3645),o=i.n(n)()(a());o.push([e.id,"dwg-page-home{--margin-size: 16px;--height: calc(100vh - 2 * var(--margin-size));--width: calc(100% - 2 * var(--margin-size));background-color:#05285a;display:block;height:var(--height);max-height:var(--height);max-width:var(--width);min-height:var(--height);min-width:var(--width);padding:var(--margin-size);width:var(--width)}dwg-page-home #lobby,dwg-page-home #game{bottom:0;left:0;overflow:hidden;position:absolute;right:0;top:0}dwg-page-home #game:not(.show){display:none}dwg-page-home #lobby-connector{z-index:5}body.mobile dwg-page-home{--height: calc(100svh - 2 * var(--margin-size))}body.mobile dwg-page-home #lobby,body.mobile dwg-page-home #game{overflow-y:visible}",""]);const r=o},4197:(e,t,i)=>{i.d(t,{Z:()=>r});var s=i(8081),a=i.n(s),n=i(3645),o=i.n(n)()(a());o.push([e.id,"",""]);const r=o},8099:(e,t,i)=>{i.d(t,{Z:()=>r});var s=i(8081),a=i.n(s),n=i(3645),o=i.n(n)()(a());o.push([e.id,'body{--font-size-title: calc(14px + 2.8vw);--font-size-largest: calc(12px + 2vw);--font-size-larger: calc(12px + 1.5vw);--font-size-large: calc(12px + 1vw);--font-size-medium: calc(12px + 0.5vw);--font-size-small: calc(10px + 0.45vw);--font-size-smaller: calc(8px + 0.4vw);--font-size-smallest: calc(7px + 035vw);background-color:#000;color:#fff;font-family:"Fira Sans",sans-serif;margin:0;min-height:100vh;min-width:100%;padding:0}body.mobile{--font-size-title: calc(18px + 3vw);--font-size-largest: calc(17px + 2.5vw);--font-size-larger: calc(16px + 2vw);--font-size-large: calc(16px + 1.5vw);--font-size-medium: calc(14px + 1vw);--font-size-small: calc(12px + 0.75vw);--font-size-smaller: calc(10px + 0.5vw);--font-size-smallest: calc(8px + 0.4vw)}body button{background-color:#b4b4b4;border-bottom-color:#828282;border-left-color:#e6e6e6;border-right-color:#828282;border-top-color:#e6e6e6;border-width:1.5px;box-shadow:none;box-sizing:border-box;outline:none;user-select:none}body button:hover{background-color:#c8c8c8}body button:active{background-color:#969696;border-bottom-color:#e6e6e6;border-left-color:#828282;border-right-color:#e6e6e6;border-top-color:#828282}body button:disabled{background-color:#aaa;border:none}body input{background-color:#ebebeb;border:1px rgba(0,0,0,.5) solid;box-shadow:none;box-sizing:border-box;color:#000;font-size:var(--font-size-medium);line-height:var(--font-size-medium);outline:none}body input:hover{background-color:#f0f0f0;border:1px #000 solid}body input:active,body input:focus{background-color:#fafafa;border:1px #000 solid;outline:2px solid rgba(0,0,0,.5)}body ::-webkit-scrollbar{width:7px}body ::-webkit-scrollbar-track{background:rgba(0,0,0,0)}body ::-webkit-scrollbar-thumb{background:#7a5959;border:2px solid rgba(0,0,0,0);background-clip:padding-box;border-radius:7px}body ::-webkit-scrollbar-thumb:hover{background:#5c4646;border:none}body ::-webkit-scrollbar-thumb:active{background:#463535}body .max-size{height:100%;max-width:100%;max-height:100%;min-width:100%;min-height:100%;width:100%}body .set-size{height:var(--size);max-width:var(--size);max-height:var(--size);min-width:var(--size);min-height:var(--size);width:var(--size)}',""]);const r=o},3645:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i="",s=void 0!==t[5];return t[4]&&(i+="@supports (".concat(t[4],") {")),t[2]&&(i+="@media ".concat(t[2]," {")),s&&(i+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),i+=e(t),s&&(i+="}"),t[2]&&(i+="}"),t[4]&&(i+="}"),i})).join("")},t.i=function(e,i,s,a,n){"string"==typeof e&&(e=[[null,e,void 0]]);var o={};if(s)for(var r=0;r<this.length;r++){var d=this[r][0];null!=d&&(o[d]=!0)}for(var c=0;c<e.length;c++){var l=[].concat(e[c]);s&&o[l[0]]||(void 0!==n&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=n),i&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=i):l[2]=i),a&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=a):l[4]="".concat(a)),t.push(l))}},t}},8081:e=>{e.exports=function(e){return e[1]}},7091:e=>{e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),t.hash&&(e+=t.hash),t.maybeNeedQuotes&&/[\t\n\f\r "'=<>`]/.test(e)?'"'.concat(e,'"'):e):e}},3379:e=>{var t=[];function i(e){for(var i=-1,s=0;s<t.length;s++)if(t[s].identifier===e){i=s;break}return i}function s(e,s){for(var n={},o=[],r=0;r<e.length;r++){var d=e[r],c=s.base?d[0]+s.base:d[0],l=n[c]||0,h="".concat(c," ").concat(l);n[c]=l+1;var g=i(h),m={css:d[1],media:d[2],sourceMap:d[3],supports:d[4],layer:d[5]};if(-1!==g)t[g].references++,t[g].updater(m);else{var u=a(m,s);s.byIndex=r,t.splice(r,0,{identifier:h,updater:u,references:1})}o.push(h)}return o}function a(e,t){var i=t.domAPI(t);return i.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;i.update(e=t)}else i.remove()}}e.exports=function(e,a){var n=s(e=e||[],a=a||{});return function(e){e=e||[];for(var o=0;o<n.length;o++){var r=i(n[o]);t[r].references--}for(var d=s(e,a),c=0;c<n.length;c++){var l=i(n[c]);0===t[l].references&&(t[l].updater(),t.splice(l,1))}n=d}}},569:e=>{var t={};e.exports=function(e,i){var s=function(e){if(void 0===t[e]){var i=document.querySelector(e);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(e){i=null}t[e]=i}return t[e]}(e);if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(i)}},9216:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},3565:(e,t,i)=>{e.exports=function(e){var t=i.nc;t&&e.setAttribute("nonce",t)}},7795:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(i){!function(e,t,i){var s="";i.supports&&(s+="@supports (".concat(i.supports,") {")),i.media&&(s+="@media ".concat(i.media," {"));var a=void 0!==i.layer;a&&(s+="@layer".concat(i.layer.length>0?" ".concat(i.layer):""," {")),s+=i.css,a&&(s+="}"),i.media&&(s+="}"),i.supports&&(s+="}");var n=i.sourceMap;n&&"undefined"!=typeof btoa&&(s+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(n))))," */")),t.styleTagTransform(s,e,t.options)}(t,e,i)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},4589:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},6619:(e,t,i)=>{e.exports=i.p+"118e673d7c1547e848c0.png"},5661:(e,t,i)=>{e.exports=i.p+"1276778824a946c8b04f.png"},5221:(e,t,i)=>{e.exports=i.p+"efe4c9fa82cefdec8b1d.png"},6299:(e,t,i)=>{e.exports=i.p+"5c0badfd21808b14f424.png"},371:(e,t,i)=>{e.exports=i.p+"b0ed9c3c1c6d71b9e5d2.png"},2005:(e,t,i)=>{e.exports=i.p+"263c69b598a2eef8b48f.png"},721:(e,t,i)=>{e.exports=i.p+"e929e15745a5bc384268.png"},4112:(e,t,i)=>{e.exports=i.p+"278bba9bfb2ea5b10650.png"},3485:(e,t,i)=>{e.exports=i.p+"c3cb371e1616269849ad.png"},6003:(e,t,i)=>{e.exports=i.p+"3af7da2d4c114edd8c83.png"},4260:(e,t,i)=>{e.exports=i.p+"eefdf8c398a1f2be8485.png"},1398:(e,t,i)=>{e.exports=i.p+"9cc772be7d4d2437a8de.png"},872:(e,t,i)=>{e.exports=i.p+"52ee16dc6a2c63149aca.png"},6696:(e,t,i)=>{e.exports=i.p+"8ce35c1f4770f46431c3.png"},7643:(e,t,i)=>{e.exports=i.p+"9b22161f83ea9e9a0e76.png"},9340:(e,t,i)=>{e.exports=i.p+"4b3f87b66da56a68a450.png"},9396:(e,t,i)=>{e.exports=i.p+"eed002a0917ccbac02e6.png"},1305:(e,t,i)=>{e.exports=i.p+"9aed7eea9556ad2fc6b8.png"},6246:(e,t,i)=>{e.exports=i.p+"3021eef68e7265ad7be9.png"}},t={};function i(s){var a=t[s];if(void 0!==a)return a.exports;var n=t[s]={id:s,exports:{}};return e[s](n,n.exports,i),n.exports}i.m=e,i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var s in t)i.o(t,s)&&!i.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.p="dist/",i.b=document.baseURI||self.location.href,i.nc=void 0,(()=>{var e=i(3379),t=i.n(e),s=i(7795),a=i.n(s),n=i(569),o=i.n(n),r=i(3565),d=i.n(r),c=i(9216),l=i.n(c),h=i(4589),g=i.n(h),m=i(8099),u={};u.styleTagTransform=g(),u.setAttributes=d(),u.insert=o().bind(null,"head"),u.domAPI=a(),u.insertStyleElement=l(),t()(m.Z,u),m.Z&&m.Z.locals&&m.Z.locals,document.body.ontouchstart=()=>{};var p=i(4197),b={};b.styleTagTransform=g(),b.setAttributes=d(),b.insert=o().bind(null,"head"),b.domAPI=a(),b.insertStyleElement=l(),t()(p.Z,b),p.Z&&p.Z.locals&&p.Z.locals;var _=function(e,t,i,s){return new(i||(i=Promise))((function(a,n){function o(e){try{d(s.next(e))}catch(e){n(e)}}function r(e){try{d(s.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}d((s=s.apply(e,t||[])).next())}))};function v(e,t=300){const i=s=>{e()?s():setTimeout((()=>i(s)),t)};return new Promise(i)}function y(e){return _(this,void 0,void 0,(function*(){yield new Promise((t=>setTimeout(t,e)))}))}function f(e){return e.trim().split(" ").map((e=>{const t=e.toLowerCase();return e.charAt(0).toUpperCase()+t.slice(1)})).join(" ")}function w(e,t,i={}){const s=Object.assign({loading_text:void 0,disable_button:!0,re_enable_button:!0},i);e.addEventListener("click",(()=>{function i(t,i){"string"==typeof t&&(e.innerText=t),i&&(e.disabled=!1)}s.disable_button&&(e.disabled=!0),e.innerText,i(s.loading_text);const a=t();a instanceof Promise?a.then((e=>{i(e,s.re_enable_button)})):i(a,s.re_enable_button)}))}function x(e=!1){let t=!1;const i=[];return s=>{let a,n;const o=new Promise(((e,t)=>{a=e,n=t})),r=()=>_(this,void 0,void 0,(function*(){yield s().then(a,n);const e=i.shift();e?yield e():t=!1}));return t?e||i.push(r):(t=!0,r()),o}}function k(){return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substring(0,4))}var E=i(1630),z={};z.styleTagTransform=g(),z.setAttributes=d(),z.insert=o().bind(null,"head"),z.domAPI=a(),z.insertStyleElement=l(),t()(E.Z,z),E.Z&&E.Z.locals&&E.Z.locals;class L extends HTMLElement{constructor(){super(...arguments),this.fully_parsed=!1,this.elsMetadata=[]}connectedCallback(){return e=this,t=void 0,s=function*(){this.classList.add("dwg-element"),this.innerHTML=this.htmlString,yield v(this.elementsParsed.bind(this)),this.parsedCallback(),this.classList.add("parsed"),this.fully_parsed=!0},new((i=void 0)||(i=Promise))((function(a,n){function o(e){try{d(s.next(e))}catch(e){n(e)}}function r(e){try{d(s.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}d((s=s.apply(e,t||[])).next())}));var e,t,i,s}elementsParsed(){let e=!0;for(const t of this.elsMetadata){let i=t.found_element?this[t.name]:null;t.found_element||(i=this.querySelector(`#${t.element_id}`),i&&(this[t.name]=i,t.found_element=!0)),t.found_element?i instanceof L&&(i.fully_parsed||(e=!1)):e=!1}return e}parsedCallback(){}configureElement(e,t){t||(t=e.replace(/_/g,"-")),this.elsMetadata.push({element_id:t,name:e})}configureElements(...e){for(const t of e)this.configureElement(t)}}var S=function(e,t,i,s){return new(i||(i=Promise))((function(a,n){function o(e){try{d(s.next(e))}catch(e){n(e)}}function r(e){try{d(s.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}d((s=s.apply(e,t||[])).next())}))};function T(){return window.location.protocol,`ws://${location.hostname}:6807/api/lobby`}function C(e){return`/api/${e}/`}function P(e){return S(this,void 0,void 0,(function*(){try{const t=yield fetch(C(e),{method:"GET",headers:{"Content-Type":"application/json"}});return yield t.json()}catch(e){console.log(e)}return{success:!1,error_message:"Server error; please report this bug."}}))}var I=i(9706),R={};R.styleTagTransform=g(),R.setAttributes=d(),R.insert=o().bind(null,"head"),R.domAPI=a(),R.insertStyleElement=l(),t()(I.Z,R),I.Z&&I.Z.locals&&I.Z.locals;const M=new Map(Object.entries({":D":"😄",xD:"😆",XD:"😆",":'D":"🤣",":')":"😂",":)":"🙂",";)":"😉",":>":"😊","o:)":"😇","O:)":"😇",":x":"😘",":X":"😘",":*":"😚",":p":"😛",":P":"😛",";p":"😜",";P":"😜",xp:"😝",xP:"😝",XP:"😝",":l":"🤔",":L":"🤔",":z":"🤐",":Z":"🤐",":|":"😐️",":#":"😶",":j":"😏",":?":"😒","8D":"😬","%(":"🤢",":&":"🥴",xo:"😵",XO:"😵","8)":"😎",":B":"🤓",":/":"😕",":(":"☹️",":o":"😲",":O":"😲",":$":"😳",":s":"😧",":S":"😧",":'(":"😢",":'o":"😭",Dx:"😱","x(":"😖","X(":"😖",":<":"😓","D:":"😩",":c":"😫",":C":"😫",">:/":"😡",":@":"🤬",">:)":"😈",">:(":"👿",">0)":"👹",":3":"😽","</3":"💔","<3":"❤️","\\m/":"🤘","\\M/":"🤘",":{>":"🧙‍♂️",":E":"🧛","8#":"🧟"}));var $=i(4059),Z={};Z.styleTagTransform=g(),Z.setAttributes=d(),Z.insert=o().bind(null,"head"),Z.domAPI=a(),Z.insertStyleElement=l(),t()($.Z,Z),$.Z&&$.Z.locals&&$.Z.locals;const D="!!server!!";class U extends L{constructor(){super(),this.convert_emoticons=!0,this.last_new_messages_button_count=0,this.new_chat_elements=[],this.htmlString='<div id="chat-container"></div> <div id="new-messages-container"> <button id="new-messages-button">New Messages (<span id="new-messages-number"></span>)</button> </div> <div id="input-container"> <input id="chat-input" placeholder=""> <button id="send-chat">Send</button> </div>',this.configureElement("chat_container"),this.configureElement("chat_input"),this.configureElement("send_chat"),this.configureElement("new_messages_button"),this.configureElement("new_messages_number")}parsedCallback(){w(this.send_chat,(()=>{this.sendChat()})),this.chat_input.addEventListener("keyup",(e=>{"Enter"===e.key&&this.sendChat()})),this.new_messages_button.addEventListener("click",(()=>{this.adjustScroll()})),this.chat_container.addEventListener("scroll",(()=>{this.scrolledUp()||this.scrolledToBottom()}))}scrolledUp(){return this.chat_container.scrollHeight-this.chat_container.offsetHeight-this.chat_container.scrollTop>U.adjust_scroll_limit}adjustScroll(){this.chat_container.scrollTop=this.chat_container.scrollHeight-this.chat_container.offsetHeight,this.scrolledToBottom()}scrolledToBottom(){this.last_new_messages_button_count=0,this.new_messages_button.classList.remove("show")}addChat(e,t=!1){const i=this.scrolledUp(),s=e.sender&&e.sender!==D?`${e.sender}: `:"",a=document.createElement("div");e.sender!==D&&"gray"!==e.color||a.classList.add("color-gray"),a.innerHTML=`<b>${s}</b>${e.message}`,this.chat_container.appendChild(a),a.classList.add("new-message"),this.new_chat_elements.push(a),this.classList.add("new-message"),this.last_new_messages_button_timer&&clearTimeout(this.last_new_messages_button_timer),t||!i||this.classList.contains("transparent-fade")&&!this.classList.contains("show")?this.adjustScroll():(this.new_messages_button.classList.add("show"),this.new_messages_button.classList.add("new-message"),this.last_new_messages_button_count++,this.new_messages_number.innerText=this.last_new_messages_button_count.toString()),setTimeout((()=>{this.new_messages_button.classList.remove("new-message"),this.new_chat_elements.forEach((e=>{e.classList.remove("new-message")})),this.classList.remove("new-message")}),1500)}sendChat(){if(this.inputEmpty())return;const e=this.getInput();if(this.convert_emoticons)for(const[t,i]of M)e.message=e.message.replace(t,i);const t=new CustomEvent("chat_sent",{detail:e});this.dispatchEvent(t)}setPlaceholder(e){this.chat_input.placeholder=e}focus(){this.chat_input.focus()}clear(){this.chat_input.value="",this.chat_container.innerHTML=""}inputEmpty(){return!this.chat_input.value}getInput(){const e={message:this.chat_input.value};return this.chat_input.value="",e}}function A(e){var t;return null!==(t=new URL(window.location.href).searchParams.get(e))&&void 0!==t?t:""}function j(e){const t=new URL(window.location.href).searchParams;t.delete(e),window.history.replaceState(null,"",`?${t.toString()}`)}function N(e,t,i,s){return JSON.stringify({sender:e,kind:t,content:i,data:s})}function O(e){var t;return{client_id:parseInt(e.client_id),nickname:e.nickname,ping:parseInt(e.ping),room_id:null!==(t=parseInt(e.room_id))&&void 0!==t?t:void 0}}var B;function H(e){return{game_type:parseInt(e.game_type),max_players:parseInt(e.max_players),max_viewers:parseInt(e.max_viewers),game_specific_settings:e.game_specific_settings}}function G(e){return{room_id:parseInt(e.room_id),room_name:e.room_name,room_description:e.room_description,host:O(e.host),players:new Map(e.players.map((e=>{const t=O(e);return[t.client_id,t]}))),viewers:new Map(e.viewers.map((e=>{const t=O(e);return[t.client_id,t]}))),game_settings:H(e.game_settings),game_id:e.game_id?parseInt(e.game_id):void 0}}U.adjust_scroll_limit=5,customElements.define("dwg-chatbox",U),function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.FIDDLESTICKS=1]="FIDDLESTICKS",e[e.EUCHRE=2]="EUCHRE",e[e.RISQ=3]="RISQ"}(B||(B={}));var F=i(7091),W=i.n(F),q=new URL(i(9340),i.b);const J='<span id="page-header"> <span id="name-container"></span> <span id="ping-container"></span> </span> <span id="buttons"> <button id="refresh-lobby-button">Refresh</button> <button id="create-room-button">Create Room</button> <button id="lobby-users-button"> <img src="'+W()(q)+'" alt="users" draggable="false"> </button> </span> <span id="horizontal-container"> <span id="vertical-container"> <dwg-lobby-rooms id="lobby-rooms"></dwg-lobby-rooms> <dwg-chatbox id="chatbox"></dwg-chatbox> </span> <div id="lobby-users-backdrop"></div> <dwg-lobby-users id="lobby-users"></dwg-lobby-users> </span> <div id="lobby-room-wrapper"> <dwg-lobby-room id="lobby-room"></dwg-lobby-room> </div> <div id="lobby-connected-wrapper"> <div id="connecting-message">Connecting ...</div> </div>';var K=i(2732),X={};X.styleTagTransform=g(),X.setAttributes=d(),X.insert=o().bind(null,"head"),X.domAPI=a(),X.insertStyleElement=l(),t()(K.Z,X),K.Z&&K.Z.locals&&K.Z.locals;var V=new URL(i(1305),i.b);const Y='<div id="header"> <button id="refresh-button"> <img id="refresh-img" src="'+W()(V)+'" alt="refresh" draggable="false"> </button> </div> <div id="loading-message"></div> <div id="user-container"></div>';var Q=i(2391),ee={};ee.styleTagTransform=g(),ee.setAttributes=d(),ee.insert=o().bind(null,"head"),ee.domAPI=a(),ee.insertStyleElement=l(),t()(Q.Z,ee),Q.Z&&Q.Z.locals&&Q.Z.locals;var te=i(7365),ie={};ie.styleTagTransform=g(),ie.setAttributes=d(),ie.insert=o().bind(null,"head"),ie.domAPI=a(),ie.insertStyleElement=l(),t()(te.Z,ie),te.Z&&te.Z.locals&&te.Z.locals,customElements.define("dwg-lobby-user",class extends L{constructor(){super(),this.htmlString=' <div id="ping"> <img id="ping-image" class="max-size" draggable="false"> <div id="ping-text"></div> </div> <div id="user-name"></div> <div id="buttons"></div>',this.configureElement("ping_image"),this.configureElement("ping_text"),this.configureElement("user_name"),this.configureElement("buttons")}parsedCallback(){this.user?this.setData():console.error("Must set user before attaching to dom")}updateUser(e){this.user=e,this.fully_parsed&&this.setData()}setData(){this.user_name.innerText=this.user.nickname,this.updatePing(this.user.ping)}updatePing(e){this.user.ping=e,this.ping_text.innerText=`${Math.round(e)} ms`,this.ping_image.src=e<100?"/images/icons/ping_good24.png":e<300?"/images/icons/ping_ok24.png":e<1e3?"/images/icons/ping_bad24.png":"/images/icons/ping_empty24.png"}});customElements.define("dwg-lobby-users",class extends L{constructor(){super(),this.users=new Map,this.first_load=!0,this.htmlString=Y,this.configureElement("refresh_button"),this.configureElement("loading_message"),this.configureElement("user_container")}parsedCallback(){w(this.refresh_button,(()=>{this.refreshUsers(!0)}),{}),this.refreshUsers(),setInterval((()=>{this.updatePings()}),2500)}refreshUsers(e=!1){return t=this,i=void 0,a=function*(){if(this.classList.contains("loading"))return;(this.first_load||e)&&(this.classList.add("loading"),this.loading_message.innerHTML=" ... loading",this.first_load=!1);const t=yield P("lobby/users/get");if(t.success){for(const e of this.users.values())e.refreshed=!1;for(const e of t.result){const t=O(e);this.addUser(t)}const e=[...this.users.keys()];for(const t of e){const e=this.users.get(t);e&&(e.refreshed||(e.el.remove(),this.users.delete(e.data.client_id)))}this.classList.remove("loading")}else this.loading_message.innerHTML=`Error loading users: ${t.error_message}`},new((s=void 0)||(s=Promise))((function(e,n){function o(e){try{d(a.next(e))}catch(e){n(e)}}function r(e){try{d(a.throw(e))}catch(e){n(e)}}function d(t){var i;t.done?e(t.value):(i=t.value,i instanceof s?i:new s((function(e){e(i)}))).then(o,r)}d((a=a.apply(t,i||[])).next())}));var t,i,s,a}addUser(e){if(this.users.has(e.client_id))this.users.get(e.client_id).data=e,this.users.get(e.client_id).refreshed=!0,this.users.get(e.client_id).el.updateUser(e);else{const t=document.createElement("dwg-lobby-user");t.classList.add("lobby-user"),t.updateUser(e),this.user_container.appendChild(t),this.users.set(e.client_id,{data:e,el:t,refreshed:!0})}}updatePing(e,t){const i=this.users.get(e);i&&(i.data.ping=t,i.el.updatePing(t))}updatePings(){for(const e of this.users.values())e.el.updatePing(e.data.ping)}removeUser(e){this.users.has(e)&&(this.users.get(e).el.remove(),this.users.delete(e))}getUser(e){return this.users.get(e).data}joinRoom(e,t){const i=this.getUser(e);i&&(i.room_id=t)}leaveRoom(e){const t=this.getUser(e);t&&(t.room_id=void 0)}});var se=i(4562),ae={};ae.styleTagTransform=g(),ae.setAttributes=d(),ae.insert=o().bind(null,"head"),ae.domAPI=a(),ae.insertStyleElement=l(),t()(se.Z,ae),se.Z&&se.Z.locals&&se.Z.locals;var ne=new URL(i(9340),i.b),oe=new URL(i(6003),i.b);const re='<div id="room-players"> <span id="room-curr-players"></span>/<span id="room-max-players"></span> </div> <div id="room-game"></div> <div id="room-name"></div> <div id="room-buttons"> <button id="button-join-player"> <img src="'+W()(ne)+'" alt="Join" draggable="false"> </button> <button id="button-join-viewer"> <img src="'+W()(oe)+'" alt="Join" draggable="false"> </button> </div>';var de=i(5651),ce={};ce.styleTagTransform=g(),ce.setAttributes=d(),ce.insert=o().bind(null,"head"),ce.domAPI=a(),ce.insertStyleElement=l(),t()(de.Z,ce),de.Z&&de.Z.locals&&de.Z.locals,customElements.define("dwg-room-selector",class extends L{constructor(){super(),this.htmlString=re,this.configureElement("room_name"),this.configureElement("room_curr_players"),this.configureElement("room_max_players"),this.configureElement("room_game"),this.configureElement("button_join_player"),this.configureElement("button_join_viewer")}parsedCallback(){this.room?(this.setRoomData(),this.addEventListener("dblclick",(()=>{this.dispatchEvent(new Event("join_room"))})),this.button_join_player.addEventListener("click",(()=>{this.dispatchEvent(new CustomEvent("join_room",{detail:!0}))})),this.button_join_viewer.addEventListener("click",(()=>{this.dispatchEvent(new CustomEvent("join_room",{detail:!1}))}))):console.error("Must set room before attaching to dom")}updateRoom(e){this.room=e,this.fully_parsed&&this.setRoomData()}setRoomData(){var e,t,i,s;this.room&&(this.room_curr_players.innerText=null===(e=this.room.players)||void 0===e?void 0:e.size.toString(),this.room_max_players.innerText=null===(i=null===(t=this.room.game_settings)||void 0===t?void 0:t.max_players)||void 0===i?void 0:i.toString(),this.room_name.innerText=this.room.room_name,this.room_game.innerText=f((null!==(s=B[this.room.game_settings.game_type||-1])&&void 0!==s?s:"").toLowerCase()))}});var le=function(e,t,i,s){return new(i||(i=Promise))((function(a,n){function o(e){try{d(s.next(e))}catch(e){n(e)}}function r(e){try{d(s.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}d((s=s.apply(e,t||[])).next())}))};customElements.define("dwg-lobby-rooms",class extends L{constructor(){super(),this.lock=x(),this.refreshing_rooms=!1,this.rooms=new Map,this.first_load=!0,this.htmlString=' <div id="loading-message"></div> <div id="room-container"></div> ',this.configureElement("loading_message"),this.configureElement("room_container")}parsedCallback(){}refreshRooms(e,t=!1){return le(this,void 0,void 0,(function*(){let i;return yield this.lock((()=>le(this,void 0,void 0,(function*(){(this.first_load||t)&&(this.classList.add("loading"),this.loading_message.innerHTML=" ... loading",this.first_load=!1);const s=yield P("lobby/rooms/get");if(s.success){for(const e of this.rooms.values())e.refreshed=!1;for(const t of s.result){const s=G(t);this.addRoom(s),(s.players.has(e)||s.viewers.has(e))&&(i=s)}const t=[...this.rooms.keys()];for(const e of t){const t=this.rooms.get(e);t&&(t.refreshed||t.el.remove())}this.classList.remove("loading")}else this.loading_message.innerHTML=`Error loading rooms: ${s.error_message}`})))),i}))}addRoom(e){if(this.rooms.has(e.room_id))this.rooms.get(e.room_id).data=e,this.rooms.get(e.room_id).refreshed=!0,this.rooms.get(e.room_id).el.updateRoom(e);else{const t=document.createElement("dwg-room-selector");t.classList.add("lobby-room"),t.id=`room-selector-${e.room_id}`,t.updateRoom(e),t.addEventListener("join_room",(t=>{var i;const s={detail:{room_id:e.room_id,join_as_player:null===(i=t.detail)||void 0===i||i}};this.dispatchEvent(new CustomEvent("join_room",s))})),this.room_container.appendChild(t),this.rooms.set(e.room_id,{data:e,el:t,refreshed:!0})}}removeRoom(e){var t;const i=null===(t=this.getRoom(e))||void 0===t?void 0:t.el;i&&i.remove(),this.rooms.delete(e)}userDisconnected(e){const t=[];for(const i of this.rooms.values())e===i.data.host.client_id&&t.push(i.data.room_id);t.forEach((e=>this.removeRoom(e)))}getRoom(e){return this.rooms.get(e)}roomUpdated(e){e.el.updateRoom(e.data)}renameRoom(e,t){const i=this.getRoom(e);i&&(i.data.room_name=t,this.roomUpdated(i))}updateRoomDescription(e,t){const i=this.getRoom(e);i&&(i.data.room_description=t,this.roomUpdated(i))}promoteUser(e,t){const i=this.getRoom(e);i&&i.data.players.has(t)&&(i.data.host=i.data.players.get(t),this.roomUpdated(i))}playerToViewer(e,t){const i=this.getRoom(e);i&&i.data.players.has(t)&&(i.data.viewers.set(t,i.data.players.get(t)),i.data.players.delete(t),this.roomUpdated(i))}viewerToPlayer(e,t){const i=this.getRoom(e);i&&i.data.viewers.has(t)&&(i.data.players.set(t,i.data.viewers.get(t)),i.data.viewers.delete(t),this.roomUpdated(i))}playerJoinsRoom(e,t){const i=this.getRoom(t.room_id);if(e===t.room_id)return void(i&&(i.data.players.set(t.client_id,t),this.roomUpdated(i)));i&&(i.data.host.client_id===t.client_id?this.removeRoom(t.room_id):i.data.players.delete(t.client_id),this.roomUpdated(i));const s=this.getRoom(e);s&&(s.data.players.set(t.client_id,t),this.roomUpdated(s))}viewerJoinsRoom(e,t){const i=this.getRoom(t.room_id);if(e===t.room_id)return void(i&&(i.data.viewers.set(t.client_id,t),this.roomUpdated(i)));i&&(i.data.host.client_id===t.client_id?this.removeRoom(t.room_id):i.data.players.delete(t.client_id),this.roomUpdated(i));const s=this.getRoom(e);s&&(s.data.viewers.set(t.client_id,t),this.roomUpdated(s))}clientLeavesRoom(e,t){const i=this.getRoom(e);i&&(i.data.host.client_id!==t||i.data.game_id?(i.data.players.delete(t),i.data.viewers.delete(t)):this.removeRoom(e),this.roomUpdated(i))}updateRoomSettings(e,t){const i=this.getRoom(e);i&&(i.data.game_settings=t,this.roomUpdated(i))}launchRoom(e,t){const i=this.getRoom(e);i&&(i.data.game_id=t,this.roomUpdated(i))}gameOver(e){const t=this.getRoom(e);t&&(t.data.game_id=void 0,this.roomUpdated(t))}});var he=new URL(i(3485),i.b),ge=new URL(i(6299),i.b);const me='<div id="room-header"> <button id="rename-room"> <img src="'+W()(he)+'" alt="rename" draggable="false"> </button> <button id="cancel-rename">cancel</button> <div id="room-name"></div> <input id="rename-input" placeholder="room name"> <button id="leave-room"> <img src="'+W()(ge)+'" alt="close" draggable="false"> </button> </div> <div id="room-body"> <div id="left-panel"> <div id="game-settings"> <div id="settings-button-container" class="hide button-container settings-medium"> <button id="settings-settings-button">Settings</button> <button id="settings-launch-button">Launch</button> </div> <div id="game-button-container" class="hide button-container settings-medium"> <button id="game-resign-button">Resign</button> <button id="game-rejoin-button">Rejoin</button> </div> <dwg-lobby-game-settings id="lobby-game-settings"></dwg-lobby-game-settings> <div id="settings-title" class="settings-medium"></div> <div id="settings-players" class="settings-medium"> Players: <span id="num-players-current"></span>/<span id="num-players-max"></span> </div> <div id="settings-game-status" class="settings-small"></div> <div id="settings-settings-label" class="settings-large">Settings:</div> <div id="settings-settings"></div> <div id="settings-description-label" class="settings-large">Description:</div> <div id="settings-description" class="settings-small"></div> </div> <div id="user-list"> <div id="host-label" class="container-label">Host</div> <div id="host-container"></div> <div id="players-label" class="container-label">Players</div> <div id="players-container"></div> <div id="viewers-label" class="container-label">Viewers</div> <div id="viewers-container"></div> </div> </div> <dwg-chatbox id="chatbox"></dwg-chatbox> </div>';var ue=i(2991),pe={};pe.styleTagTransform=g(),pe.setAttributes=d(),pe.insert=o().bind(null,"head"),pe.domAPI=a(),pe.insertStyleElement=l(),t()(ue.Z,pe),ue.Z&&ue.Z.locals&&ue.Z.locals;var be=i(7923),_e={};_e.styleTagTransform=g(),_e.setAttributes=d(),_e.insert=o().bind(null,"head"),_e.domAPI=a(),_e.insertStyleElement=l(),t()(be.Z,_e),be.Z&&be.Z.locals&&be.Z.locals,customElements.define("dwg-lobby-game-settings",class extends L{constructor(){super(),this.game_specific_settings_els=new Map,this.htmlString='<div id="game-settings-wrapper"> <div id="game-settings-title">Game Settings</div> <select id="game-chooser"><option value="0" selected="selected" hidden>--Choose a game--</option></select> <span class="row-wrapper"> <span class="input-wrapper"> <label for="max-players-input" class="label">Max Players</label> <input id="max-players-input" type="number" min="1" max="8" placeholder="Max Players"> </span> <span class="input-wrapper"> <label for="max-viewers-input">Max Viewers</label> <input id="max-viewers-input" type="number" min="0" max="16" placeholder="Max Viewers"> </span> </span> <div id="game-specific-settings"></div> <textarea id="room-description" placeholder="Set a description for your room"></textarea> <button id="save-button">Save</button> </div> ',this.configureElement("game_settings_wrapper"),this.configureElement("game_chooser"),this.configureElement("max_players_input"),this.configureElement("max_viewers_input"),this.configureElement("game_specific_settings"),this.configureElement("room_description"),this.configureElement("save_button")}parsedCallback(){for(const t of(e=B,Object.keys(e).filter((e=>Number.isNaN(parseInt(e)))))){if(!B[t])continue;const e=document.createElement("option");e.value=B[t].toString(),e.innerText=t,this.game_chooser.appendChild(e)}var e;w(this.save_button,(()=>{this.dispatchEvent(new Event("saved"))})),this.game_chooser.addEventListener("change",(()=>{var e;const t=null!==(e=parseInt(this.game_chooser.value))&&void 0!==e?e:0,i=this.getGameSpecificHTML(t);this.game_specific_settings.replaceChildren(...i)}))}getGameSpecificHTML(e){const t=[];if(this.game_specific_settings_els.clear(),e===B.FIDDLESTICKS){const e=this.createNumberElement("max-round","Override Max Round",1,12),i=this.createNumberElement("round-points","Round Points",0,20,10),s=this.createNumberElement("trick-points","Trick Points",0,10,1);t.push(this.createRowElement([e,i,s]))}return t}createNumberElement(e,t,i,s,a){const n=document.createElement("input");n.id=e,n.type="number",n.placeholder=t,n.min=i.toString(),n.max=s.toString(),void 0!==a&&(n.value=a.toString());const o=document.createElement("label");o.setAttribute("for",e),o.innerText=t,this.game_specific_settings_els.set(e,n);const r=document.createElement("span");return r.classList.add("input-wrapper"),r.appendChild(o),r.appendChild(n),r}createRowElement(e){const t=document.createElement("div");return t.classList.add("row-wrapper"),t.replaceChildren(...e),t}setSettings(e,t){this.game_chooser.value=e.game_type.toString(),this.max_players_input.value=e.max_players.toString(),this.max_viewers_input.value=e.max_viewers.toString();try{if(e.game_type===B.FIDDLESTICKS){const t=e.game_specific_settings;this.setNumberSetting("max-round",t.max_round),this.setNumberSetting("round-points",t.round_points),this.setNumberSetting("trick-points",t.trick_points)}}catch(e){console.log(e)}this.room_description.value=t}setNumberSetting(e,t){var i;const s=this.game_specific_settings_els.get(e);s&&(s.value=null!==(i=t.toString())&&void 0!==i?i:"0")}clearSettings(){this.game_chooser.value="",this.max_players_input.value="",this.max_viewers_input.value="",this.game_specific_settings.replaceChildren(),this.game_specific_settings_els.clear()}getSettings(){var e,t,i;const s={game_type:parseInt(this.game_chooser.value)||0,max_players:this.max_players_input.valueAsNumber||0,max_viewers:this.max_viewers_input.valueAsNumber||0};return s.game_type===B.FIDDLESTICKS&&(s.game_specific_settings={max_round:(null===(e=this.game_specific_settings_els.get("max-round"))||void 0===e?void 0:e.valueAsNumber)||0,round_points:(null===(t=this.game_specific_settings_els.get("round-points"))||void 0===t?void 0:t.valueAsNumber)||0,trick_points:(null===(i=this.game_specific_settings_els.get("trick-points"))||void 0===i?void 0:i.valueAsNumber)||0}),s}getDescription(){return this.room_description.value}});var ve,ye=i(7850),fe={};fe.styleTagTransform=g(),fe.setAttributes=d(),fe.insert=o().bind(null,"head"),fe.domAPI=a(),fe.insertStyleElement=l(),t()(ye.Z,fe),ye.Z&&ye.Z.locals&&ye.Z.locals,customElements.define("dwg-room-user",class extends L{constructor(){super(),this.is_host=!1,this.is_player=!1,this.is_self=!1,this.room_launched=!1,this.htmlString=' <div id="ping"> <img id="ping-image" class="max-size" draggable="false"> <div id="ping-text"></div> </div> <div id="user-name"></div> <div id="buttons"></div>',this.configureElement("ping_image"),this.configureElement("ping_text"),this.configureElement("user_name"),this.configureElement("buttons")}parsedCallback(){this.user?(this.user_name.innerText=this.user.nickname,this.updatePing(this.user.ping),this.room_launched||(this.is_host&&!this.is_self?this.is_player?(this.buttons.appendChild(this.getUserButton(this.user.client_id,"kick","kick")),this.buttons.appendChild(this.getUserButton(this.user.client_id,"viewer","eye")),this.buttons.appendChild(this.getUserButton(this.user.client_id,"promote","promote"))):(this.buttons.appendChild(this.getUserButton(this.user.client_id,"kick","kick")),this.buttons.appendChild(this.getUserButton(this.user.client_id,"player","person"))):!this.is_host&&this.is_self&&(this.is_player?this.buttons.appendChild(this.getUserButton(this.user.client_id,"viewer","eye")):this.buttons.appendChild(this.getUserButton(this.user.client_id,"player","person"))))):console.error("Must set config before attaching to dom")}setConfig(e,t,i,s,a){this.user=e,this.is_host=t,this.is_player=i,this.is_self=s,this.room_launched=a}updatePing(e){this.user.ping=e,this.ping_text.innerText=`${Math.round(e)} ms`,this.ping_image.src=e<100?"/images/icons/ping_good24.png":e<300?"/images/icons/ping_ok24.png":e<1e3?"/images/icons/ping_bad24.png":"/images/icons/ping_empty24.png"}getUserButton(e,t,i){const s=document.createElement("button");s.id=`${t}-button-${e}`,s.classList.add(`${t}-button`);const a=document.createElement("img");return a.src=`/images/icons/${i}18.png`,a.alt=t,a.draggable=!1,s.appendChild(a),s.addEventListener("click",(()=>{this.dispatchEvent(new CustomEvent(`${t}_player`,{bubbles:!0,detail:e}))})),s}}),function(e){e.NOT_STARTED="Game not started",e.LAUNCHING="Game launching ...",e.IN_PROGRESS="Game in progress",e.LAUNCH_CANCELED="Game launch canceled",e.LAUNCH_FAILED="Game launch failed",e.GAME_OVER="Game over"}(ve||(ve={})),customElements.define("dwg-lobby-room",class extends L{constructor(){super(),this.is_host=!1,this.client_id=-1,this.settings_launching=!1,this.renaming_room=!1,this.player_els=new Map,this.viewer_els=new Map,this.htmlString=me,this.configureElement("room_name"),this.configureElement("chatbox"),this.configureElement("leave_room"),this.configureElement("rename_input"),this.configureElement("rename_room"),this.configureElement("cancel_rename"),this.configureElement("host_container"),this.configureElement("players_container"),this.configureElement("viewers_container"),this.configureElement("settings_title"),this.configureElement("num_players_current"),this.configureElement("num_players_max"),this.configureElement("settings_settings"),this.configureElement("settings_description"),this.configureElement("settings_button_container"),this.configureElement("settings_settings_button"),this.configureElement("settings_launch_button"),this.configureElement("settings_game_status"),this.configureElement("lobby_game_settings"),this.configureElement("game_button_container"),this.configureElement("game_resign_button"),this.configureElement("game_rejoin_button")}parsedCallback(){this.chatbox.setPlaceholder("Chat with room"),this.chatbox.addEventListener("chat_sent",(e=>{this.dispatchEvent(new CustomEvent("chat_sent",{detail:e.detail}))})),this.leave_room.addEventListener("click",(()=>{this.dispatchEvent(new Event("leave_room"))})),this.rename_room.addEventListener("click",(()=>{this.openRename()})),this.cancel_rename.addEventListener("click",(()=>{this.cancelRename()})),this.rename_input.addEventListener("keyup",(e=>{"Enter"===e.key&&this.submitRename()})),this.settings_settings_button.addEventListener("click",(()=>{this.lobby_game_settings.setSettings(this.room.game_settings,this.room.room_description),this.lobby_game_settings.classList.add("show")})),this.lobby_game_settings.addEventListener("saved",(()=>{this.dispatchEvent(new CustomEvent("save_settings",{detail:N(`client-${this.room.host.client_id}`,"room-settings-update",JSON.stringify(this.lobby_game_settings.getSettings()),this.room.room_id.toString())})),this.dispatchEvent(new CustomEvent("save_settings",{detail:N(`client-${this.room.host.client_id}`,"room-update-description",this.lobby_game_settings.getDescription(),this.room.room_id.toString())})),this.lobby_game_settings.classList.remove("show")})),this.settings_launch_button.addEventListener("click",(()=>{if(this.settings_launching)this.setLaunching(!1),this.settings_game_status.innerText=ve.LAUNCH_CANCELED,this.settings_launch_interval_id&&clearInterval(this.settings_launch_interval_id),this.dispatchEvent(new CustomEvent("chat_sent",{detail:{message:"Game launch canceled",sender:D}}));else{this.setLaunching(!0);const e=5;this.dispatchEvent(new CustomEvent("chat_sent",{detail:{message:`Game is launching in ${e} ...`,sender:D}})),this.settings_launch_interval_id=function(e,t,i,s=(()=>{})){let a=0;const n=setInterval((()=>{a++,a>i?(clearInterval(n),s()):e(a)}),1e3);return n}((t=>{this.dispatchEvent(new CustomEvent("chat_sent",{detail:{message:e-t+" ...",sender:D}}))}),0,e-1,(()=>{this.dispatchEvent(new CustomEvent("chat_sent",{detail:{message:"Game is launching ...",sender:D}})),this.dispatchEvent(new Event("launch_game")),this.settings_launch_button.disabled=!0}))}})),this.game_resign_button.disabled=!0,w(this.game_rejoin_button,(()=>{this.dispatchEvent(new Event("rejoin_game"))})),this.room_name.classList.add("show"),setInterval((()=>{this.updatePings()}),1500)}setLaunching(e){this.settings_launching=e,e?(this.settings_launch_button.innerText="Cancel",this.settings_launch_button.classList.add("launching"),this.settings_game_status.innerText=ve.LAUNCHING,this.settings_settings_button.disabled=!0):(this.settings_launch_button.innerText="Launch",this.settings_launch_button.classList.remove("launching"),this.settings_launch_button.disabled=!1,this.settings_settings_button.disabled=!1)}refreshRoom(e,t){this.setRoom(e,t,this.client_id,!0)}setRoom(e,t,i,s=!1){const a=!!e.game_id;this.is_host=t,this.client_id=i,this.room=e,this.room_name.innerText=e.room_name,this.lobby_game_settings.classList.contains("show")||(this.lobby_game_settings.setSettings(e.game_settings,e.room_description),this.updateSettingsDependencies()),this.num_players_current.innerText=e.players.size.toString(),s&&!a||(this.settings_game_status.innerText=a?ve.IN_PROGRESS:ve.NOT_STARTED),this.classList.add("show"),a?this.game_button_container.classList.remove("hide"):this.game_button_container.classList.add("hide"),this.renaming_room=t&&s&&this.renaming_room,t?(this.rename_room.classList.toggle("show",!this.renaming_room),a?this.settings_button_container.classList.add("hide"):this.settings_button_container.classList.remove("hide")):(this.rename_room.classList.remove("show"),this.settings_button_container.classList.add("hide")),this.setLaunching(this.settings_launching&&s),this.host_el=this.getUserElement(e.host,t,!0),this.host_container.replaceChildren(this.host_el),this.player_els.clear();for(const i of e.players.values())i.client_id!==e.host.client_id&&this.player_els.set(i.client_id,this.getUserElement(i,t,!0));this.players_container.replaceChildren(...this.player_els.values()),this.viewer_els.clear();for(const i of e.viewers.values())this.viewer_els.set(i.client_id,this.getUserElement(i,t,!1));this.viewers_container.replaceChildren(...this.viewer_els.values())}updateSettings(e){this.room&&(this.room.game_settings=e,this.updateSettingsDependencies())}updateSettingsDependencies(){var e,t;if(this.settings_title.innerText=null!==(t=B[null!==(e=this.room.game_settings.game_type)&&void 0!==e?e:-1])&&void 0!==t?t:"",this.num_players_max.innerText=this.room.game_settings.max_players.toString(),this.room.game_settings.game_specific_settings){const e=[];for(const[t,i]of Object.entries(this.room.game_settings.game_specific_settings)){const s=document.createElement("div");s.classList.add("setting"),s.classList.add("settings-small"),s.id=`setting-${t}`,s.innerText=`${f(t.replace("_"," "))}: ${i}`,e.push(s)}this.settings_settings.replaceChildren(...e)}else this.settings_settings.replaceChildren();this.settings_description.innerText=this.room.room_description}getUserElement(e,t,i){const s=document.createElement("dwg-room-user");return s.classList.add("room-user"),s.id=`user-${e.client_id}`,s.setConfig(e,t,i,this.client_id===e.client_id,!!this.room.game_id),s}clearRoom(){this.room=void 0,this.lobby_game_settings.clearSettings(),this.chatbox.clear(),this.classList.remove("show")}inRoom(){return!!this.room}getRoom(){return this.room}renameRoom(e,t){this.room&&(this.room.room_name=e,this.room_name.innerText=e,t===this.room.host.client_id?this.chatbox.addChat({message:`The host has renamed the room to: ${e}`,color:"gray"}):this.room.players.has(t)?this.chatbox.addChat({message:`${this.room.players.get(t).nickname} renamed the room to: ${e}`,color:"gray"}):this.chatbox.addChat({message:`The room has been renamed to: ${e}`,color:"gray"}))}updateRoomDescription(e){this.room&&(this.room.room_description=e,this.settings_description.innerText=e)}hasPlayer(e){return!(!this.classList.contains("show")||!this.room)&&this.room.players.has(e)}getClient(e){if(this.classList.contains("show")&&this.room)return this.room.players.has(e)?this.room.players.get(e):this.room.viewers.get(e)}getPlayer(e){if(this.classList.contains("show")&&this.room)return this.room.players.get(e)}getHost(){if(this.classList.contains("show")&&this.room)return this.room.host}updatePing(e,t){this.room&&this.room.players.has(e)&&(this.room.players.get(e).ping=t)}updatePings(){if(this.room){this.host_el&&this.host_el.updatePing(this.room.host.ping);for(const[e,t]of this.player_els.entries()){const i=this.room.players.get(e);i?t.updatePing(i.ping):t.remove()}for(const[e,t]of this.viewer_els.entries()){const i=this.room.viewers.get(e);i?t.updatePing(i.ping):t.remove()}}}joinRoom(e,t){if(!this.room)return;const i=this.querySelector(`#user-${e.client_id}`);if(i)i.replaceWith(this.getUserElement(e,this.is_host,t));else if(t){const t=this.getUserElement(e,this.is_host,!0);this.player_els.set(e.client_id,t),this.players_container.appendChild(t)}else{const t=this.getUserElement(e,this.is_host,!1);this.viewer_els.set(e.client_id,t),this.viewers_container.appendChild(t)}t?(this.room.players.set(e.client_id,e),this.num_players_current.innerText=this.room.players.size.toString()):this.room.viewers.set(e.client_id,e),this.chatbox.addChat({message:`${e.nickname} (${e.client_id}) joined the room`,color:"gray"})}leaveRoom(e,t){var i;if(this.room)if(this.room.host.client_id===e)this.clearRoom();else{const s=null!==(i=this.room.players.get(e))&&void 0!==i?i:this.room.viewers.get(e);this.room.players.delete(e),this.room.viewers.delete(e),this.num_players_current.innerText=this.room.players.size.toString();const a=this.querySelector(`#user-${e}`);a&&a.remove(),s&&this.chatbox.addChat({message:`${s.nickname} (client id ${s.client_id}) ${t} the room`,color:"gray"})}}promoteUser(e,t){if(!this.room)return;const i=this.room.players.get(e);i&&(this.room.host=i,this.setRoom(this.room,t,this.client_id),this.chatbox.addChat({message:`${i.nickname} (client id ${i.client_id}) was promoted as host of room`,color:"gray"}))}playerToViewer(e){this.room&&this.room.players.has(e)&&(this.room.viewers.set(e,this.room.players.get(e)),this.room.players.delete(e),this.setRoom(this.room,this.is_host,this.client_id))}viewerToPlayer(e){this.room&&this.room.viewers.has(e)&&(this.room.players.set(e,this.room.viewers.get(e)),this.room.viewers.delete(e),this.setRoom(this.room,this.is_host,this.client_id))}launchRoom(e){this.room&&(this.room.game_id=e,this.settings_game_status.innerText=ve.IN_PROGRESS,this.game_button_container.classList.remove("hide"),this.settings_button_container.classList.add("hide"),this.dispatchEvent(new CustomEvent("chat_sent",{detail:{message:"Game launched",sender:D}})))}launchFailed(){this.room&&(this.room.game_id=void 0,this.setLaunching(!1),this.settings_game_status.innerText=ve.LAUNCH_FAILED,this.dispatchEvent(new CustomEvent("chat_sent",{detail:{message:"Game launch failed",sender:D}})))}gameOver(e){this.room&&(this.room.game_id=void 0,this.settings_game_status.innerText=ve.GAME_OVER,this.game_button_container.classList.add("hide"),this.is_host&&(this.settings_launching=!1,this.settings_launch_button.classList.remove("launching"),this.settings_launch_button.innerText="Launch",this.settings_launch_button.disabled=!1,this.settings_settings_button.disabled=!1,this.settings_button_container.classList.remove("hide")),this.dispatchEvent(new CustomEvent("chat_sent",{detail:{message:`Game over: ${e}`,sender:D}})))}openRename(){this.renaming_room=!0,this.rename_room.classList.remove("show"),this.room_name.classList.remove("show"),this.rename_input.value=this.room.room_name,this.rename_input.classList.add("show"),this.cancel_rename.classList.add("show")}cancelRename(){this.renaming_room=!1,this.rename_room.classList.add("show"),this.room_name.classList.add("show"),this.rename_input.classList.remove("show"),this.cancel_rename.classList.remove("show")}submitRename(){this.dispatchEvent(new CustomEvent("rename_room",{detail:this.rename_input.value})),this.cancelRename()}});var we=function(e,t,i,s){return new(i||(i=Promise))((function(a,n){function o(e){try{d(s.next(e))}catch(e){n(e)}}function r(e){try{d(s.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}d((s=s.apply(e,t||[])).next())}))};const xe="room_id";class ke extends L{constructor(){super(),this.connection_metadata={nickname:"Anonymous",ping:0},this.can_auto_launch_room=!1,this.waitingOnConnectedTimes=0,this.htmlString=J,this.configureElement("name_container"),this.configureElement("ping_container"),this.configureElement("refresh_lobby_button"),this.configureElement("create_room_button"),this.configureElement("lobby_rooms"),this.configureElement("chatbox"),this.configureElement("lobby_users"),this.configureElement("lobby_room_wrapper"),this.configureElement("lobby_room"),this.configureElement("lobby_users_button"),this.configureElement("lobby_users_backdrop")}parsedCallback(){this.chatbox.setPlaceholder("Chat with entire lobby"),w(this.refresh_lobby_button,(()=>we(this,void 0,void 0,(function*(){yield this.refreshLobbyRooms(!1,!0)})))),w(this.create_room_button,(()=>we(this,void 0,void 0,(function*(){this.socket.send(N(`client-${this.connection_metadata.client_id}`,"room-create"))}))),{loading_text:"Creating Room ...",re_enable_button:!1}),this.lobby_rooms.addEventListener("join_room",(e=>we(this,void 0,void 0,(function*(){this.socket.send(N(`client-${this.connection_metadata.client_id}`,e.detail.join_as_player?"room-join-player":"room-join-viewer","",e.detail.room_id.toString()))})))),this.chatbox.addEventListener("chat_sent",(e=>{this.sendChatMessage(this.chatbox,"lobby-chat",Object.assign(Object.assign({},e.detail),{sender:`client-${this.connection_metadata.client_id}`}),this.connection_metadata.nickname)})),this.lobby_room.addEventListener("chat_sent",(e=>{var t;const i=e.detail;if(i.message.startsWith("\\l"))i.message=i.message.slice(2).trim(),this.sendChatMessage(this.chatbox,"lobby-chat",Object.assign(Object.assign({},e.detail),{sender:`client-${this.connection_metadata.client_id}`}),this.connection_metadata.nickname);else if(i.message.startsWith("\\u"))i.message=i.message.slice(2).trim();else if(i.message.startsWith("\\g"))i.message=i.message.slice(2).trim(),this.lobby_room.getRoom().game_id?this.socket.send(N(null!==(t=i.sender)&&void 0!==t?t:`game-${this.connection_metadata.client_id}`,"game-chat",i.message,i.color)):this.lobby_room.chatbox.addChat({message:"Cannot send message to unlaunched game",color:"gray"},!0);else{i.message.startsWith("\\r")&&(i.message=i.message.slice(2).trim());const e=i.sender===D,t=e?i.sender:this.connection_metadata.nickname,s=`room-${this.connection_metadata.room_id}-${this.connection_metadata.client_id}`;i.sender=e?`${s}-${i.sender}`:s,this.sendChatMessage(this.lobby_room.chatbox,"room-chat",i,t)}})),this.lobby_room.addEventListener("leave_room",(()=>we(this,void 0,void 0,(function*(){var e;this.socket.send(N(`client-${this.connection_metadata.client_id}`,"room-leave","",null===(e=this.connection_metadata.room_id)||void 0===e?void 0:e.toString()))})))),this.lobby_room.addEventListener("rename_room",(e=>{var t;this.socket.send(N(`client-${this.connection_metadata.client_id}`,"room-rename",e.detail,null===(t=this.connection_metadata.room_id)||void 0===t?void 0:t.toString()))})),this.lobby_room.addEventListener("kick_player",(e=>{var t;this.socket.send(N(`client-${this.connection_metadata.client_id}`,"room-kick",e.detail.toString(),null===(t=this.connection_metadata.room_id)||void 0===t?void 0:t.toString()))})),this.lobby_room.addEventListener("viewer_player",(e=>{var t;this.socket.send(N(`client-${this.connection_metadata.client_id}`,"room-set-viewer",e.detail.toString(),null===(t=this.connection_metadata.room_id)||void 0===t?void 0:t.toString()))})),this.lobby_room.addEventListener("player_player",(e=>{var t;this.socket.send(N(`client-${this.connection_metadata.client_id}`,"room-set-player",e.detail.toString(),null===(t=this.connection_metadata.room_id)||void 0===t?void 0:t.toString()))})),this.lobby_room.addEventListener("promote_player",(e=>{var t;this.socket.send(N(`client-${this.connection_metadata.client_id}`,"room-promote",e.detail.toString(),null===(t=this.connection_metadata.room_id)||void 0===t?void 0:t.toString()))})),this.lobby_room.addEventListener("save_settings",(e=>{this.socket.send(e.detail)})),this.lobby_room.addEventListener("launch_game",(()=>{var e;this.socket.send(N(`client-${this.connection_metadata.client_id}`,"room-launch","",null===(e=this.connection_metadata.room_id)||void 0===e?void 0:e.toString()))})),this.lobby_room.addEventListener("rejoin_game",(()=>{this.dispatchEvent(new CustomEvent("rejoin_game",{detail:this.lobby_room.room}))})),this.lobby_users_button.addEventListener("click",(()=>{this.lobby_users.classList.toggle("show"),this.lobby_users_backdrop.classList.toggle("show")})),this.lobby_users_backdrop.addEventListener("click",(()=>{this.lobby_users.classList.remove("show"),this.lobby_users_backdrop.classList.remove("show")})),this.refreshLobbyRooms(),this.lobby_users.refreshUsers(),setInterval((()=>{this.pingServer(),this.ping_container.innerText=`ping: ${Math.round(this.connection_metadata.ping)}`}),5e3)}setSocket(e){this.socket&&this.socket.close(3e3,"opening new connection"),this.waitingOnConnectedTimes=ke.DEFAULT_CONNECTION_TIMES,this.socket=e,this.socket.addEventListener("message",(e=>{try{!function(e,t){var i,s,a,n,o,r,d,c,l;if(e.socketActive())if(l=t.kind,["room","lobby","ping"].every((e=>!l.startsWith(`${e}-`))))console.log("not a lobby message",t);else switch("ping-update"!==t.kind&&console.log(t),t.kind){case"lobby-you-joined":const l=t.data.split("-");l.length<2&&(e.socket.close(3001,"you-joined-lobby message did not return properly-formed connect data"),e.dispatchEvent(new Event("connection_lost")));const h=parseInt(l[0]);h||(e.socket.close(3001,"you-joined-lobby message did not return properly-formed client id"),e.dispatchEvent(new Event("connection_lost")));const g="reconnect"===l[1]?"rejoined":"joined";e.connection_metadata.client_id=h,e.classList.add("connected"),e.setNickname(t.content),e.chatbox.addChat({message:`You (${t.content}) ${g} v${A("v")} lobby with client id ${h}`,sender:D}),e.lobby_users.addUser({client_id:h,nickname:e.connection_metadata.nickname,ping:0});try{localStorage.setItem("client_id",t.data),localStorage.setItem("client_nickname",t.content),localStorage.setItem("client_id_time",Date.now().toString())}catch(e){}e.refreshLobbyRooms(!0),e.lobby_users.refreshUsers();break;case"lobby-joined":const m=t.data.split("-");if(m.length<2)break;const u=parseInt(m[0]);if(!u)break;const p="reconnect"===m[1]?"rejoined":"joined";e.chatbox.addChat({message:`${t.content} ${p} lobby with client id ${u}`,sender:D}),e.lobby_users.addUser({client_id:u,nickname:t.content,ping:0});break;case"lobby-left":const b=parseInt(t.data);if(b){e.chatbox.addChat({message:`${t.content} (client id ${b}) left lobby`,sender:D});const s=e.lobby_users.getUser(b);e.lobby_users.removeUser(b),e.lobby_rooms.userDisconnected(b),s&&s.room_id===e.connection_metadata.room_id&&s.client_id===(null===(i=e.lobby_room.getHost())||void 0===i?void 0:i.client_id)?e.leaveRoom():e.lobby_room.leaveRoom(b,"disconnected from")}break;case"lobby-chat":const _=parseInt(t.sender.replace("client-",""));_&&e.chatbox.addChat({message:t.content,sender:null!==(a=null===(s=e.lobby_users.getUser(_))||void 0===s?void 0:s.nickname)&&void 0!==a?a:_.toString(),color:t.data});break;case"ping-update":const v=parseInt(t.data),y=parseInt(t.content);v&&!isNaN(y)&&(e.connection_metadata.client_id===v&&e.setPing(y),e.lobby_room.updatePing(v,y),e.lobby_users.updatePing(v,y));break;case"room-created":const f=(t,i)=>{e.lobby_rooms.addRoom(t),e.connection_metadata.client_id===i&&(e.enterRoom(t,!0),setTimeout((()=>{e.create_room_button.innerText="Room Created"}),1))};try{const i=parseInt(t.sender.replace("client-","")),s=e.lobby_users.getUser(i),a=G(JSON.parse(t.content));s.room_id=a.room_id,f.bind(this,a,i)()}catch(e){parseInt(t.data)}break;case"room-closed":const w=parseInt(t.data);if(w){e.connection_metadata.room_id===w&&e.leaveRoom();const t=null===(n=e.lobby_rooms.getRoom(w))||void 0===n?void 0:n.data;if(e.lobby_rooms.removeRoom(w),t)for(const i of t.players.keys())e.lobby_users.leaveRoom(i)}break;case"room-left":const x=parseInt(t.sender.replace("room-","")),k=parseInt(t.data.replace("client-",""));x&&k&&e.userLeftRoom(x,k,"left");break;case"room-joined-player":const E=parseInt(t.sender.replace("room-","")),z=parseInt(t.data.replace("client-","")),L=e.lobby_users.getUser(z),S=e.lobby_rooms.getRoom(E);E&&z&&L&&S&&(e.lobby_users.joinRoom(z,E),e.lobby_rooms.playerJoinsRoom(E,L),E===e.connection_metadata.room_id?e.lobby_room.joinRoom(L,!0):z===e.connection_metadata.client_id&&S&&e.enterRoom(null===(o=e.lobby_rooms.getRoom(E))||void 0===o?void 0:o.data,!1));break;case"room-joined-viewer":const T=parseInt(t.sender.replace("room-","")),C=parseInt(t.data.replace("client-","")),P=e.lobby_users.getUser(C),I=e.lobby_rooms.getRoom(T);T&&C&&P&&I&&(e.lobby_users.joinRoom(C,T),e.lobby_rooms.viewerJoinsRoom(T,P),T===e.connection_metadata.room_id?e.lobby_room.joinRoom(P,!1):C===e.connection_metadata.client_id&&I&&e.enterRoom(null===(r=e.lobby_rooms.getRoom(T))||void 0===r?void 0:r.data,!1));break;case"room-chat":const R=t.sender.split("-");if(R.length<3)break;const M=parseInt(R[1]),$=parseInt(R[2]);if(M&&$&&e.connection_metadata.room_id===M&&e.lobby_room.hasPlayer($)){let i=null!==(c=null===(d=e.lobby_room.getClient($))||void 0===d?void 0:d.nickname)&&void 0!==c?c:$.toString();R.length>3&&(i=R[3]),e.lobby_room.chatbox.addChat({message:t.content,sender:i,color:t.data})}break;case"room-renamed":const Z=parseInt(t.sender.replace("room-","")),U=parseInt(t.data);Z&&U&&(e.connection_metadata.client_id,e.lobby_room.room&&e.lobby_room.room.room_id===Z&&e.lobby_room.renameRoom(t.content,U),e.lobby_rooms.renameRoom(Z,t.content));break;case"room-description-updated":const j=parseInt(t.sender.replace("room-","")),N=parseInt(t.data);j&&N&&(e.connection_metadata.client_id,e.lobby_room.room&&e.lobby_room.room.room_id===j&&e.lobby_room.updateRoomDescription(t.content),e.lobby_rooms.updateRoomDescription(j,t.content));break;case"room-kicked":const O=parseInt(t.sender.replace("room-","")),B=parseInt(t.data);O&&B&&e.userLeftRoom(O,B,"was kicked from");break;case"room-promoted":const F=parseInt(t.sender.replace("room-","")),W=parseInt(t.data);F&&W&&(F===e.connection_metadata.room_id&&e.lobby_room.promoteUser(W,W===e.connection_metadata.client_id),e.lobby_rooms.promoteUser(F,W));break;case"room-viewer-set":const q=parseInt(t.sender.replace("room-","")),J=parseInt(t.data);q&&J&&(q===e.connection_metadata.room_id&&e.lobby_room.playerToViewer(J),e.lobby_rooms.playerToViewer(q,J));break;case"room-player-set":const K=parseInt(t.sender.replace("room-","")),X=parseInt(t.data);K&&X&&(K===e.connection_metadata.room_id&&e.lobby_room.viewerToPlayer(X),e.lobby_rooms.viewerToPlayer(K,X));break;case"room-settings-updated":try{const i=parseInt(t.sender.replace("room-","")),s=H(JSON.parse(t.data));e.lobby_rooms.updateRoomSettings(i,s),i===e.connection_metadata.room_id&&e.lobby_room.updateSettings(s)}catch(e){}break;case"room-launched":const V=parseInt(t.sender.replace("room-","")),Y=parseInt(t.data);V&&Y&&(e.lobby_rooms.launchRoom(V,Y),V===e.connection_metadata.room_id&&(e.lobby_room.launchRoom(Y),e.dispatchEvent(new CustomEvent("game_launched",{detail:e.lobby_room.room}))));break;case"room-game-over":const Q=parseInt(t.sender.replace("room-",""));Q&&(e.lobby_rooms.gameOver(Q),Q===e.connection_metadata.room_id&&e.lobby_room.gameOver(t.data));break;case"room-refreshed":try{const i=G(JSON.parse(t.content)),s=parseInt(t.data);s&&s===i.room_id&&(e.lobby_room.refreshRoom(i,i.host.client_id===e.connection_metadata.client_id),i.game_id&&!e.classList.contains("hide")&&e.canAutoLaunchRoom()&&e.dispatchEvent(new CustomEvent("game_launched",{detail:e.lobby_room.room})))}catch(e){}break;case"room-join-failed":case"room-refresh-failed":case"room-leave-failed":e.leaveRoom();case"room-rename-failed":case"room-kick-failed":case"room-promote-failed":case"room-set-player-failed":case"room-set-viewer-failed":case"room-settings-updated-failed":case"room-launch-failed":const ee=document.createElement("dwg-message-dialog");ee.setData({message:t.content}),e.appendChild(ee),console.error(t.content),"room-launch-failed"===t.kind&&e.lobby_room.launchFailed();break;default:console.error("Unknown message type",t.kind,"from",t.sender)}}(this,JSON.parse(e.data))}catch(t){console.error("Error parsing message: ",e,t)}}))}userLeftRoom(e,t,i){e===this.connection_metadata.room_id&&(this.lobby_room.leaveRoom(t,i),t===this.connection_metadata.client_id&&this.leaveRoom()),this.lobby_users.leaveRoom(t),this.lobby_rooms.clientLeavesRoom(e,t)}socketActive(){return!!this.socket&&this.socket.readyState==WebSocket.OPEN}setNickname(e){this.connection_metadata.nickname=e,this.name_container.innerText=e}setPing(e){this.waitingOnConnectedTimes=ke.DEFAULT_CONNECTION_TIMES,this.connection_metadata.ping=e}refreshLobbyRooms(e=!1,t=!1){var i,s,a,n;return we(this,void 0,void 0,(function*(){const o=yield this.lobby_rooms.refreshRooms(null!==(i=this.connection_metadata.client_id)&&void 0!==i?i:-1,t);if(e){const e=parseInt(A(xe)),t=null===(s=this.lobby_rooms.getRoom(e))||void 0===s?void 0:s.data;if(t&&(null==o?void 0:o.room_id)!==t.room_id)return void this.socket.send(N(`client-${this.connection_metadata.client_id}`,"room-join","",e.toString()));j(xe)}o&&o.room_id!==(null===(a=this.lobby_room.room)||void 0===a?void 0:a.room_id)?this.enterRoom(o,o.host.client_id===(null!==(n=this.connection_metadata.client_id)&&void 0!==n?n:-1)):o||this.leaveRoom()}))}enterRoom(e,t){this.connection_metadata.room_id=e.room_id,this.lobby_room.setRoom(e,t,this.connection_metadata.client_id),this.lobby_room_wrapper.classList.add("show"),function(e,t){const i=new URL(window.location.href).searchParams;t?i.set(e,t):i.delete(e),window.history.replaceState(null,"",`?${i.toString()}`)}(xe,e.room_id.toString()),e.game_id||(this.can_auto_launch_room=!0)}leaveRoom(){this.connection_metadata.room_id=void 0,this.lobby_room_wrapper.classList.remove("show"),this.create_room_button.disabled=!1,this.create_room_button.innerText="Create Room",this.lobby_room.inRoom()&&(this.lobby_room.clearRoom(),j(xe))}sendChatMessage(e,t,i,s){let a=!1;i.message=i.message.trim();try{this.socketActive()&&(this.socket.send(N(i.sender,t,i.message,i.color)),a=!0),a?e.addChat(Object.assign(Object.assign({},i),{sender:s}),!0):e.addChat({message:`Message unable to be sent: "${i.message}"`,color:"gray"},!0)}catch(t){e.addChat({message:"Error trying to send message",color:"gray"},!0)}}canAutoLaunchRoom(){return this.can_auto_launch_room}returnFromGame(){this.can_auto_launch_room=!1}pingServer(){var e,t;this.classList.contains("connector-open")||this.classList.contains("hide")||(this.socketActive()?this.classList.contains("connected")?(this.waitingOnConnectedTimes--,this.waitingOnConnectedTimes<1?this.dispatchEvent(new Event("connection_lost")):(this.lobby_users.refreshUsers(),this.refreshLobbyRooms(),this.lobby_room_wrapper.classList.contains("show")&&this.socket.send(N(`client-${this.connection_metadata.client_id}`,"room-refresh","",(null!==(t=null===(e=this.lobby_room.room)||void 0===e?void 0:e.room_id)&&void 0!==t?t:0).toString())))):this.dispatchEvent(new Event("connection_lost")):this.dispatchEvent(new Event("connected_lost")))}}ke.DEFAULT_CONNECTION_TIMES=3,customElements.define("dwg-lobby",ke);var Ee=function(e,t,i,s){return new(i||(i=Promise))((function(a,n){function o(e){try{d(s.next(e))}catch(e){n(e)}}function r(e){try{d(s.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}d((s=s.apply(e,t||[])).next())}))};let ze=!1;var Le=new URL(i(9396),i.b),Se=new URL(i(1398),i.b),Te=new URL(i(7643),i.b),Ce=new URL(i(872),i.b),Pe=new URL(i(6696),i.b),Ie=new URL(i(5221),i.b),Re=new URL(i(5661),i.b);const Me='<div id="header"> <div id="client-name"> <span id="client-name-string"></span> <span id="client-ping"></span> </div> <div id="room-name"></div> <div id="game-name"></div> <div id="button-container"> <button id="button-game-info"> <img src="'+W()(Le)+'" alt="rename" draggable="false"> </button> <button id="button-game-history"> <img src="'+W()(Se)+'" alt="rename" draggable="false"> </button> <button id="button-room-players"> <img src="'+W()(Te)+'" alt="players" draggable="false"> </button> <button id="button-fullscreen"> <img id="maximize-img" src="'+W()(Ce)+'" alt="fullscreen" draggable="false"> <img id="minimize-img" src="'+W()(Pe)+'" alt="fullscreen" draggable="false"> </button> <button id="button-exit"> <img src="'+W()(Ie)+'" alt="close" draggable="false"> </button> </div> </div> <div id="waiting-room"> <div id="players-waiting"></div> </div> <div id="game-container"></div> <div id="chatbox-container"> <dwg-chatbox id="chatbox" class="transparent-fade"></dwg-chatbox> <button id="open-chatbox-button"> <img src="'+W()(Re)+'" alt="chat" draggable="false"> </button> </div>';var $e=i(6415),Ze={};function De(e){switch(e){case 1:case 3:return"Red";case 2:case 4:return"Black";default:return"error"}}function Ue(e){switch(e){case 1:return"Diamond";case 2:return"Club";case 3:return"Heart";case 4:return"Spade";default:return"error"}}function Ae(e){switch(e){case 1:return"♦";case 2:return"♣";case 3:return"♥";case 4:return"♠";default:return"✪"}}function je(e){if(e>1&&e<11)return e.toString();switch(e){case 11:return"Jack";case 12:return"Queen";case 13:return"King";case 14:return"Ace";default:return"error"}}function Ne(e){if(e>1&&e<11)return e.toString();switch(e){case 11:return"J";case 12:return"Q";case 13:return"K";case 14:return"A";default:return"?"}}function Oe(e){return`${je(e.number)} of ${Ue(e.suit)}s`}function Be(e,t=!0){return t?`<span style="color:${function(e){switch(e){case 1:case 3:return"rgb(223, 0, 0)";case 2:case 4:return"rgb(0, 0, 0)";default:return"error"}}(e.suit)};">${Ne(e.number)}<span style="font-size:1.4rem;">${Ae(e.suit)}</span></span>`:`${Ne(e.number)}${Ae(e.suit)}`}function He(e){let t=`${je(e.number).toLowerCase()}_of_${Ue(e.suit).toLowerCase()}s`;return e.number>10&&e.number<14&&(t+="2"),`/images/cards/${t}.png`}function Ge(e,t){return(e%t+t)%t}Ze.styleTagTransform=g(),Ze.setAttributes=d(),Ze.insert=o().bind(null,"head"),Ze.domAPI=a(),Ze.insertStyleElement=l(),t()($e.Z,Ze),$e.Z&&$e.Z.locals&&$e.Z.locals;var Fe=i(7868),We={};We.styleTagTransform=g(),We.setAttributes=d(),We.insert=o().bind(null,"head"),We.domAPI=a(),We.insertStyleElement=l(),t()(Fe.Z,We),Fe.Z&&Fe.Z.locals&&Fe.Z.locals;var qe=new URL(i(6619),i.b),Je=new URL(i(721),i.b);const Ke='<div id="name-container"></div> <div id="status-container"></div> <div> <span class="fixed-width">Score:</span> <span id="score-container" class="right-data"></span> </div> <div> <span class="fixed-width">Bet:</span> <span id="bet-container" class="right-data"></span> <div id="bet-animation"></div> </div> <div> <span class="fixed-width">Tricks:</span> <span id="tricks-container" class="right-data"></span> </div> <div id="dealer-wrapper" class="icon-wrapper"> <img class="icon" alt="dealer" src="'+W()(qe)+'"> <div class="icon-tooltip">Dealt Round</div> </div> <div id="winner-wrapper" class="icon-wrapper"> <img class="icon" alt="winner" src="'+W()(Je)+'"> <div class="icon-tooltip">Won Game</div> </div> <div id="bet-input-wrapper"> <div id="bet-input-message">Place Bet</div> <input id="bet-input" type="number" placeholder="bet" min="0"> <button id="bet-button">Bet</button> </div> ';var Xe=i(8561),Ve={};Ve.styleTagTransform=g(),Ve.setAttributes=d(),Ve.insert=o().bind(null,"head"),Ve.domAPI=a(),Ve.insertStyleElement=l(),t()(Xe.Z,Ve),Xe.Z&&Xe.Z.locals&&Xe.Z.locals;var Ye=function(e,t,i,s){return new(i||(i=Promise))((function(a,n){function o(e){try{d(s.next(e))}catch(e){n(e)}}function r(e){try{d(s.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}d((s=s.apply(e,t||[])).next())}))};customElements.define("dwg-fiddlesticks-player",class extends L{constructor(){super(),this.initialized=!1,this.client_player=!1,this.card_els=[],this.htmlString=Ke,this.configureElement("name_container"),this.configureElement("status_container"),this.configureElement("score_container"),this.configureElement("bet_container"),this.configureElement("bet_input_wrapper"),this.configureElement("bet_input"),this.configureElement("bet_button"),this.configureElement("tricks_container"),this.configureElement("dealer_wrapper"),this.configureElement("winner_wrapper"),this.configureElement("bet_animation")}parsedCallback(){if(!this.initialized)throw new Error("Should initialize fiddlesticks player before attaching to dom");let e,t;this.name_container.innerText=this.player.player.nickname,this.score_container.innerText=this.player.score.toString(),this.bet_container.innerText="-",this.tricks_container.innerText="-",this.dealer_wrapper.addEventListener("click",(()=>{e&&clearTimeout(e),this.dealer_wrapper.classList.toggle("show-tooltip"),this.dealer_wrapper.classList.contains("show-tooltip")&&(e=setTimeout((()=>{this.dealer_wrapper.classList.remove("show-tooltip")}),2e3))})),this.winner_wrapper.addEventListener("click",(()=>{t&&clearTimeout(t),this.winner_wrapper.classList.toggle("show-tooltip"),this.winner_wrapper.classList.contains("show-tooltip")&&(t=setTimeout((()=>{this.winner_wrapper.classList.remove("show-tooltip")}),2e3))}))}initialize(e){this.player=e,this.initialized=!0}gameStarted(e,t,i){return Ye(this,void 0,void 0,(function*(){yield v((()=>this.fully_parsed)),e?(this.bet_container.innerText=this.player.has_bet?this.player.bet.toString():"-",this.tricks_container.innerText="-",t&&this.betting()):(this.bet_container.innerText=this.player.bet.toString(),this.tricks_container.innerText=this.player.tricks.toString(),t&&this.playing()),this.setDealer(i)}))}setClientPlayer(){this.classList.add("client-player"),this.client_player=!0,v((()=>this.fully_parsed)).then((()=>{this.bet_input.addEventListener("keyup",(e=>{e.stopImmediatePropagation(),"Enter"===e.key&&this.sendBetEvent()})),this.bet_button.addEventListener("click",(()=>{this.sendBetEvent()}))}))}sendBetEvent(){var e;const t=null!==(e=parseInt(this.bet_input.value))&&void 0!==e?e:NaN;if(isNaN(t)||t<0||t>this.player.cards.length)return void Li.call(this,{message:`Invalid bet value ${t}; bet must be in the range of [0, ${this.player.cards.length}]`});this.bet_input.disabled=!0,this.bet_button.disabled=!0;const i=N(`player-${this.player.player.player_id}`,"game-update",`{"amount":${this.bet_input.value}}`,"bet");this.dispatchEvent(new CustomEvent("game_update",{detail:i,bubbles:!0}))}newRound(e){this.endRound(),this.setDealer(e)}setDealer(e){this.dealer_wrapper.classList.toggle("show",e),e&&(this.status_container.innerText="Dealer")}endRound(){this.player.bet=-1,this.player.tricks=0,this.bet_container.innerText="-",this.tricks_container.innerText="-",this.dealer_wrapper.classList.remove("show"),this.status_container.innerText=""}betting(){this.classList.add("turn"),this.client_player&&(this.bet_input.disabled=!1,this.bet_button.disabled=!1,this.bet_input.value="0",this.bet_input.max=this.player.cards.length.toString(),this.bet_input_wrapper.classList.add("show"))}setBetAnimation(e){return Ye(this,void 0,void 0,(function*(){this.bet_animation.innerText=e.toString(),this.bet_animation.style.transitionDuration="500ms",this.bet_animation.classList.add("transition"),yield y(1e3),this.bet_animation.classList.remove("transition"),yield y(500),this.setBet(e)}))}setBet(e){this.player.bet=e,this.bet_container.innerText=e.toString(),this.classList.remove("turn"),this.client_player&&this.bet_input_wrapper.classList.remove("show")}endBetting(){this.tricks_container.innerText="0"}playing(){this.classList.add("turn")}playCard(){this.classList.remove("turn")}endTrick(e){this.player.tricks=e,this.tricks_container.innerText=e.toString()}setScore(e){this.player.score=e,this.score_container.innerText=e.toString()}wonGame(){this.winner_wrapper.classList.add("show")}});var Qe=i(5125),et={};et.styleTagTransform=g(),et.setAttributes=d(),et.insert=o().bind(null,"head"),et.domAPI=a(),et.insertStyleElement=l(),t()(Qe.Z,et),Qe.Z&&Qe.Z.locals&&Qe.Z.locals;class tt extends L{constructor(){super(),this.htmlString='<div id="content-container"></div> ',this.configureElement("content_container")}connectedCallback(){const e=Object.create(null,{connectedCallback:{get:()=>super.connectedCallback}});return t=this,i=void 0,a=function*(){e.connectedCallback.call(this),yield v((()=>(this.content_container=this.querySelector("#content-container"),!!this.content_container))),this.classList.add("dwg-dialog-box"),this.content_container.innerHTML=this.getHTML()},new((s=void 0)||(s=Promise))((function(e,n){function o(e){try{d(a.next(e))}catch(e){n(e)}}function r(e){try{d(a.throw(e))}catch(e){n(e)}}function d(t){var i;t.done?e(t.value):(i=t.value,i instanceof s?i:new s((function(e){e(i)}))).then(o,r)}d((a=a.apply(t,i||[])).next())}));var t,i,s,a}parsedCallback(){this.setData(this.getData(),!0)}closeDialog(){this.remove()}}var it=i(3411),st={};st.styleTagTransform=g(),st.setAttributes=d(),st.insert=o().bind(null,"head"),st.domAPI=a(),st.insertStyleElement=l(),t()(it.Z,st),it.Z&&it.Z.locals&&it.Z.locals,customElements.define("dwg-message-dialog",class extends tt{constructor(){super(),this.configureElement("message_container"),this.configureElement("ok_button")}getHTML(){return'<div id="wrapper"> <div id="message-container"></div> <button id="ok-button">ok</button> </div> '}getData(){var e,t;return{message:null!==(e=this.getAttribute("message"))&&void 0!==e?e:"",button_text:null!==(t=this.getAttribute("button_text"))&&void 0!==t?t:void 0}}setData(e,t){this.setAttribute("message",e.message),e.button_text&&this.setAttribute("button_text",e.button_text),(t||this.fully_parsed)&&(this.message_container.innerText=e.message,e.button_text&&(this.ok_button.innerText=e.button_text),this.ok_button.addEventListener("click",(()=>{this.closeDialog()})))}});class at{constructor(e){this.keynames=[],this.maps=new Map,this._size=0,this.keynames=e;for(const t of e)this.maps.set(t,new Map)}get(e,t){var i;return null===(i=this.maps.get(e))||void 0===i?void 0:i.get(t)}set(e,t){if(e.length!==this.keynames.length||0===e.length)return!1;for(const[i,s]of this.keynames.entries())this.maps.get(s).set(e[i],t);return this._size=this.maps.get(this.keynames[0]).size,!0}delete(e){if(e.length!==this.keynames.length||0===e.length)return!1;let t=!0;for(const[i,s]of this.keynames.entries())this.maps.get(s).delete(e[i])||(t=!1);return this._size=this.maps.get(this.keynames[0]).size,t}clear(){for(const[e,t]of this.keynames.entries())this.maps.get(t).clear();this._size=0}size(){return this._size}keys(e){var t;return this.maps.has(e)?[].values():null===(t=this.maps.get(e))||void 0===t?void 0:t.keys()}values(){return 0===this._size?[].values():this.maps.get(this.keynames[0]).values()}}var nt=i(3697),ot={};ot.styleTagTransform=g(),ot.setAttributes=d(),ot.insert=o().bind(null,"head"),ot.domAPI=a(),ot.insertStyleElement=l(),t()(nt.Z,ot),nt.Z&&nt.Z.locals&&nt.Z.locals;var rt=function(e,t,i,s){return new(i||(i=Promise))((function(a,n){function o(e){try{d(s.next(e))}catch(e){n(e)}}function r(e){try{d(s.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}d((s=s.apply(e,t||[])).next())}))};customElements.define("dwg-card-hand",class extends L{constructor(){super(),this.can_play=!1,this.cards=new at(["i","i_dom"]),this.dragging_data={dragging:!1,index:-1,touch_identifier:-1,start:{x:0,y:0},start_rect:new DOMRect(0,0,0,0),hovering_play_drop:!1},this.dragging_lock=x(),this.classList.add("hidden"),this.htmlString='<div id="cards-container"></div> <div id="play-drop"></div> <div id="cancel-drop"></div>',this.configureElement("cards_container"),this.configureElement("play_drop"),this.configureElement("cancel_drop")}parsedCallback(){return rt(this,void 0,void 0,(function*(){yield v((()=>!!this.clientHeight)),this.resizeCallback(),this.setEventListeners(),this.classList.remove("hidden")}))}resizeCallback(){const e=this.getBoundingClientRect();this.style.setProperty("--height",`${e.height.toString()}px`),this.style.setProperty("--width",`${e.width.toString()}px`);const t=.4*e.height;this.style.setProperty("--play-drop-margin",`${t.toString()}px`)}setEventListeners(){document.body.addEventListener("mouseup",(e=>{if(0!==e.button)return;if(!this.dragging_data.dragging)return;const t=this.cards.get("i",this.dragging_data.index);t?(e.stopImmediatePropagation(),t.el.classList.remove("hovering"),this.stopDraggingCard(t)):this.stopDragging()})),document.body.addEventListener("touchend",(e=>{if(e.stopImmediatePropagation(),!this.dragging_data.dragging)return;const t=this.cards.get("i",this.dragging_data.index);t?0!==e.touches.length?e.touches[0].identifier===this.dragging_data.touch_identifier&&this.stopDraggingCard(t):this.stopDraggingCard(t):this.stopDragging()})),document.body.addEventListener("mousemove",(e=>{if(!this.dragging_data.dragging)return;const t=this.cards.get("i",this.dragging_data.index);t?(e.stopImmediatePropagation(),this.dragCard(e,t)):this.stopDragging()})),document.documentElement.addEventListener("mouseenter",(e=>{if(!this.dragging_data.dragging||e.buttons%2==1)return;const t=this.cards.get("i",this.dragging_data.index);t?this.stopDraggingCard(t,!0):this.stopDragging()})),document.body.addEventListener("touchmove",(e=>{if(e.stopImmediatePropagation(),!this.dragging_data.dragging)return;const t=this.cards.get("i",this.dragging_data.index);if(!t)return void this.stopDragging();if(0===e.touches.length)return;const i=e.touches[0];i.identifier===this.dragging_data.touch_identifier&&this.dragCard({x:i.clientX,y:i.clientY},t)}))}setCards(e,t=[],i=0){let s=0;this.cards_container.replaceChildren();for(const[a,n]of e.entries()){if(t.some((e=>e===a))){s++;continue}const e={i:a,i_dom:a-s,el:void 0};this.createCardEl(n,e,i)}}createCardEl(e,t,i=0){const s=document.createElement("div"),a=document.createElement("img");a.src=He(e),a.draggable=!1,a.alt=Be(e),s.appendChild(a),s.classList.add("card"),s.style.setProperty("--i",t.i_dom.toString()),t.el=s,setTimeout((()=>{this.cards.set([t.i,t.i_dom],t),this.cards_container.style.setProperty("--num-cards",this.cards.size().toString()),this.cards_container.appendChild(s),s.addEventListener("dblclick",(()=>{this.can_play&&this.dispatchEvent(new CustomEvent("play_card",{detail:t.i}))})),s.addEventListener("mousedown",(e=>{0===e.button&&(e.stopImmediatePropagation(),this.startDraggingCard({x:e.x,y:e.y},t))})),s.addEventListener("mouseenter",(e=>{e.stopImmediatePropagation(),s.classList.add("hovering")})),s.addEventListener("mouseleave",(e=>{e.stopImmediatePropagation(),s.classList.remove("hovering")})),s.addEventListener("touchstart",(e=>{if(e.stopImmediatePropagation(),0===e.touches.length)return;const i=e.touches[0];this.startDraggingCard({x:i.clientX,y:i.clientY},t,i.identifier)}))}),(1+t.i)*i)}startDraggingCard(e,t,i=0){this.dragging_lock((()=>rt(this,void 0,void 0,(function*(){if(this.dragging_data.dragging){const e=this.cards.get("i",this.dragging_data.index);e&&this.stopDraggingCard(e)}this.dragging_data.dragging=!0,this.dragging_data.index=t.i,this.dragging_data.touch_identifier=i,this.dragging_data.start=e,this.dragging_data.start_rect=t.el.getBoundingClientRect(),t.el.style.setProperty("--x","0px"),t.el.style.setProperty("--y","0px"),this.play_drop.classList.remove("hovering"),this.cancel_drop.classList.add("hovering"),this.dragging_data.hovering_play_drop=!1,t.el.classList.add("dragging"),this.classList.add("dragging"),this.can_play&&this.classList.add("dragging-playing")}))))}dragCard(e,t){this.dragging_lock((()=>rt(this,void 0,void 0,(function*(){var i,s,a;if(!this.dragging_data.dragging)return;const n=t.el.getBoundingClientRect();if(e.x<this.dragging_data.start.x&&t.i_dom>0){const e=this.cards.get("i_dom",t.i_dom-1),s=null===(i=null==e?void 0:e.el)||void 0===i?void 0:i.getBoundingClientRect();if(e&&n.x<(null==s?void 0:s.x)){const i=this.dragging_data.start_rect.x-s.x;this.dragging_data.start_rect.x-=i,this.dragging_data.start.x-=i,t.i_dom--,e.i_dom++,t.el.style.setProperty("--i",t.i_dom.toString()),e.el.style.setProperty("--i",e.i_dom.toString()),this.cards.set([t.i,t.i_dom],t),this.cards.set([e.i,e.i_dom],e)}}else if(e.x>this.dragging_data.start.x&&t.i_dom<this.cards.size()-1){const e=this.cards.get("i_dom",t.i_dom+1),i=null===(s=null==e?void 0:e.el)||void 0===s?void 0:s.getBoundingClientRect();if(e&&n.x>(null==i?void 0:i.x)){const s=i.x-this.dragging_data.start_rect.x;this.dragging_data.start_rect.x+=s,this.dragging_data.start.x+=s,t.i_dom++,e.i_dom--,t.el.style.setProperty("--i",t.i_dom.toString()),e.el.style.setProperty("--i",e.i_dom.toString()),this.cards.set([t.i,t.i_dom],t),this.cards.set([e.i,e.i_dom],e)}}t.el.style.setProperty("--x",`${(e.x-this.dragging_data.start.x).toString()}px`),t.el.style.setProperty("--y",`${(e.y-this.dragging_data.start.y).toString()}px`),e.y<(null===(a=this.cancel_drop.getBoundingClientRect())||void 0===a?void 0:a.top)?(this.play_drop.classList.add("hovering"),this.cancel_drop.classList.remove("hovering"),this.dragging_data.hovering_play_drop=!0):(this.play_drop.classList.remove("hovering"),this.cancel_drop.classList.add("hovering"),this.dragging_data.hovering_play_drop=!1)}))))}stopDragging(){this.dragging_data.dragging=!1,this.classList.remove("dragging"),this.classList.remove("dragging-playing")}stopDraggingCard(e,t=!1){this.dragging_lock((()=>rt(this,void 0,void 0,(function*(){this.stopDragging(),e.el.classList.remove("dragging"),!t&&this.can_play&&this.dragging_data.hovering_play_drop&&this.dispatchEvent(new CustomEvent("play_card",{detail:e.i}))}))))}playCard(e){const t=this.cards.get("i",e);t?(t.el.remove(),this.cards.delete([e,t.i_dom]),this.dragging_lock((()=>rt(this,void 0,void 0,(function*(){this.cards_container.style.setProperty("--num-cards",this.cards.size().toString());for(const e of this.cards.values())e.i_dom<=t.i_dom||(e.i_dom--,e.el.style.setProperty("--i",e.i_dom.toString()))}))))):console.error("Trying to play card that does not exist")}substituteCard(e,t){const i=this.cards.get("i",e);i?(i.el.remove(),i.el=void 0,this.createCardEl(t,i)):console.error("Trying to substitute card that does not exist")}removeCards(){this.cards.clear(),this.cards_container.replaceChildren(),this.can_play=!1}});var dt=function(e,t,i,s){return new(i||(i=Promise))((function(a,n){function o(e){try{d(s.next(e))}catch(e){n(e)}}function r(e){try{d(s.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}d((s=s.apply(e,t||[])).next())}))};function ct(e,t){return e.teams[t%2]}customElements.define("dwg-fiddlesticks",class extends L{constructor(){super(),this.current_trick=0,this.player_els=[],this.player_id=-1,this.trick_card_els=[],this.htmlString='<div id="header-messages-container"> <div> <span class="span-align">Round: </span> <span id="round-number"></span> </div> <div> <span class="span-align">Bets: </span> <span id="bets-number"></span> </div> <div> <span class="span-align">Trick: </span> <span id="trick-number"></span> </div> <div id="status-div"> <span class="span-center">Status</span> <span id="status-container"></span> </div> </div> <div id="trump-card-container"> <div id="trump-text">Trump</div> <div id="trump-card"><img id="trump-card-img" alt="Trump Card"></div> </div> <div id="table-container"> <div id="trick-cards"></div> </div> <div id="player-container"></div> <dwg-card-hand id="players-cards"></dwg-card-hand> ',this.configureElement("round_number"),this.configureElement("bets_number"),this.configureElement("trick_number"),this.configureElement("status_container"),this.configureElement("trump_card_img"),this.configureElement("trick_cards"),this.configureElement("table_container"),this.configureElement("player_container"),this.configureElement("players_cards")}parsedCallback(){this.round_number.innerText="-",this.bets_number.innerText="-",this.trick_number.innerText="-",this.status_container.innerText="Starting game ...",this.players_cards.addEventListener("play_card",(e=>{const t=N(`player-${this.player_id}`,"game-update",`{"index":${e.detail}}`,"play-card");this.dispatchEvent(new CustomEvent("game_update",{detail:t,bubbles:!0}))})),k()?this.table_container.style.setProperty("background-image","url(/images/card_table400.png)"):this.table_container.style.setProperty("background-image","url(/images/card_table800.png)")}initialize(e,t){return dt(this,void 0,void 0,(function*(){this.player_id=e.player_id,this.game=t,this.player_els=[];for(const[e,i]of t.players.entries()){const t=document.createElement("dwg-fiddlesticks-player");t.initialize(i),this.player_container.appendChild(t),this.player_els.push(t),this.player_id===e&&t.setClientPlayer()}for(let t=0;t<this.player_els.length;t++){const i=Ge(this.player_id+t,this.game.players.length),s=e.is_player?t:t+.5;this.game.players[i].order=s,this.player_els[i].style.setProperty("--order",s.toString()),this.player_els[i].style.setProperty("--num-players",this.player_els.length.toString())}if(this.trick_cards.style.setProperty("--num-players",this.player_els.length.toString()),t.game_base.game_ended);else if(t.game_base.game_started){this.round_number.innerText=t.round.toString(),this.updateBetsContainer();for(const[e,i]of this.player_els.entries()){const s=e===t.turn,a=e===t.dealer;i.gameStarted(t.betting,s,a),this.player_id!=e||t.game_base.game_ended||(this.players_cards.setCards(t.players[e].cards,t.players[e].cards_played),t.betting||this.game.turn!==this.player_id||(this.players_cards.can_play=!0))}if(t.betting)this.current_trick=0,this.trick_number.innerText="-",this.status_container.innerText=`${this.game.players[this.game.turn].player.nickname} Betting`;else{this.current_trick=t.players.reduce(((e,t)=>e+t.tricks),1),this.trick_number.innerText=this.current_trick.toString();for(const[e,i]of t.trick.entries()){let s=t.trick_leader+e;s>=t.players.length&&(s-=t.players.length),this.addPlayedCard({card:i,index:e,player_id:s})}this.status_container.innerText=`${this.game.players[this.game.turn].player.nickname} Playing`}this.setTrumpImage(t.trump)}}))}updateBetsContainer(){let e=0,t=this.game.dealer+1;for(;t>=this.game.players.length&&(t-=this.game.players.length),!(this.game.betting&&t===this.game.turn||(e+=this.game.players[t].bet,t===this.game.dealer));)t++;this.bets_number.innerText=e.toString()}setTrumpImage(e){this.trump_card_img.src=He(e),this.trump_card_img.classList.add("show")}gameUpdate(e){return dt(this,void 0,void 0,(function*(){try{switch(e.kind){case"deal-round":const t=e.update;yield this.applyDealRound(t);break;case"bet":const i=e.update;if(this.game.turn!==i.player_id)throw new Error("Player bet out of order");yield this.applyBet(i);break;case"play-card":const s=e.update;if(this.game.turn!==s.player_id)throw new Error("Player played out of order");yield this.applyPlayCard(s);break;default:console.log(`Unknown game update type ${e.kind}`)}}catch(t){console.log(`Error during game update ${JSON.stringify(e)}: ${t}`)}}))}applyDealRound(e){return dt(this,void 0,void 0,(function*(){const t=e.cards?Math.min(150*e.cards.length,4e3)+250:0;this.game.betting=!0,this.game.dealer=e.dealer,this.game.round=e.round,this.status_container.innerText=`${this.game.players[this.game.dealer].player.nickname} Dealing`,this.round_number.innerText=e.round.toString(),this.bets_number.innerText="0",this.setTrumpImage(e.trump),this.game.trump=e.trump;for(const[i,s]of this.player_els.entries())if(e.dealer===i?s.newRound(!0):s.newRound(!1),i===this.player_id){const i=Math.min(150,t/e.cards.length);this.players_cards.setCards(e.cards,[],i)}yield y(t),this.trick_number.innerText="-",this.current_trick=0,this.game.round===this.game.max_round&&(this.game.rounds_increasing=!1),this.game.turn=(this.game.dealer+1)%this.game.players.length,this.game.trick_leader=this.game.turn;for(const[t,i]of this.game.players.entries())i.bet=-1,t===this.player_id?i.cards=e.cards:i.cards=[],i.tricks=0;this.player_els[this.game.turn].betting(),this.status_container.innerText=`${this.game.players[this.game.turn].player.nickname} Betting`}))}applyBet(e){return dt(this,void 0,void 0,(function*(){if(this.game.players[e.player_id].bet=e.amount,yield this.player_els[e.player_id].setBetAnimation(e.amount),this.game.betting=this.game.turn!==this.game.dealer,this.status_container.innerText="",this.game.turn=(this.game.turn+1)%this.game.players.length,this.updateBetsContainer(),this.game.betting)this.player_els[this.game.turn].betting(),this.status_container.innerText=`${this.game.players[this.game.turn].player.nickname} Betting`;else{this.game.trick_leader=this.game.turn,this.trick_number.innerText="1",this.current_trick=1,this.status_container.innerText=`${this.game.players[this.game.turn].player.nickname} Playing`;for(const[e,t]of this.player_els.entries())t.endBetting(),e===this.game.turn&&(t.playing(),e===this.player_id&&(this.players_cards.can_play=!0))}}))}applyPlayCard(e){return dt(this,void 0,void 0,(function*(){if(this.player_id===e.player_id&&this.game.players[e.player_id].cards.splice(e.index,1),this.game.trick.push(e.card),this.player_els[e.player_id].playCard(),e.player_id===this.player_id&&(this.players_cards.playCard(e.index),this.players_cards.can_play=!1),yield this.addPlayedCard(e),yield y(1e3),this.status_container.innerText="",this.game.turn=(this.game.turn+1)%this.game.players.length,this.game.turn!==this.game.trick_leader)return this.player_els[this.game.turn].playing(),this.status_container.innerText=`${this.game.players[this.game.turn].player.nickname} Playing`,void(this.game.turn===this.player_id&&(this.players_cards.can_play=!0));yield y(500);let t=0,i=this.game.trick[0];for(let e=1;e<this.game.trick.length;e++){const s=this.game.trick[e];s.suit===i.suit?s.number>i.number&&(t=e,i=s):s.suit===this.game.trump.suit&&(t=e,i=s)}t>=0&&t<this.trick_card_els.length&&(this.trick_card_els[t].style.zIndex="2"),this.game.turn=(this.game.trick_leader+t)%this.game.players.length,this.game.trick_leader=this.game.turn;for(const e of this.trick_card_els)e.classList.remove("played"),e.classList.add("center");yield y(1e3),this.trick_cards.style.setProperty("--winner",this.game.players[this.game.turn].order.toString());for(const e of this.trick_card_els)e.classList.remove("center"),e.classList.add("winner");yield y(1e3),this.game.players[this.game.turn].tricks++;for(const[e,t]of this.player_els.entries())t.endTrick(this.game.players[e].tricks);if(this.trick_cards.replaceChildren(),this.trick_card_els=[],this.game.trick=[],this.trick_number.innerText="-",console.log(`Trick won by ${this.game.players[this.game.turn].player.nickname} with the ${Oe(i)}`),this.current_trick!==this.game.round)return this.current_trick++,this.trick_number.innerText=this.current_trick.toString(),this.player_els[this.game.turn].playing(),this.status_container.innerText=`${this.game.players[this.game.turn].player.nickname} Playing`,void(this.game.turn===this.player_id&&(this.players_cards.can_play=!0));yield y(500),this.bets_number.innerText="-",this.trump_card_img.classList.remove("show");for(const[e,t]of this.game.players.entries())t.bet===t.tricks&&(t.score+=this.game.round_points+this.game.trick_points*t.bet,this.player_els[e].setScore(t.score)),this.player_els[e].endRound();if(this.round_number.innerText="-",this.game.rounds_increasing&&this.game.round===this.game.max_round&&(this.game.rounds_increasing=!1),this.game.rounds_increasing||1!==this.game.round)this.game.rounds_increasing?this.game.round++:this.game.round--;else{this.game.game_base.game_ended=!0;let e=[0],t=this.game.players[0].score;for(let i=1;i<this.game.players.length;i++){const s=this.game.players[i];s.score>t?(e=[i],t=s.score):s.score===t&&e.push(i)}for(const t of e)this.player_els[t].wonGame();let i=e.length>1?"The winners are: ":"The winner is: ";i+=e.map((e=>this.game.players[e].player.nickname)).join(", "),i+=`\nWith ${t} points`,Li.call(this,{message:i}),this.status_container.innerText="game over"}}))}addPlayedCard(e){return dt(this,void 0,void 0,(function*(){const t=document.createElement("div"),i=document.createElement("img");i.src=He(e.card),i.draggable=!1,i.alt=Be(e.card),t.appendChild(i),t.classList.add("card"),t.style.setProperty("--i",this.game.players[e.player_id].order.toString()),this.trick_cards.appendChild(t),this.trick_card_els.push(t),t.style.transitionDuration="1s",yield v((()=>!!getComputedStyle(t).left),20),t.classList.add("played")}))}});var lt=i(8596),ht={};ht.styleTagTransform=g(),ht.setAttributes=d(),ht.insert=o().bind(null,"head"),ht.domAPI=a(),ht.insertStyleElement=l(),t()(lt.Z,ht),lt.Z&&lt.Z.locals&&lt.Z.locals;var gt=new URL(i(6246),i.b),mt=new URL(i(4112),i.b),ut=new URL(i(371),i.b),pt=new URL(i(4260),i.b);const bt='<div id="icons-wrapper"></div> <div id="name-container"></div> <div id="status-container"></div> <div> <span class="fixed-width">Score:</span> <span id="score-container" class="right-data"></span> <div id="bid-animation"></div> </div> <div> <span class="fixed-width">Tricks:</span> <span id="tricks-container" class="right-data"></span> </div> <div id="bid-input-wrapper"> <div id="bid-input-message"></div> <div> <input id="going-alone" type="checkbox"> <label id="going-alone-label" for="going-alone">Go Alone</label> </div> <div class="suits-button-row"> <button id="spades-button"> <img src="'+W()(gt)+'" alt="spade" draggable="false"> </button> <button id="diamonds-button"> <img src="'+W()(mt)+'" alt="diamond" draggable="false"> </button> </div> <div class="suits-button-row"> <button id="clubs-button"> <img src="'+W()(ut)+'" alt="club" draggable="false"> </button> <button id="hearts-button"> <img src="'+W()(pt)+'" alt="heart" draggable="false"> </button> </div> <button id="bid-button">Bid</button> <button id="pass-button">Pass</button> </div> ';var _t=i(4833),vt={};vt.styleTagTransform=g(),vt.setAttributes=d(),vt.insert=o().bind(null,"head"),vt.domAPI=a(),vt.insertStyleElement=l(),t()(_t.Z,vt),_t.Z&&_t.Z.locals&&_t.Z.locals;var yt=function(e,t,i,s){return new(i||(i=Promise))((function(a,n){function o(e){try{d(s.next(e))}catch(e){n(e)}}function r(e){try{d(s.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}d((s=s.apply(e,t||[])).next())}))};customElements.define("dwg-euchre-player",class extends L{constructor(){super(),this.initialized=!1,this.client_player=!1,this.dealer=!1,this.icons=new Map,this.htmlString=bt,this.configureElement("name_container"),this.configureElement("status_container"),this.configureElement("score_container"),this.configureElement("tricks_container"),this.configureElement("icons_wrapper"),this.configureElement("bid_animation"),this.configureElement("bid_input_wrapper"),this.configureElement("bid_input_message"),this.configureElement("going_alone"),this.configureElement("bid_button"),this.configureElement("spades_button"),this.configureElement("diamonds_button"),this.configureElement("clubs_button"),this.configureElement("hearts_button"),this.configureElement("pass_button")}parsedCallback(){if(!this.initialized)throw new Error("Should initialize euchre player before attaching to dom");this.name_container.innerText=this.player.player.nickname,this.score_container.innerText=this.team.score.toString(),this.tricks_container.innerText="-"}initialize(e,t){this.player=e,this.team=t,this.classList.add(`team${t.team_id}`),this.initialized=!0}gameStarted(e,t,i){var s;return yt(this,void 0,void 0,(function*(){yield v((()=>this.fully_parsed)),this.setDealer(i),e.bidding||e.bidding_choosing_trump||e.dealer_substituting_card?(this.tricks_container.innerText="-",e.dealer_substituting_card?i&&this.substitutingCard():t&&this.bidding(e.bidding_choosing_trump,i,null===(s=e.card_face_up)||void 0===s?void 0:s.suit)):(this.tricks_container.innerText=this.team.tricks.toString(),t&&this.playing())}))}setClientPlayer(){this.classList.add("client-player"),this.client_player=!0,v((()=>this.fully_parsed)).then((()=>{this.bid_button.addEventListener("click",(()=>{this.disableButtons();const e={going_alone:this.going_alone.checked},t=N(`player-${this.player.player.player_id}`,"game-update",JSON.stringify(e),"bid");this.dispatchEvent(new CustomEvent("game_update",{detail:t,bubbles:!0}))})),this.spades_button.addEventListener("click",(()=>{this.disableButtons();const e={going_alone:this.going_alone.checked,trump_suit:4},t=N(`player-${this.player.player.player_id}`,"game-update",JSON.stringify(e),"bid-choose-trump");this.dispatchEvent(new CustomEvent("game_update",{detail:t,bubbles:!0}))})),this.diamonds_button.addEventListener("click",(()=>{this.disableButtons();const e={going_alone:this.going_alone.checked,trump_suit:1},t=N(`player-${this.player.player.player_id}`,"game-update",JSON.stringify(e),"bid-choose-trump");this.dispatchEvent(new CustomEvent("game_update",{detail:t,bubbles:!0}))})),this.clubs_button.addEventListener("click",(()=>{this.disableButtons();const e={going_alone:this.going_alone.checked,trump_suit:2},t=N(`player-${this.player.player.player_id}`,"game-update",JSON.stringify(e),"bid-choose-trump");this.dispatchEvent(new CustomEvent("game_update",{detail:t,bubbles:!0}))})),this.hearts_button.addEventListener("click",(()=>{this.disableButtons();const e={going_alone:this.going_alone.checked,trump_suit:3},t=N(`player-${this.player.player.player_id}`,"game-update",JSON.stringify(e),"bid-choose-trump");this.dispatchEvent(new CustomEvent("game_update",{detail:t,bubbles:!0}))})),this.pass_button.addEventListener("click",(()=>{this.disableButtons();const e=N(`player-${this.player.player.player_id}`,"game-update","{}","pass");this.dispatchEvent(new CustomEvent("game_update",{detail:e,bubbles:!0}))}))}))}disableButtons(){this.bid_button.disabled=!0,this.spades_button.disabled=!0,this.diamonds_button.disabled=!0,this.clubs_button.disabled=!0,this.hearts_button.disabled=!0,this.pass_button.disabled=!0}toggleIcon(e,t,i,s){if(s){const s=document.createElement("div");s.classList.add("icon-wrapper");const a=document.createElement("img");a.draggable=!1,a.alt=e,a.classList.add("icon"),a.src=`/images/icons/${t}32.png`;const n=document.createElement("div");n.classList.add("icon-tooltip"),n.innerText=i,s.appendChild(a),s.appendChild(n),this.icons_wrapper.append(s),this.status_container.innerText=f(e),this.icons.set(e,s)}else this.icons.has(e)&&(this.icons.get(e).remove(),this.icons.delete(e))}newRound(e){this.endRound(),this.setDealer(e)}endRound(){this.tricks_container.innerText="-",this.status_container.innerText="",this.toggleIcon("dealer","","",!1),this.toggleIcon("maker","","",!1),this.toggleIcon("defender","","",!1),this.toggleIcon("alone","","",!1),this.classList.remove("going-alone-ally")}setDealer(e){this.dealer=e,this.toggleIcon("dealer","cards","Dealt Round",e)}bidding(e,t,i){if(this.classList.add("turn"),this.client_player)if(this.bid_input_wrapper.classList.add("show"),this.bid_input_wrapper.classList.toggle("choosing-trump",!!e),this.going_alone.checked=!1,e){switch(this.bid_input_message.innerText="Choose Trump",this.spades_button.disabled=!1,this.spades_button.classList.remove("disabled"),this.diamonds_button.disabled=!1,this.diamonds_button.classList.remove("disabled"),this.clubs_button.disabled=!1,this.clubs_button.classList.remove("disabled"),this.hearts_button.disabled=!1,this.hearts_button.classList.remove("disabled"),i){case 1:this.diamonds_button.disabled=!0,this.diamonds_button.classList.add("disabled");break;case 2:this.clubs_button.disabled=!0,this.clubs_button.classList.add("disabled");break;case 3:this.hearts_button.disabled=!0,this.hearts_button.classList.add("disabled");break;case 4:this.spades_button.disabled=!0,this.spades_button.classList.add("disabled")}this.pass_button.disabled=t}else this.bid_input_message.innerText="Bid or Pass",this.bid_button.disabled=!1,this.pass_button.disabled=!1}setPassAnimation(){return yt(this,void 0,void 0,(function*(){this.bid_animation.innerText="Pass",this.bid_animation.style.transitionDuration="500ms",this.bid_animation.classList.add("transition"),yield y(1e3),this.bid_animation.classList.remove("transition"),yield y(500),this.setPass()}))}setPass(){this.classList.remove("turn"),this.client_player&&this.bid_input_wrapper.classList.remove("show")}setBidAnimation(e,t){return yt(this,void 0,void 0,(function*(){this.bid_animation.innerText=e?"Going alone!":t?`${t}s`:this.dealer?"I'll take it!":"Pick it up!",this.bid_animation.style.transitionDuration="500ms",this.bid_animation.classList.add("transition"),yield y(1e3),this.bid_animation.classList.remove("transition"),yield y(500)}))}setBid(e,t,i){e?this.toggleIcon("maker","sword","Maker Team",!0):this.toggleIcon("defender","shield","Defender Team",!0),t&&(i?(this.classList.add("going-alone-ally"),this.status_container.innerText=""):this.toggleIcon("alone","fist","Going Alone",!0)),this.classList.remove("turn"),this.client_player&&this.bid_input_wrapper.classList.remove("show")}substitutingCard(){this.classList.add("turn")}substitutedCard(){this.classList.remove("turn")}endBidding(){this.tricks_container.innerText="0"}playing(){this.classList.add("turn")}playCard(){this.classList.remove("turn")}endTrick(e){this.team.tricks=e,this.tricks_container.innerText=e.toString()}setScore(e){this.team.score=e,this.score_container.innerText=e.toString()}wonGame(){this.toggleIcon("winner","crown","Won Game",!0)}});var ft=function(e,t,i,s){return new(i||(i=Promise))((function(a,n){function o(e){try{d(s.next(e))}catch(e){n(e)}}function r(e){try{d(s.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}d((s=s.apply(e,t||[])).next())}))};function wt(e,t,i,s=Math.PI/6){!function(e,t,i,s,a=0){t<3&&console.error("n must be 3+");const n=2*Math.PI/t;e.beginPath();for(var o=0;o<t;o++)e.lineTo(i.x+s*Math.cos(n*o+a),i.y+s*Math.sin(n*o+a));e.closePath(),e.stroke(),e.fill()}(e,6,t,i,s)}function xt(e,t,i){e.beginPath(),e.ellipse(t.x,t.y,i.x,i.y,0,0,2*Math.PI),e.closePath(),e.stroke(),e.fill()}function kt(e,t){return!e&&!t||!(!e||!t)&&e.x===t.x&&e.y===t.y}function Et(e,t){return{x:e.x+t.x,y:e.y+t.y}}function zt(e,t){return{x:e.x-t.x,y:e.y-t.y}}function Lt(e,t){return{x:e*t.x,y:e*t.y}}function St(e){let t=Math.round(e.x),i=Math.round(e.y),s=Math.round(-e.x-e.y);const a=Math.abs(t-e.x),n=Math.abs(i-e.y),o=Math.abs(s+e.x+e.y);return a>n&&a>o?t=-i-s:n>o?i=-t-s:s=-t-i,{x:t,y:i}}customElements.define("dwg-euchre",class extends L{constructor(){super(),this.current_trick=0,this.player_els=[],this.player_id=-1,this.trick_card_els=[],this.htmlString='<div id="header-messages-container"> <div> <span class="span-align">Round: </span> <span id="round-number"></span> </div> <div> <span class="span-align">Trick: </span> <span id="trick-number"></span> </div> <div id="status-div"> <span class="span-center">Status</span> <span id="status-container"></span> </div> </div> <div id="card-face-up-container"> <div id="card-face-up-text"></div> <div id="card-face-up"><img id="card-face-up-img" alt="Card Face Up" draggable="false"></div> </div> <div id="table-container"> <div id="trick-cards"></div> </div> <div id="player-container"></div> <dwg-card-hand id="players-cards"></dwg-card-hand> ',this.configureElement("round_number"),this.configureElement("trick_number"),this.configureElement("status_container"),this.configureElement("card_face_up_img"),this.configureElement("table_container"),this.configureElement("trick_cards"),this.configureElement("player_container"),this.configureElement("players_cards")}parsedCallback(){this.round_number.innerText="-",this.trick_number.innerText="-",this.status_container.innerText="Starting game ...",this.players_cards.addEventListener("play_card",(e=>{const t=N(`player-${this.player_id}`,"game-update",`{"index":${e.detail}}`,this.game.dealer_substituting_card?"dealer-substitutes-card":"play-card");this.dispatchEvent(new CustomEvent("game_update",{detail:t,bubbles:!0}))})),k()?this.table_container.style.setProperty("background-image","url(/images/card_table400.png)"):this.table_container.style.setProperty("background-image","url(/images/card_table800.png)")}initialize(e,t){return ft(this,void 0,void 0,(function*(){this.player_id=e.player_id,this.game=t,this.player_els=[];for(const[e,i]of t.players.entries()){const t=document.createElement("dwg-euchre-player");t.initialize(i,ct(this.game,e)),this.player_container.appendChild(t),this.player_els.push(t),this.player_id===e&&t.setClientPlayer()}for(let t=0;t<this.player_els.length;t++){const i=Ge(this.player_id+t,this.game.players.length),s=e.is_player?t:t+.5;this.game.players[i].order=s,this.player_els[i].style.setProperty("--order",s.toString()),this.player_els[i].style.setProperty("--num-players",this.player_els.length.toString())}if(this.trick_cards.style.setProperty("--num-players",this.player_els.length.toString()),t.game_base.game_ended);else if(t.game_base.game_started){this.round_number.innerText=t.round.toString();for(const[e,i]of this.player_els.entries())i.gameStarted(t,!t.game_base.game_ended&&e===t.turn,!t.game_base.game_ended&&e===t.dealer),this.player_id!=e||t.game_base.game_ended||(this.players_cards.setCards(t.players[e].cards,t.players[e].cards_played),t.bidding||this.game.turn!==this.player_id||(this.players_cards.can_play=!0));t.bidding||t.bidding_choosing_trump||t.dealer_substituting_card?(this.current_trick=0,this.trick_number.innerText="-",this.status_container.innerText=`${this.game.players[this.game.turn].player.nickname} Bidding`,t.bidding?this.setCardFaceUpImage(t.card_face_up):t.bidding_choosing_trump?this.setBackOfCard():this.setTrumpImage()):(this.current_trick=t.teams.reduce(((e,t)=>e+t.tricks),1),this.trick_number.innerText=this.current_trick.toString(),this.status_container.innerText=`${this.game.players[this.game.turn].player.nickname} Playing`,this.setTrumpImage())}}))}setBackOfCard(){this.card_face_up_img.src="/images/cards/card_back.png",this.card_face_up_img.classList.add("show")}setTrumpImage(){this.card_face_up_img.src=`/images/cards/suit_${Ue(this.game.trump_suit)}s.png`,this.card_face_up_img.classList.add("show")}gameUpdate(e){return ft(this,void 0,void 0,(function*(){try{switch(e.kind){case"deal-round":const t=e.update;yield this.applyDealRound(t);break;case"pass":const i=e.update;if(this.game.turn!==i.player_id)throw new Error("Player pass out of order");if(this.game.bidding_choosing_trump&&this.game.turn===this.game.dealer)throw new Error("Dealer is stuck and must choose trump");yield this.applyPlayerPass(i);break;case"bid":const s=e.update;if(this.game.turn!==s.player_id)throw new Error("Player bid out of order");yield this.applyPlayerBid(s);break;case"bid-choose-trump":const a=e.update;if(this.game.turn!==a.player_id)throw new Error("Player bid choose trump out of order");yield this.applyBidChooseTrump(a);break;case"dealer-substitutes-card":const n=e.update;if(this.game.dealer!==n.player_id)throw new Error("Only dealer can substitute card");yield this.applyDealerSubstitutesCard(n);break;case"play-card":const o=e.update;if(this.game.turn!==o.player_id)throw new Error("Player played out of order");yield this.applyPlayCard(o);break;default:console.log(`Unknown game update type ${e.kind}`)}}catch(t){console.log(`Error during game update ${JSON.stringify(e)}: ${t}`)}}))}applyDealRound(e){return ft(this,void 0,void 0,(function*(){const t=e.cards?Math.min(150*e.cards.length,4e3)+250:0;this.game.bidding=!0,this.game.dealer=e.dealer,this.game.round=e.round,this.status_container.innerText=`${this.game.players[this.game.dealer].player.nickname} Dealing`,this.round_number.innerText=e.round.toString(),this.game.card_face_up=e.card_face_up,this.setCardFaceUpImage(e.card_face_up);for(const[i,s]of this.player_els.entries())if(e.dealer===i?s.newRound(!0):s.newRound(!1),i===this.player_id){const i=Math.min(150,t/e.cards.length);this.players_cards.setCards(e.cards,[],i)}yield y(t),this.game.turn=(this.game.dealer+1)%this.game.players.length,this.game.trick_leader=this.game.turn;for(const[t,i]of this.game.players.entries())t===this.player_id?i.cards=e.cards:i.cards=[];for(const e of this.game.teams)e.tricks=0;this.trick_number.innerText="-",this.current_trick=0,this.player_els[this.game.turn].bidding(!1,!1),this.status_container.innerText=`${this.game.players[this.game.turn].player.nickname} Bidding`}))}applyPlayerPass(e){return ft(this,void 0,void 0,(function*(){yield this.player_els[e.player_id].setPassAnimation(),this.player_els[e.player_id].setPass(),this.game.turn===this.game.dealer&&(this.game.bidding=!1,this.game.bidding_choosing_trump=!0,this.setBackOfCard()),this.game.turn=(this.game.turn+1)%this.game.players.length,this.player_els[this.game.turn].bidding(this.game.bidding_choosing_trump,this.game.turn===this.game.dealer,this.game.card_face_up.suit);const t=this.game.bidding?"Bidding":"Choosing Trump";this.status_container.innerText=`${this.game.players[this.game.turn].player.nickname} ${t}`}))}applyPlayerBid(e){return ft(this,void 0,void 0,(function*(){yield this.player_els[e.player_id].setBidAnimation(e.going_alone),this.game.bidding=!1,this.game.makers_team=e.player_id%2,this.game.defenders_team=0==this.game.makers_team?1:0;for(const t of this.game.teams[this.game.makers_team].player_ids){const i=e.player_id!==t;this.player_els[t].setBid(!0,e.going_alone,i),e.going_alone&&i&&this.player_id===t&&this.players_cards.removeCards()}for(const e of this.game.teams[this.game.defenders_team].player_ids)this.player_els[e].setBid(!1);this.game.player_bid=e.player_id,this.game.going_alone=e.going_alone,this.game.turn=this.game.dealer+1,this.resolveTurn(),this.game.trick_leader=this.game.turn,this.trick_number.innerText="1",this.current_trick=1,this.game.trump_suit=this.game.card_face_up.suit,e.going_alone?(this.setTrumpImage(),this.setPlaying()):(this.game.dealer_substituting_card=!0,this.player_els[this.game.dealer].substitutingCard(),this.status_container.innerText=`${this.game.players[this.game.dealer].player.nickname} Substituting Card`,this.game.dealer===this.player_id&&(this.players_cards.can_play=!0))}))}applyBidChooseTrump(e){return ft(this,void 0,void 0,(function*(){yield this.player_els[e.player_id].setBidAnimation(e.going_alone,Ue(e.trump_suit)),this.game.bidding_choosing_trump=!1,this.game.makers_team=e.player_id%2,this.game.defenders_team=0==this.game.makers_team?1:0;for(const t of this.game.teams[this.game.makers_team].player_ids){const i=e.player_id!==t;this.player_els[t].setBid(!0,e.going_alone,i),e.going_alone&&i&&this.player_id===t&&this.players_cards.removeCards()}for(const e of this.game.teams[this.game.defenders_team].player_ids)this.player_els[e].setBid(!1);this.game.player_bid=e.player_id,this.game.going_alone=e.going_alone,this.game.turn=this.game.dealer+1,this.resolveTurn(),this.game.trick_leader=this.game.turn,this.trick_number.innerText="1",this.current_trick=1,this.game.trump_suit=e.trump_suit,this.setTrumpImage(),this.setPlaying()}))}applyDealerSubstitutesCard(e){return ft(this,void 0,void 0,(function*(){this.game.dealer_substituting_card=!1,this.player_els[e.player_id].substitutedCard(),this.setTrumpImage(),this.player_id===this.game.dealer&&this.players_cards.substituteCard(e.card_index,this.game.card_face_up);for(const e of this.player_els.values())e.endBidding();this.setPlaying()}))}applyPlayCard(e){return ft(this,void 0,void 0,(function*(){this.player_id===e.player_id&&this.game.players[e.player_id].cards.splice(e.index,1),this.game.trick.push(e.card),this.player_els[e.player_id].playCard(),e.player_id===this.player_id&&(this.players_cards.playCard(e.index),this.players_cards.can_play=!1);const t=document.createElement("div"),i=document.createElement("img");if(i.src=He(e.card),i.draggable=!1,i.alt=Be(e.card),t.appendChild(i),t.classList.add("card"),t.style.setProperty("--i",this.game.players[e.player_id].order.toString()),this.trick_cards.appendChild(t),this.trick_card_els.push(t),t.style.transitionDuration="1s",yield v((()=>!!getComputedStyle(t).left),20),t.classList.add("played"),yield y(1e3),this.status_container.innerText="",this.game.turn++,this.resolveTurn()&&this.game.trick.push({number:0,suit:0}),this.game.turn!==this.game.trick_leader)return void this.setPlaying();yield y(500);let s=0,a=this.game.trick[0];for(let e=1;e<this.game.trick.length;e++){const t=this.game.trick[e];this.cardSuit(t)===this.cardSuit(a)?this.cardNumber(t)>this.cardNumber(a)&&(s=e,a=t):this.cardSuit(t)===this.game.trump_suit&&(s=e,a=t)}s>=0&&s<this.trick_card_els.length&&(this.trick_card_els[s].style.zIndex="2"),this.game.turn=(this.game.trick_leader+s)%this.game.players.length,this.game.trick_leader=this.game.turn;for(const e of this.trick_card_els)e.classList.remove("played"),e.classList.add("center");yield y(1e3),this.trick_cards.style.setProperty("--winner",this.game.players[this.game.turn].order.toString());for(const e of this.trick_card_els)e.classList.remove("center"),e.classList.add("winner");yield y(1e3),ct(this.game,this.game.turn).tricks++;for(const[e,t]of this.player_els.entries())t.endTrick(ct(this.game,e).tricks);if(this.trick_cards.replaceChildren(),this.trick_card_els=[],this.game.trick=[],this.trick_number.innerText="-",console.log(`Trick won by ${this.game.players[this.game.turn].player.nickname} with the ${Oe(a)}`),this.current_trick<5)return this.current_trick++,this.trick_number.innerText=this.current_trick.toString(),void this.setPlaying();yield y(500),this.card_face_up_img.classList.remove("show");let n=0;this.game.teams[0].tricks<3&&(n=1);const o=5===this.game.teams[n].tricks;let r=!1;r=n===this.game.makers_team?o?this.game.going_alone?this.scorePoints(this.game.makers_team,4):this.scorePoints(this.game.makers_team,2):this.scorePoints(this.game.makers_team,1):this.scorePoints(this.game.defenders_team,2);for(const[e,t]of this.game.players.entries())this.player_els[e].endRound();this.round_number.innerText="-",r?(this.game.game_base.game_ended=!0,this.status_container.innerText="game over"):this.game.round++}))}setPlaying(){this.player_els[this.game.turn].playing(),this.status_container.innerText=`${this.game.players[this.game.turn].player.nickname} Playing`,this.game.turn===this.player_id&&(this.players_cards.can_play=!0)}setCardFaceUpImage(e){this.card_face_up_img.src=He(e),this.card_face_up_img.classList.add("show")}resolveTurn(){return this.game.turn>=this.game.players.length&&(this.game.turn-=this.game.players.length),!(!this.game.going_alone||2!==Math.round(Math.abs(this.game.turn-this.game.player_bid))||(this.game.turn++,this.game.turn>=this.game.players.length&&(this.game.turn-=this.game.players.length),0))}cardSuit(e){return De(e.suit)===De(this.game.trump_suit)&&11==e.number?this.game.trump_suit:e.suit}cardNumber(e){return e.suit==this.game.trump_suit&&11==e.number?16:this.cardSuit(e)==this.game.trump_suit&&11==e.number?15:e.number}scorePoints(e,t){this.game.teams[e].score+=t;for(const t of this.game.teams[e].player_ids)this.player_els[t].setScore(this.game.teams[e].score);if(this.game.teams[e].score>=10){const t=[];for(const i of this.game.teams[e].player_ids)this.player_els[i].wonGame(),t.push(this.game.players[i].player.nickname);let i="The winners are: "+t.join(", ");return i+=`\nWith ${this.game.teams[e].score} points`,Li.call(this,{message:i}),!0}return!1}});const Tt=[{x:1,y:0},{x:1,y:-1},{x:0,y:-1},{x:-1,y:0},{x:-1,y:1},{x:0,y:1}];function Ct(e,t){const i=.866*t,s=Math.abs(e.x),a=Math.abs(e.y);return!(s>i||a>t)&&t*i-.5*t*s-i*a>=0}function Pt(e,t){return!(Math.abs(e.x)>t||Math.abs(e.y)>t||Math.abs(e.x+e.y)>t)}class It{constructor(e,t,i,s){this.data={r:0,g:0,b:0,a:0},this.setColor(e,t,i,s)}setColor(e,t,i,s){this.data=this.cleanInput(e,t,i,s)}getString(){return`rgb(${this.data.r}, ${this.data.g}, ${this.data.b}, ${this.data.a})`}addColor(e,t,i,s){const a=this.cleanInput(e,t,i,s),n=this.data.a+a.a;if(0===n)return void(this.data.a=0);const o=(this.data.a*this.data.r+a.a*a.r)/n,r=(this.data.a*this.data.g+a.a*a.g)/n,d=(this.data.a*this.data.b+a.a*a.b)/n;return this.data=this.cleanInput(o,r,d,n),this}dAlpha(e){return this.data.a+=e,this.cleanData(),this}getBrightness(){return(this.data.r+this.data.g+this.data.b)/765}cleanInput(e,t,i,s){return e<0?e=0:e>255&&(e=255),t<0?t=0:t>255&&(t=255),i<0?i=0:i>255&&(i=255),void 0===s?s=1:s<0?s=0:s>1&&(s=1),{r:e,g:t,b:i,a:s}}cleanData(){this.data=this.cleanInput(this.data.r,this.data.g,this.data.b,this.data.a)}}function Rt(e){if(!e)return;const t={coordinate:e.coordinate,visibility:e.visibility,center:{x:0,y:0},hovered:!1,hovered_neighbor:!1,hovered_row:!1,clicked:!1};if(e.zones){const i=[];for(const t of e.zones){const e=[];for(const i of t)e.push(Mt(i));i.push(e)}t.zones=i}return e.buildings&&(t.buildings=new Map(e.buildings.map((e=>[e.internal_id,$t(e)])))),e.units&&(t.units=new Map(e.units.map((e=>[e.internal_id,Zt(e)])))),t}function Mt(e){if(e)return{coordinate:e.coordinate,building:$t(e.building),units:new Map(e.units.map((e=>[e.internal_id,Zt(e)]))),hovered:!1,clicked:!1,hovered_data:[]}}function $t(e){if(e)return e}function Zt(e){if(e)return e}function Dt(e,t){if(t.x<0||t.x>=e.spaces.length)return;const i=e.spaces[t.x];return t.y<0||t.y>=i.length?void 0:i[t.y]}function Ut(e,t){return{x:t.y+e,y:t.x-Math.max(-e,-(e+t.y))}}function At(e,t){const i=t.x-e;return{x:t.y+Math.max(-e,-(e+i)),y:i}}function jt(e){const t=new It(0,0,0,0);return e&&(t.setColor(90,90,90,.8),e.visibility>0?(t.setColor(10,120,10,.8),e.hovered&&(e.clicked?t.addColor(210,210,210,.4):t.addColor(190,190,190,.2))):e.hovered&&t.addColor(150,150,150,.1)),t}function Nt(e,t,i,s,a,n){var o,r,d,c,l,h,g,m,u,p,b,_;a?s?(e.fillStyle=null!==(o=i.click_fill_style)&&void 0!==o?o:null!==(r=i.hover_fill_style)&&void 0!==r?r:i.fill_style,e.strokeStyle=null!==(d=i.click_stroke_style)&&void 0!==d?d:null!==(c=i.hover_stroke_style)&&void 0!==c?c:i.stroke_style,e.lineWidth=null!==(l=i.click_stroke_width)&&void 0!==l?l:null!==(h=i.hover_stroke_width)&&void 0!==h?h:i.stroke_width):i.draw_clicked_when_unhovered?(e.fillStyle=null!==(g=i.click_fill_style)&&void 0!==g?g:i.fill_style,e.strokeStyle=null!==(m=i.click_stroke_style)&&void 0!==m?m:i.stroke_style,e.lineWidth=null!==(u=i.click_stroke_width)&&void 0!==u?u:i.stroke_width):(e.fillStyle=i.fill_style,e.strokeStyle=i.stroke_style,e.lineWidth=i.stroke_width):s?(e.fillStyle=null!==(p=i.hover_fill_style)&&void 0!==p?p:i.fill_style,e.strokeStyle=null!==(b=i.hover_stroke_style)&&void 0!==b?b:i.stroke_style,e.lineWidth=null!==(_=i.hover_stroke_width)&&void 0!==_?_:i.stroke_width):(e.fillStyle=i.fill_style,e.strokeStyle=i.stroke_style,e.lineWidth=i.stroke_width),i.fixed_position&&(e.scale(1/t.scale,1/t.scale),e.translate(t.view.x,t.view.y)),e.beginPath(),n(),e.fill(),e.stroke(),e.closePath(),i.fixed_position&&(e.translate(-t.view.x,-t.view.y),e.scale(t.scale,t.scale))}var Ot;function Bt(e){switch(e.button){case 0:return Ot.LEFT_MOUSE;case 1:return Ot.MIDDLE_MOUSE;case 2:return Ot.RIGHT_MOUSE;default:return Ot.UNKNOWN}}!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.LEFT_MOUSE=1]="LEFT_MOUSE",e[e.RIGHT_MOUSE=2]="RIGHT_MOUSE",e[e.MIDDLE_MOUSE=3]="MIDDLE_MOUSE",e[e.ENTER_KEY=4]="ENTER_KEY",e[e.HOLD_CLICK=5]="HOLD_CLICK"}(Ot||(Ot={}));class Ht{constructor(e){this.hovering=!1,this.clicking=!1,this.click_hold_timer=0,this.hold_clicks=0,e.hold_click&&(e.hold_click_time<1?(e.hold_click=!1,console.error("Must set hold click time for hold click buttons")):e.hold_click_delay<1&&(e.hold_click_delay=e.hold_click_time)),this.config=e}isHovering(){return this.hovering}setHovering(e){this.hovering=e}isClicking(){return this.clicking}setClicking(e){this.clicking=e}draw(e,t,i){this.clicking&&this.config.hold_click&&(this.click_hold_timer-=i,this.click_hold_timer<0&&(this.click_hold_timer+=this.config.hold_click_time,this.hold_clicks++,this.clicked(Ot.HOLD_CLICK))),this._draw(e,t,i)}mousemove(e,t){const i=this.hovering;return this.hovering=this.mouseOver(e,t),!i&&this.hovering?this.hovered():i&&!this.hovering&&this.unhovered(),this.hovering}mousedown(e){const t=Bt(e);return!(t===Ot.UNKNOWN||this.config.only_right_click&&t!==Ot.LEFT_MOUSE||!this.hovering||this.clicking||(this.clicking=!0,this.click_hold_timer=this.config.hold_click_delay,this.hold_clicks=0,this.clicked(t),0))}mouseup(e){const t=Bt(e);t!==Ot.UNKNOWN&&this.clicking&&(this.clicking=!1,this.released(t))}}class Gt extends Ht{constructor(e){var t,i,s;super(e.button_config),this.reached_target={x:!1,y:!1},e.move_animation_speed=null!==(t=e.move_animation_speed)&&void 0!==t?t:0,e.rotate_animation_speed=null!==(i=e.rotate_animation_speed)&&void 0!==i?i:0,e.image_path&&(this.img=document.createElement("img"),this.img.src=`/images/${e.image_path}.png`,this.img.draggable=!1),e.rotation=null!==(s=e.rotation)&&void 0!==s?s:0,this.rect_config=e,this.refreshPositionDependencies()}setPosition(e,t){this.rect_config.move_animation_speed>0&&!kt(e,this.rect_config.p)?(this.target_p=e,this.speed_p={x:(e.x-this.rect_config.p.x)/this.rect_config.move_animation_speed,y:(e.y-this.rect_config.p.y)/this.rect_config.move_animation_speed},this.reached_target={x:!1,y:!1},this.target_callback=t):(this.rect_config.p=e,this.refreshPositionDependencies(),t&&t())}setRotation(e,t){if(this.rect_config.rotate_animation_speed>0&&e.angle!==this.rect_config.rotation){this.rotate_target=e;const i=(e.angle-this.rect_config.rotation)%(2*Math.PI);this.rotate_speed=i/this.rect_config.rotate_animation_speed,this.rotate_reached=!1,this.rotate_callback=t}else this.rect_config.rotation=e.angle,t&&t()}refreshPositionDependencies(){this.radius_p={x:.5*this.rect_config.w,y:.5*this.rect_config.h},this.center_p=Et(this.rect_config.p,this.radius_p)}xi(){return this.rect_config.p.x}yi(){return this.rect_config.p.y}xf(){return this.rect_config.p.x+this.rect_config.w}yf(){return this.rect_config.p.y+this.rect_config.h}xc(){return this.center_p.x}yc(){return this.center_p.y}w(){return this.rect_config.w}h(){return this.rect_config.h}_draw(e,t,i){if(this.target_p&&this.speed_p){if(this.reached_target.x&&this.reached_target.y)this.rect_config.p=Object.assign({},this.target_p),this.target_p=void 0,this.speed_p=void 0,this.target_callback&&this.target_callback();else{if(!this.reached_target.x){const e=this.speed_p.x*i;Math.abs(this.rect_config.p.x-this.target_p.x)<=Math.abs(e)?(this.reached_target.x=!0,this.rect_config.p.x=this.target_p.x):(this.rect_config.p.x+=e,Math.abs(this.rect_config.p.x-this.target_p.x)<=Math.abs(e)&&(this.reached_target.x=!0))}if(!this.reached_target.y){const e=this.speed_p.y*i;Math.abs(this.rect_config.p.y-this.target_p.y)<=Math.abs(e)?(this.reached_target.y=!0,this.rect_config.p.y=this.target_p.y):(this.rect_config.p.y+=e,Math.abs(this.rect_config.p.y-this.target_p.y)<=Math.abs(e)&&(this.reached_target.y=!0))}}this.refreshPositionDependencies()}if(this.rotate_target&&this.rotate_speed){const e=this.rotate_speed*i;this.rotate_reached||Math.abs(this.rect_config.rotation-this.rotate_target.angle)<=Math.abs(e)?(this.rect_config.rotation=this.rotate_target.angle,this.rotate_target=void 0,this.rotate_speed=void 0):(this.rect_config.rotation+=e,Math.abs(this.rect_config.rotation-this.rotate_target.angle)<=Math.abs(e)&&(this.rotate_reached=!0))}Nt(e,t,this.rect_config.draw_config,this.isHovering(),this.isClicking(),(()=>{e.translate(this.center_p.x,this.center_p.y),e.rotate(this.rect_config.rotation),this.img&&e.drawImage(this.img,-this.radius_p.x,-this.radius_p.y),e.rect(-this.radius_p.x,-this.radius_p.y,this.rect_config.w,this.rect_config.h),e.rotate(-this.rect_config.rotation),e.translate(-this.center_p.x,-this.center_p.y)}))}mouseOver(e,t){return this.rect_config.draw_config.fixed_position&&(e={x:e.x*t.scale-t.view.x,y:e.y*t.scale-t.view.y}),!(e.x<this.rect_config.p.x||e.y<this.rect_config.p.y||e.x>this.rect_config.p.x+this.rect_config.w||e.y>this.rect_config.p.y+this.rect_config.h)}}class Ft extends Gt{constructor(e){super(Object.assign(Object.assign({},e),{w:e.s,h:e.s}))}}class Wt extends Ft{constructor(e){super({button_config:{only_right_click:!0},p:{x:0,y:0},s:36,draw_config:{fill_style:"transparent",stroke_style:"transparent",stroke_width:0,hover_fill_style:"rgb(180, 180, 180, 0.5)",click_fill_style:"rgb(210, 210, 210, 0.7)",fixed_position:!0},move_animation_speed:200,rotate_animation_speed:400,image_path:"icons/triangle_gray36",rotation:-.5*Math.PI}),this.risq=e}hovered(){}unhovered(){}clicked(){}released(){this.isHovering()&&(this.risq.toggleRightPanel(),this.setHovering(!1))}}class qt{constructor(e,t){this.opening=!1,this.risq=e,this.config=t,this.open_button=new Wt(e),this.toggle(t.is_open)}isHovering(){return!1}isClicking(){return!1}isOpen(){return this.config.is_open}toggle(e){this.config.is_open=null!=e?e:!this.config.is_open;const t={x:this.risq.canvasSize().width-this.open_button.w(),y:.5*this.open_button.h()};this.config.is_open&&(t.x-=this.config.w),this.opening=!0,this.open_button.setPosition(t,(()=>{this.opening=!1;const e={direction:this.config.is_open,angle:this.config.is_open?.5*Math.PI:-.5*Math.PI};this.open_button.setRotation(e)}))}draw(e,t,i){this.open_button.draw(e,t,i),(this.opening||this.config.is_open)&&Nt(e,t,{fill_style:this.config.background,stroke_style:"transparent",stroke_width:0,fixed_position:!0},!1,!1,(()=>{!function(e,t,i,s,a=0){e.beginPath(),e.roundRect(t.x,t.y,i,s,a),e.closePath(),e.stroke(),e.fill()}(e,{x:this.xi(),y:this.yi()},this.w(),this.h()),!this.opening&&this.config.is_open&&function(e,t,i){var s,a,n;e.beginPath(),e.font&&(e.font=i.font),e.textAlign=null!==(s=i.align)&&void 0!==s?s:"left",e.textBaseline=null!==(a=i.baseline)&&void 0!==a?a:"top",e.direction=null!==(n=i.direction)&&void 0!==n?n:"ltr",i.fill_style&&(e.fillStyle=i.fill_style,e.fillText(t,i.p.x,i.p.y,i.w)),i.stroke_style&&(e.strokeStyle=i.stroke_style,e.lineWidth=i.stroke_width,e.strokeText(t,i.p.x,i.p.y,i.w)),e.closePath()}(e,"Turn 0",{p:{x:this.xc(),y:this.yi()},w:this.w(),fill_style:"black",align:"center",font:"12px"})}))}mousemove(e,t){return!!this.open_button.mousemove(e,t)}mousedown(e){return!!this.open_button.mousedown(e)}mouseup(e){this.open_button.mouseup(e)}xi(){return this.open_button.xf()}yi(){return 0}xf(){return this.risq.canvasSize().width}yf(){return this.risq.canvasSize().height}xc(){return this.xi()+.5*this.w()}yc(){return this.yi()+.5*this.h()}w(){return this.xf()-this.xi()}h(){return this.yf()-this.yi()}}var Jt=i(3217),Kt={};Kt.styleTagTransform=g(),Kt.setAttributes=d(),Kt.insert=o().bind(null,"head"),Kt.domAPI=a(),Kt.insertStyleElement=l(),t()(Jt.Z,Kt),Jt.Z&&Jt.Z.locals&&Jt.Z.locals;var Xt=i(5254),Vt={};Vt.styleTagTransform=g(),Vt.setAttributes=d(),Vt.insert=o().bind(null,"head"),Vt.domAPI=a(),Vt.insertStyleElement=l(),t()(Xt.Z,Vt),Xt.Z&&Xt.Z.locals&&Xt.Z.locals;var Yt=function(e,t,i,s){return new(i||(i=Promise))((function(a,n){function o(e){try{d(s.next(e))}catch(e){n(e)}}function r(e){try{d(s.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}d((s=s.apply(e,t||[])).next())}))};function Qt(e){let t="";switch(e.building_id){case 1:t="village_center";break;case 2:t="housing";break;default:return console.error("Trying to get building image from unknown building id",e.building_id),new Image}const i=new Image;return i.src=`/images/risq/buildings/${t}.png`,i.alt=t.split("_").map((e=>f(e))).join(" "),i}function ei(e){let t="";switch(e.unit_id){case 1:case 2:case 3:case 4:t="villager";break;default:return console.error("Trying to get unit image from unknown unit id",e.unit_id),new Image}const i=new Image;return i.src=`/images/risq/units/${t}.png`,i.alt=t.split("_").map((e=>f(e))).join(" "),i}function ti(e){e.units_by_type=new Map;let t=!1,i=!1;for(const s of e.units.values())t?i||(s.unit_id+=2,i=!0):(s.unit_id+=1,t=!0),e.units_by_type.has(s.unit_id)?e.units_by_type.get(s.unit_id).units.add(s.internal_id):(e.units_by_type.set(s.unit_id,{unit_id:s.unit_id,units:new Set([s.internal_id])}),e.units_by_type.set(s.unit_id+1,{unit_id:s.unit_id,units:new Set([s.internal_id])}),e.units_by_type.set(s.unit_id+2,{unit_id:s.unit_id,units:new Set([s.internal_id])}),e.units_by_type.set(s.unit_id+3,{unit_id:s.unit_id,units:new Set([s.internal_id])}))}customElements.define("dwg-canvas-board",class extends L{constructor(){super(),this.transform={scale:1,view:{x:0,y:0}},this.hovered=!1,this.holding_keys={arrow_up:!1,arrow_down:!1,arrow_left:!1,arrow_right:!1},this.cursor_move_threshold=5,this.dragging=!1,this.mouse={x:0,y:0},this.resize_observer=new ResizeObserver((e=>Yt(this,void 0,void 0,(function*(){for(const t of e)yield this.updateSize(this.data,t.contentRect),this.dispatchEvent(new CustomEvent("canvas_resize",{detail:{board_size:this.data.board_size,el_size:this.bounding_rect},bubbles:!0}))})))),this.htmlString=' <canvas id="canvas">Board</canvas> <img id="cursor" alt="cursor" draggable="false"> ',this.configureElement("canvas"),this.configureElement("cursor")}getBoundingRect(){return this.bounding_rect}initialize(e){return Yt(this,void 0,void 0,(function*(){if(this.orig_size={x:e.board_size.x,y:e.board_size.y},yield this.updateSize(e))return this.cursor.src="/images/cursors/cursor.png",this.addEventListeners(),yield v((()=>{var e;return!!(null===(e=this.canvas.getBoundingClientRect())||void 0===e?void 0:e.width)})),this.resize_observer.observe(this),setInterval((()=>{this.tick(),this.ctx.resetTransform(),this.ctx.fillStyle="black",this.ctx.fillRect(0,0,this.data.board_size.x,this.data.board_size.y),this.ctx.translate(-this.transform.view.x,-this.transform.view.y),this.ctx.scale(this.transform.scale,this.transform.scale),this.data.draw(this.ctx,this.transform)}),20),{board_size:this.data.board_size,el_size:this.bounding_rect}}))}updateSize(e,t){return Yt(this,void 0,void 0,(function*(){return!e||this.orig_size.x<1||this.orig_size.y<1?(console.error("Size must be at least 1px in each direction"),!1):(this.data=e,yield v((()=>this.fully_parsed)),this.canvas.getContext?(yield this.setSize(t),!0):(console.error("Browser does not support canvas; cannot draw board"),!1))}))}setSize(e){return Yt(this,void 0,void 0,(function*(){const t=this.data;if(e?this.bounding_rect=e:(yield v((()=>{var e;return this.bounding_rect=this.getBoundingClientRect(),!!(null===(e=this.bounding_rect)||void 0===e?void 0:e.width)})),e=this.bounding_rect),t.fill_space){const i=this.orig_size.x/this.orig_size.y;t.board_size.x=Math.max(this.orig_size.x,e.width),t.board_size.y=Math.max(this.orig_size.y,e.height),t.board_size.x/t.board_size.y>i?t.board_size.y=t.board_size.x/i:t.board_size.x=t.board_size.y*i}this.ctx=this.canvas.getContext("2d"),this.canvas.style.setProperty("--w",`${t.board_size.x.toString()}px`),this.canvas.style.setProperty("--h",`${t.board_size.y.toString()}px`),this.canvas.width=t.board_size.x,this.canvas.height=t.board_size.y}))}addEventListeners(){this.addEventListener("wheel",(e=>{const t=1+e.deltaY/250;this.setScale(this.transform.scale/t),this.data.mousemove({x:(this.mouse.x+this.transform.view.x)/this.transform.scale,y:(this.mouse.y+this.transform.view.y)/this.transform.scale},this.transform)})),this.addEventListener("mousemove",(e=>{this.hovered=!0,this.cursor.style.setProperty("--x",`${e.clientX.toString()}px`),this.cursor.style.setProperty("--y",`${e.clientY.toString()}px`);const t=this.canvas.getBoundingClientRect(),i={x:e.clientX-t.left,y:e.clientY-t.top},s=zt(i,this.mouse);this.mouse=i,this.dragging?this.setView(zt(this.transform.view,s)):this.data.mousemove({x:(this.mouse.x+this.transform.view.x)/this.transform.scale,y:(this.mouse.y+this.transform.view.y)/this.transform.scale},this.transform)})),this.addEventListener("mousedown",(e=>{e.stopImmediatePropagation(),this.data.mousedown(e)||(this.dragging=!0)})),this.addEventListener("mouseup",(e=>{e.stopImmediatePropagation(),this.dragging=!1,this.data.mouseup(e)})),this.addEventListener("mouseenter",(()=>{this.hovered=!0,this.cursor.classList.remove("hide")})),this.addEventListener("mouseleave",(()=>{this.hovered=!1,this.dragging=!1,this.cursor.classList.add("hide"),this.data.mouseleave()})),this.addEventListener("contextmenu",(e=>{e.preventDefault()}),!1),document.body.addEventListener("keydown",(e=>{if(this.hovered)switch(e.key){case"ArrowUp":this.holding_keys.arrow_up=!0;break;case"ArrowDown":this.holding_keys.arrow_down=!0;break;case"ArrowLeft":this.holding_keys.arrow_left=!0;break;case"ArrowRight":this.holding_keys.arrow_right=!0}})),document.body.addEventListener("keyup",(e=>{if(this.hovered)switch(e.key){case"ArrowUp":this.holding_keys.arrow_up=!1;break;case"ArrowDown":this.holding_keys.arrow_down=!1;break;case"ArrowLeft":this.holding_keys.arrow_left=!1;break;case"ArrowRight":this.holding_keys.arrow_right=!1}}))}tick(){const e={x:0,y:0},t=20*this.transform.scale;let i=!1;const s=this.canvas.getBoundingClientRect();this.holding_keys.arrow_up&&(e.y-=t,i=!0),this.holding_keys.arrow_down&&(e.y+=t,i=!0),this.holding_keys.arrow_left&&(e.x-=t,i=!0),this.holding_keys.arrow_right&&(e.x+=t,i=!0),this.dragging||(this.mouse.y<this.cursor_move_threshold&&(e.y-=t,i=!0),this.mouse.y>s.height-this.cursor_move_threshold&&(e.y+=t,i=!0),this.mouse.x<this.cursor_move_threshold&&(e.x-=t,i=!0),this.mouse.x>s.width-this.cursor_move_threshold&&(e.x+=t,i=!0)),i&&(this.setView({x:this.transform.view.x+e.x,y:this.transform.view.y+e.y}),this.data.mousemove({x:(this.mouse.x+this.transform.view.x)/this.transform.scale,y:(this.mouse.y+this.transform.view.y)/this.transform.scale},this.transform))}setView(e){e.x<0?e.x=0:e.x>this.data.board_size.x*this.transform.scale&&(e.x=this.data.board_size.x*this.transform.scale),e.y<0?e.y=0:e.y>this.data.board_size.y*this.transform.scale&&(e.y=this.data.board_size.y*this.transform.scale),this.transform.view=e}setScale(e){e<1/this.data.max_scale?e=1/this.data.max_scale:e>this.data.max_scale&&(e=this.data.max_scale),this.transform.view.x*=e/this.transform.scale,this.transform.view.y*=e/this.transform.scale,this.transform.scale=e}});var ii=new URL(i(6299),i.b);const si='<div id="wrapper"> <canvas id="canvas"></canvas> <button id="close-button" class="set-size"> <img id="close-button-img" class="max-size" src="'+W()(ii)+'" draggable="false"> </button> </div> ';var ai=i(2506),ni={};ni.styleTagTransform=g(),ni.setAttributes=d(),ni.insert=o().bind(null,"head"),ni.domAPI=a(),ni.insertStyleElement=l(),t()(ai.Z,ni),ai.Z&&ai.Z.locals&&ai.Z.locals,customElements.define("dwg-space-dialog",class extends tt{constructor(){super(),this.draw_interval=void 0,this.mouse={x:0,y:0},this.hovered_zone=void 0,this.hovered_space=void 0,this.hovered=!1,this.icons=new Map,this.configureElement("wrapper"),this.configureElement("canvas"),this.configureElement("close_button");for(const e of["unit","building","unit_white","building_white"])this.createIcon(e)}createIcon(e){const t=document.createElement("img");t.src=`/images/icons/${e}64.png`,t.draggable=!1,t.alt=e,this.icons.set(e,t)}getHTML(){return si}closeDialog(){this.draw_interval&&clearInterval(this.draw_interval),document.body.removeEventListener("keyup",this.keyup.bind(this)),super.closeDialog()}getData(){return this.data}setData(e,t){if(e&&(this.data=e),!t&&!this.fully_parsed)return;if(!this.canvas.getContext)return void console.error("Browser does not support canvas; cannot draw board");for(const e of this.data.space.zones)for(const t of e)t.hovered=!1,t.clicked=!1;const i=.9;.7794*window.innerWidth>i*window.innerHeight?this.size={x:i*window.innerHeight/.866,y:i*window.innerHeight}:this.size={x:i*window.innerWidth,y:i*window.innerWidth*.866},this.radius=.37*this.size.x,this.ctx=this.canvas.getContext("2d"),this.canvas.style.setProperty("--w",`${this.size.x.toString()}px`),this.canvas.style.setProperty("--h",`${this.size.y.toString()}px`),this.canvas.width=this.size.x,this.canvas.height=this.size.y,this.wrapper.addEventListener("mousemove",(e=>{this.hovered=!0;const t=this.canvas.getBoundingClientRect();this.mousemove({x:e.clientX-t.left,y:e.clientY-t.top})})),this.wrapper.addEventListener("mousedown",(e=>{e.stopImmediatePropagation(),this.mousedown(e)})),this.wrapper.addEventListener("mouseup",(e=>{e.stopImmediatePropagation(),this.mouseup(e)})),this.wrapper.addEventListener("mouseenter",(()=>{this.hovered=!0})),this.wrapper.addEventListener("mouseleave",(()=>{this.hovered=!1,this.hovered_zone&&(this.unhoverZone(this.hovered_zone),this.hovered_zone=void 0),this.hovered_space&&(this.hovered_space.hovered=!1,this.hovered_space.clicked=!1,this.hovered_space=void 0)})),this.addEventListener("contextmenu",(e=>{e.preventDefault()}),!1),document.body.addEventListener("keyup",this.keyup.bind(this)),this.close_button.addEventListener("click",(()=>{this.closeDialog()})),this.draw_interval=setInterval((()=>{this.ctx.resetTransform(),this.ctx.fillStyle="black",this.ctx.fillRect(0,0,this.size.x,this.size.y),this.draw()}),20)}draw(){var e,t;this.ctx.strokeStyle="rgba(250, 250, 250, 0.9)",this.ctx.fillStyle="rgb(0, 0, 0, 0)",this.ctx.lineWidth=4;const i=Lt(.5,this.size);this.ctx.translate(i.x,i.y);const s=this.radius,a=.42*s;wt(this.ctx,{x:0,y:0},s),this.ctx.fillStyle="rgb(10, 120, 10, 0.8)",this.ctx.lineWidth=2;let n=this.data.space.zones[1][1];this.setZoneFill(n),wt(this.ctx,{x:0,y:0},.4*s),this.drawZone(n,a,0,{x:.18*s*Math.cos(1*Math.PI/4),y:.18*s*Math.sin(1*Math.PI/4)},{x:.18*s*Math.cos(3*Math.PI/4),y:.18*s*Math.sin(3*Math.PI/4)},{x:.18*s*Math.cos(5*Math.PI/4),y:.18*s*Math.sin(5*Math.PI/4)},{x:.18*s*Math.cos(7*Math.PI/4),y:.18*s*Math.sin(7*Math.PI/4)}),this.ctx.lineWidth=4;const o=Math.PI/3;for(var r=0;r<6;r++){let i={x:0,y:0};switch(r){case 0:i={x:2,y:1};break;case 1:i={x:2,y:0};break;case 2:i={x:1,y:0};break;case 3:i={x:0,y:0};break;case 4:i={x:0,y:1};break;case 5:i={x:1,y:2}}n=this.data.space.zones[i.x][i.y],this.setZoneFill(n),this.ctx.beginPath(),this.ctx.lineTo(.4*s*Math.cos(o*r+Math.PI/6),.4*s*Math.sin(o*r+Math.PI/6)),this.ctx.lineTo(.4*s*Math.cos(o*r+Math.PI/2),.4*s*Math.sin(o*r+Math.PI/2)),this.ctx.lineTo(s*Math.cos(o*r+Math.PI/2),s*Math.sin(o*r+Math.PI/2)),this.ctx.lineTo(s*Math.cos(o*r+Math.PI/6),s*Math.sin(o*r+Math.PI/6)),this.ctx.closePath(),this.ctx.stroke(),this.ctx.fill();const d=o*(1+r);this.ctx.rotate(d);const c=Math.PI/15;this.drawZone(n,a,d,{x:.76*s*Math.cos(-c),y:.76*s*Math.sin(-c)},{x:.76*s*Math.cos(c),y:.76*s*Math.sin(c)},{x:.53*s*Math.cos(-c),y:.53*s*Math.sin(-c)},{x:.53*s*Math.cos(c),y:.53*s*Math.sin(c)}),this.ctx.rotate(-d),this.ctx.lineWidth=4;const l=At(1,i),h=Ut(this.data.game.board_size,Et(this.data.space.coordinate,l)),g=Dt(this.data.game,h);this.ctx.strokeStyle="rgba(250, 250, 250, 0.8)";const m=jt(g).dAlpha(-.2);if(this.ctx.fillStyle=m.getString(),this.ctx.beginPath(),this.ctx.lineTo(s*Math.cos(o*r+Math.PI/6),s*Math.sin(o*r+Math.PI/6)),this.ctx.lineTo(3*s*Math.cos(o*r+Math.PI/6),3*s*Math.sin(o*r+Math.PI/6)),this.ctx.lineTo(3*s*Math.cos(o*r+Math.PI/2),3*s*Math.sin(o*r+Math.PI/2)),this.ctx.lineTo(s*Math.cos(o*r+Math.PI/2),s*Math.sin(o*r+Math.PI/2)),this.ctx.closePath(),this.ctx.stroke(),this.ctx.fill(),g&&g.visibility>0){let i=this.icons.get("building"),a=this.icons.get("unit");m.getBrightness()>.5?this.ctx.fillStyle="black":(this.ctx.fillStyle="white",i=this.icons.get("building_white"),a=this.icons.get("unit_white")),this.ctx.textBaseline="top";const n=.27*s,d=.866*n,c=(.866*s+d)*Math.cos(o*r+Math.PI/3),l=(.866*s+d)*Math.sin(o*r+Math.PI/3),h=.25,u=2*d*(1-h),p=n*(1+h),b=p/3-4;this.ctx.font=`bold ${b}px serif`;const _=c-.5*u,v=l-.5*p;this.ctx.drawImage(i,_,v,b,b),this.ctx.fillText(`: ${null===(e=g.buildings)||void 0===e?void 0:e.size.toString()}`,_+b+2,v,u-b-2);const y=l-.5*p+b+2;this.ctx.drawImage(a,_,y,b,b),this.ctx.fillText(`: ${null===(t=g.units)||void 0===t?void 0:t.size.toString()}`,_+b+2,y,u-b-2)}}}mousemove(e){var t,i;let s,a;if(this.mouse=zt({x:e.x,y:e.y},Lt(.5,this.size)),Ct(this.mouse,.4*this.radius))s=this.data.space.zones[1][1],this.resolveHoveredZone(s,0);else{const e=function(e,t){const i=Math.atan2(e,t);return 0===i?0:i<0?-i:2*Math.PI-i}(this.mouse.y,this.mouse.x);let t=Math.floor((e+Math.PI/6)/(Math.PI/3)),i={x:0,y:0};switch(t){case 6:t=0;case 0:i={x:1,y:2};break;case 1:i={x:0,y:1};break;case 2:i={x:0,y:0};break;case 3:i={x:1,y:0};break;case 4:i={x:2,y:0};break;case 5:i={x:2,y:1};break;default:return void console.error("Unknown zone hovered",e)}if(Ct(this.mouse,this.radius))s=this.data.space.zones[i.x][i.y],this.resolveHoveredZone(s,-Math.PI/3*(6-t));else{const e=At(1,i),t=Ut(this.data.game.board_size,Et(this.data.space.coordinate,e));a=Dt(this.data.game,t)}}kt(null===(t=this.hovered_space)||void 0===t?void 0:t.coordinate,null==a?void 0:a.coordinate)||(this.hovered_space&&(this.hovered_space.clicked=!1,this.hovered_space.hovered=!1),this.hovered_space=a,this.hovered_space&&(this.hovered_space.hovered=!0)),this.hovered_zone&&!kt(null===(i=this.hovered_zone)||void 0===i?void 0:i.coordinate,null==s?void 0:s.coordinate)&&(this.unhoverZone(this.hovered_zone),this.hovered_zone=void 0),this.hovered_zone=s}unhoverZone(e){e.clicked=!1,e.hovered=!1;for(const t of e.hovered_data)t.clicked=!1,t.hovered=!1}resolveHoveredZone(e,t){e.hovered=!0;const i=function(e,t){return{x:e.x*Math.cos(t)-e.y*Math.sin(t),y:e.x*Math.sin(t)+e.y*Math.cos(t)}}(this.mouse,t);for(const t of e.hovered_data){const e=i.x-t.c.x,s=i.y-t.c.y;e*e/(t.r.x*t.r.x)+s*s/(t.r.y*t.r.y)<=1?t.hovered=!0:t.hovered=!1}}mousedown(e){if(this.hovered_zone){this.hovered_zone.clicked=!0;for(const e of this.hovered_zone.hovered_data)e.hovered&&(e.clicked=!0)}}mouseup(e){if(this.hovered_zone){this.hovered_zone.clicked=!1;for(const e of this.hovered_zone.hovered_data)e.clicked=!1}}keyup(e){"Escape"===e.key&&this.closeDialog()}setZoneFill(e){this.ctx.strokeStyle="rgba(250, 250, 250, 0.9)";const t=new It(10,120,10,.8);e.hovered&&!e.hovered_data.some((e=>e.hovered))&&(e.clicked?t.addColor(210,210,210,.05):t.addColor(190,190,190,.03)),this.ctx.fillStyle=t.getString()}drawZone(e,t,i,s,a,n,o){function r(e,t,i,s,a,n,o="white"){const r=e.fillStyle;e.fillStyle=o,e.font=`bold ${i}px serif`,e.fillText(t,s,a,n),e.fillStyle=r}this.ctx.textAlign="left",this.ctx.textBaseline="top",this.ctx.lineWidth=1;const d=.5*t;if(4!==e.hovered_data.length){const t={x:.5*d,y:.5*d};e.hovered_data=[{c:s,r:t},{c:a,r:t},{c:n,r:t},{c:o,r:t}]}else e.hovered_data[0].c=s,e.hovered_data[1].c=a,e.hovered_data[2].c=n,e.hovered_data[3].c=o;for(const[t,s]of e.hovered_data.entries()){switch(this.ctx.strokeStyle="transparent",s.hovered?s.clicked?this.ctx.fillStyle="rgba(200, 200, 200, 0.4)":this.ctx.fillStyle="rgba(200, 200, 200, 0.2)":this.ctx.fillStyle="transparent",this.ctx.translate(s.c.x,s.c.y),this.ctx.rotate(-i),t){case 0:e.building?this.ctx.drawImage(Qt(e.building),-s.r.x,-s.r.y,2*s.r.x,2*s.r.y):this.ctx.strokeStyle="rgba(200, 200, 200, 0.5)";break;case 1:if(e.units_by_type||ti(e),0===e.units_by_type.size)this.ctx.strokeStyle="rgba(200, 200, 200, 0.5)",r(this.ctx,"0",1.4*s.r.y,-.5*s.r.x,-.7*s.r.y,s.r.x);else if(1===e.units_by_type.size){const t=[...e.units_by_type.values()][0],i=e.units.get([...t.units.values()][0]);this.ctx.drawImage(ei(i),-s.r.x,-s.r.y,2*s.r.x,2*s.r.y),r(this.ctx,t.units.size.toString(),1.4*s.r.y,-s.r.x,-.7*s.r.y,2*s.r.x)}else if(2===e.units_by_type.size){const t=[...e.units_by_type.values()];for(let i=0;i<2;i++){const a=[...t[i].units.values()],n=e.units.get(a[0]);this.ctx.drawImage(ei(n),(.5*i-1)*s.r.x,(.5*i-1)*s.r.y,1.5*s.r.x,1.5*s.r.y),r(this.ctx,a.length.toString(),s.r.y,(.5*i-1)*s.r.x,(.5*i-1)*s.r.y,2*s.r.x)}}else if(3===e.units_by_type.size){const t=[...e.units_by_type.values()];for(let i=0;i<2;i++){const a=[...t[i].units.values()],n=e.units.get(a[0]);this.ctx.drawImage(ei(n),(.8*i-.9)*s.r.x,-.9*s.r.y,s.r.x,s.r.y),r(this.ctx,a.length.toString(),.75*s.r.y,(.8*i-1)*s.r.x,-.9*s.r.y,1.5*s.r.x)}const i=[...t[2].units.values()],a=e.units.get(i[0]);this.ctx.drawImage(ei(a),-.5*s.r.x,-.1*s.r.y,s.r.x,s.r.y),r(this.ctx,i.length.toString(),.75*s.r.y,-.5*s.r.x,-.1*s.r.y,1.5*s.r.x)}else if(4===e.units_by_type.size){const t=[...e.units_by_type.values()];for(let i=0;i<2;i++){const a=[...t[i].units.values()],n=e.units.get(a[0]);this.ctx.drawImage(ei(n),(.8*i-.9)*s.r.x,-.9*s.r.y,s.r.x,s.r.y),r(this.ctx,a.length.toString(),.75*s.r.y,(.8*i-.9)*s.r.x,-.9*s.r.y,1.5*s.r.x)}for(let i=0;i<2;i++){const a=[...t[2+i].units.values()],n=e.units.get(a[0]);this.ctx.drawImage(ei(n),(.8*i-.9)*s.r.x,-.1*s.r.y,s.r.x,s.r.y),r(this.ctx,a.length.toString(),.75*s.r.y,(.8*i-.9)*s.r.x,-.1*s.r.y,1.5*s.r.x)}}else{const t=[...e.units_by_type.values()];for(let i=0;i<2;i++){const a=[...t[i].units.values()],n=e.units.get(a[0]);this.ctx.drawImage(ei(n),(.8*i-.9)*s.r.x,-.9*s.r.y,s.r.x,s.r.y)}for(let i=0;i<1;i++){const a=[...t[2+i].units.values()],n=e.units.get(a[0]);this.ctx.drawImage(ei(n),(.8*i-.9)*s.r.x,-.1*s.r.y,s.r.x,s.r.y)}r(this.ctx,"...",.8*s.r.y,.1*s.r.x,-.1*s.r.y,s.r.x,"rgba(150, 150, 150, 0.8)"),r(this.ctx,(13*e.units.size).toString(),1.4*s.r.y,-s.r.x,-.7*s.r.y,2*s.r.x)}break;case 2:case 3:this.ctx.strokeStyle="rgba(200, 200, 200, 0.2)",this.ctx.fillStyle="transparent";break;default:console.error("No implemented")}this.ctx.rotate(i),this.ctx.translate(-s.c.x,-s.c.y),xt(this.ctx,s.c,s.r)}}});var oi=function(e,t,i,s){return new(i||(i=Promise))((function(a,n){function o(e){try{d(s.next(e))}catch(e){n(e)}}function r(e){try{d(s.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}d((s=s.apply(e,t||[])).next())}))};customElements.define("dwg-risq",class extends L{constructor(){super(),this.hex_r=60,this.hex_a=51.96,this.canvas_center={x:0,y:0},this.canvas_size=DOMRect.fromRect(),this.mouse_canvas={x:0,y:0},this.mouse_coordinate={x:0,y:0},this.icons=new Map,this.last_time=Date.now(),this.right_panel=new qt(this,{w:300,is_open:!1,background:"rgb(222,184,135)"}),this._space_dialog_lock=x(!0),this.htmlString=' <dwg-canvas-board id="board"></dwg-canvas-board> ',this.configureElement("board");for(const e of["unit","building","unit_white","building_white"])this.createIcon(e)}createIcon(e){const t=document.createElement("img");t.src=`/images/icons/${e}64.png`,t.draggable=!1,t.alt=e,this.icons.set(e,t)}initialize(e,t){return oi(this,void 0,void 0,(function*(){e.setPadding("0px"),this.game=function(e){if(!e)return;const t=[];for(const i of e.spaces){const e=[];for(const t of i)e.push(Rt(t));t.push(e)}return{game_base:e.game_base,players:e.players,board_size:e.board_size,spaces:t}}(t);const i={x:1.732*this.hex_r*(2*t.board_size+1),y:1.5*this.hex_r*(2*t.board_size+1)+.5*this.hex_r};this.board.initialize({board_size:i,max_scale:1.8,fill_space:!0,draw:this.draw.bind(this),mousemove:this.mousemove.bind(this),mouseleave:this.mouseleave.bind(this),mousedown:this.mousedown.bind(this),mouseup:this.mouseup.bind(this)}).then((e=>{this.boardResize(e.board_size,e.el_size),this.board.addEventListener("canvas_resize",(e=>{this.boardResize(e.detail.board_size,e.detail.el_size)}))}))}))}getGame(){return this.game}boardResize(e,t){this.canvas_center={x:.5*Math.min(e.x,t.width),y:.5*Math.min(e.y,t.height)},this.canvas_size=t,this.hex_r=e.x/(1.732*(2*this.game.board_size+1)),this.hex_a=.866*this.hex_r,this.toggleRightPanel(this.right_panel.isOpen())}canvasSize(){return this.canvas_size}toggleRightPanel(e){this.right_panel.toggle(e)}gameUpdate(e){return oi(this,void 0,void 0,(function*(){}))}draw(e,t){const i=Date.now(),s=i-this.last_time;this.last_time=i,e.strokeStyle="rgba(250, 250, 250, 0.9)",e.textAlign="left",e.lineWidth=2;const a=2*this.hex_a*.75,n=1.25*this.hex_r,o=n/3-4;e.font=`bold ${o}px serif`;for(const i of this.game.spaces)for(const s of i){const i=jt(s);if(e.fillStyle=i.getString(),s.center=this.coordinateToCanvas(s.coordinate,t.scale),wt(e,s.center,this.hex_r),s.visibility>0){let t=this.icons.get("building"),r=this.icons.get("unit");i.getBrightness()>.5?e.fillStyle="black":(e.fillStyle="white",t=this.icons.get("building_white"),r=this.icons.get("unit_white")),e.textBaseline="top";const d=s.center.x-.5*a,c=s.center.y-.5*n;e.drawImage(t,d,c,o,o),e.fillText(`: ${s.buildings.size.toString()}`,d+o+2,c,a-o-2);const l=s.center.y-.5*n+o+2;e.drawImage(r,d,l,o,o),e.fillText(`: ${s.units.size.toString()}`,d+o+2,l,a-o-2)}}this.right_panel.draw(e,t,s)}mousemove(e,t){var i;this.mouse_canvas=e;const s=this.right_panel.mousemove(e,t);this.mouse_coordinate=this.canvasToCoordinate(e,t.scale);const a=Ut(this.game.board_size,St(this.mouse_coordinate)),n=Dt(this.game,a);if(s||!n)return this.removeHoveredFlags(),void(this.hovered_space&&(this.hovered_space.clicked=!1,this.hovered_space=void 0));kt(n.coordinate,null===(i=this.hovered_space)||void 0===i?void 0:i.coordinate)||(this.removeHoveredFlags(),this.hovered_space&&(this.hovered_space.clicked=!1),this.hovered_space=n),this.updateHoveredFlags()}mouseleave(){this.hovered_space&&(this.hovered_space.hovered=!1,this.hovered_space.clicked=!1,this.hovered_space=void 0)}mousedown(e){return!!this.right_panel.mousedown(e)||0===e.button&&!!(this.hovered_space&&this.hovered_space.visibility>0)&&(this.hovered_space.clicked=!0,!0)}mouseup(e){this.right_panel.mouseup(e),this.hovered_space&&(this.hovered_space.clicked&&this.hovered_space.visibility>0&&this.openSpaceDialog(this.hovered_space),this.hovered_space.clicked=!1)}openSpaceDialog(e){return oi(this,void 0,void 0,(function*(){e&&this._space_dialog_lock((()=>oi(this,void 0,void 0,(function*(){const t=document.createElement("dwg-space-dialog");t.setData({space:e,game:this.game}),this.appendChild(t),yield v((()=>!document.body.contains(t)))}))))}))}canvasToCoordinate(e,t){const i=(e.y-.25*this.hex_r-this.canvas_center.y/t)/(1.5*this.hex_r)-this.game.board_size-.5;return{x:(e.x-this.canvas_center.x/t)/(1.732*this.hex_r)-.5*i-this.game.board_size-.5,y:i}}coordinateToCanvas(e,t){return{x:1.732*(e.x+.5*e.y+this.game.board_size+.5)*this.hex_r+this.canvas_center.x/t,y:1.5*(e.y+this.game.board_size+.5)*this.hex_r+.25*this.hex_r+this.canvas_center.y/t}}removeHoveredFlags(){if(this.hovered_space){this.hovered_space.hovered=!1;for(const e of this.getBoardNeighbors(this.hovered_space))e.hovered_neighbor=!1;for(const e of this.getBoardRows(this.hovered_space))e.hovered_row=!1}}updateHoveredFlags(){if(this.hovered_space){this.hovered_space.hovered=!0;for(const e of this.getBoardNeighbors(this.hovered_space))e.hovered_neighbor=!0;for(const e of this.getBoardRows(this.hovered_space))e.hovered_row=!0}}getBoardNeighbors(e){const t=[];for(const i of function(e,t){const i=St(e),s=[];for(const e of Tt){const a=Et(i,e);Pt(a,t)&&s.push(a)}return s}(e.coordinate,this.game.board_size)){const e=Ut(this.game.board_size,i),s=Dt(this.game,e);s&&t.push(s)}return t}getBoardRows(e){const t=[];for(const i of function(e,t){const i=St(e),s=[];for(const e of Tt){let a=i;for(;a=Et(a,e),Pt(a,t);)s.push(a)}return s}(e.coordinate,this.game.board_size)){const e=Ut(this.game.board_size,i),s=Dt(this.game,e);s&&t.push(s)}return t}});var ri=new URL(i(5221),i.b);const di='<div id="wrapper"> <button id="close-button"> <img src="'+W()(ri)+'" alt="close" draggable="false"> </button> <div id="updates-container"></div> </div>';var ci=i(2365),li={};li.styleTagTransform=g(),li.setAttributes=d(),li.insert=o().bind(null,"head"),li.domAPI=a(),li.insertStyleElement=l(),t()(ci.Z,li),ci.Z&&ci.Z.locals&&ci.Z.locals,customElements.define("dwg-game-history-dialog",class extends tt{constructor(){super(),this.configureElement("close_button"),this.configureElement("updates_container")}getHTML(){return di}getData(){return this.data}setData(e,t){if(this.data=e,!t&&!this.fully_parsed)return;const i=[...e.updates.values()].sort(((e,t)=>e.update_id-t.update_id));for(const e of i){const t=document.createElement("div");t.innerText=`ID: ${e.update_id}, Kind: ${e.kind}, data: ${JSON.stringify(e.update)}`,this.updates_container.append(t)}this.close_button.addEventListener("click",(()=>{this.closeDialog()}))}});var hi=new URL(i(5221),i.b);const gi='<div id="wrapper"> <button id="close-button"> <img src="'+W()(hi)+'" alt="close" draggable="false"> </button> <div id="content"> <div id="room-title" class="size-larger"></div> <div id="game-title" class="size-medium"></div> <div id="num-players" class="size-medium"> Players: <span id="num-players-current"></span>/<span id="num-players-max"></span> </div> <div id="settings-label" class="size-large">Settings:</div> <div id="game-specific-settings"></div> <div id="description-label" class="size-large">Description:</div> <div id="room-description" class="size-small"></div> </div> </div> ';var mi=i(7992),ui={};ui.styleTagTransform=g(),ui.setAttributes=d(),ui.insert=o().bind(null,"head"),ui.domAPI=a(),ui.insertStyleElement=l(),t()(mi.Z,ui),mi.Z&&mi.Z.locals&&mi.Z.locals,customElements.define("dwg-game-info-dialog",class extends tt{constructor(){super(),this.configureElement("close_button"),this.configureElement("room_title"),this.configureElement("game_title"),this.configureElement("num_players_current"),this.configureElement("num_players_max"),this.configureElement("game_specific_settings"),this.configureElement("room_description")}getHTML(){return gi}getData(){return this.data}setData(e,t){var i,s;if(this.data=e,t||this.fully_parsed){if(this.close_button.addEventListener("click",(()=>{this.closeDialog()})),this.room_title.innerText=this.data.room.room_name,this.game_title.innerText=null!==(s=B[null!==(i=this.data.room.game_settings.game_type)&&void 0!==i?i:-1])&&void 0!==s?s:"",this.num_players_current.innerText=this.data.game.players.length.toString(),this.num_players_max.innerText=this.data.room.game_settings.max_players.toString(),this.data.room.game_settings.game_specific_settings){const e=[];for(const[t,i]of Object.entries(this.data.room.game_settings.game_specific_settings)){const s=document.createElement("div");s.classList.add("setting"),s.classList.add("settings-small"),s.id=`setting-${t}`,s.innerText=`${f(t.replace("_"," "))}: ${i}`,e.push(s)}this.game_specific_settings.replaceChildren(...e)}else this.game_specific_settings.replaceChildren();this.room_description.innerText=this.data.room.room_description}}});var pi=new URL(i(5221),i.b);const bi='<div id="wrapper"> <button id="close-button"> <img src="'+W()(pi)+'" alt="close" draggable="false"> </button> <div id="players-container"></div> </div>';var _i=i(2311),vi={};vi.styleTagTransform=g(),vi.setAttributes=d(),vi.insert=o().bind(null,"head"),vi.domAPI=a(),vi.insertStyleElement=l(),t()(_i.Z,vi),_i.Z&&_i.Z.locals&&_i.Z.locals;var yi=new URL(i(2005),i.b);const fi=' <div id="ping"> <img id="ping-image" class="max-size" draggable="false"> <div id="ping-text"></div> </div> <div id="nickname"></div> <button id="rejoin-link"> <div id="rejoin-link-text">Copy Rejoin Link</div> <img id="rejoin-link-image" src="'+W()(yi)+'" alt="copy" draggable="false"> </button>';var wi=i(9936),xi={};xi.styleTagTransform=g(),xi.setAttributes=d(),xi.insert=o().bind(null,"head"),xi.domAPI=a(),xi.insertStyleElement=l(),t()(wi.Z,xi),wi.Z&&wi.Z.locals&&wi.Z.locals;customElements.define("dwg-players-dialog-player",class extends L{constructor(){super(),this.htmlString=fi,this.configureElement("ping_text"),this.configureElement("ping_image"),this.configureElement("nickname"),this.configureElement("rejoin_link"),this.configureElement("rejoin_link_text")}parsedCallback(){this.player?(this.lobby_player&&this.player.connected?(this.ping_text.innerText=`${Math.round(this.lobby_player.ping)} ms`,this.lobby_player.ping<100?this.ping_image.src="/images/icons/ping_good24.png":this.lobby_player.ping<300?this.ping_image.src="/images/icons/ping_ok24.png":this.lobby_player.ping<1e3?this.ping_image.src="/images/icons/ping_bad24.png":this.ping_image.src="/images/icons/ping_empty24.png"):(this.ping_image.src="/images/icons/ping_disconnected24.png",this.ping_text.innerText="Disconnected"),this.nickname.innerText=this.player.nickname,this.rejoin_url=`${window.location.origin}${window.location.pathname}?room_id=${this.room_id}&client_id=${this.player.client_id}`,this.rejoin_link.addEventListener("click",(()=>{return e=this,t=void 0,s=function*(){(yield function(e){return _(this,void 0,void 0,(function*(){const t=()=>{const t=document.createElement("textarea");t.value=e,t.style.top="0",t.style.left="0",t.style.position="fixed",document.body.appendChild(t),t.focus(),t.select();let i=!1;try{i=document.execCommand("copy")}catch(e){}return document.body.removeChild(t),i};if(!navigator.clipboard)return t();try{return yield navigator.clipboard.writeText(e),!0}catch(e){return t()}}))}(this.rejoin_url))?(this.rejoin_link_text.innerText="Copied!",this.copy_timeout&&clearTimeout(this.copy_timeout),this.copy_timeout=setTimeout((()=>{this.rejoin_link_text.innerText="Copy Again"}),1500)):(this.rejoin_link_text.innerText="Failed to Copy",this.copy_timeout&&clearTimeout(this.copy_timeout),this.copy_timeout=setTimeout((()=>{this.rejoin_link_text.innerText=this.rejoin_url}),1500))},new((i=void 0)||(i=Promise))((function(a,n){function o(e){try{d(s.next(e))}catch(e){n(e)}}function r(e){try{d(s.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}d((s=s.apply(e,t||[])).next())}));var e,t,i,s}))):console.error("Must set player before attaching to dom")}setData(e,t,i){this.player=e,this.lobby_player=t,this.room_id=i}}),customElements.define("dwg-players-dialog",class extends tt{constructor(){super(),this.configureElement("close_button"),this.configureElement("players_container")}getHTML(){return bi}getData(){return this.data}setData(e,t){if(this.data=e,t||this.fully_parsed){for(const e of this.data.players){const t=this.data.lobby_players.get(e.client_id),i=document.createElement("dwg-players-dialog-player");i.id=`player-${e.player_id}`,i.classList.add("player"),i.setData(e,t,this.data.room_id),this.players_container.appendChild(i)}this.close_button.addEventListener("click",(()=>{this.closeDialog()}))}}});var ki=i(9429),Ei={};Ei.styleTagTransform=g(),Ei.setAttributes=d(),Ei.insert=o().bind(null,"head"),Ei.domAPI=a(),Ei.insertStyleElement=l(),t()(ki.Z,Ei),ki.Z&&ki.Z.locals&&ki.Z.locals,customElements.define("dwg-confirm-dialog",class extends tt{constructor(){super(),this.configureElement("message_container"),this.configureElement("yes_button"),this.configureElement("no_button")}getHTML(){return'<div id="wrapper"> <div id="message-container"></div> <div id="button-wrapper"> <button id="yes-button">yes</button> <button id="no-button">no</button> </div> </div> '}getData(){var e,t,i;return{question:null!==(e=this.getAttribute("question"))&&void 0!==e?e:"",yes_text:null!==(t=this.getAttribute("yes_text"))&&void 0!==t?t:"yes",no_text:null!==(i=this.getAttribute("no_text"))&&void 0!==i?i:"no"}}setData(e,t){this.setAttribute("question",e.question),(t||this.fully_parsed)&&(this.message_container.innerText=e.question,e.yes_text&&(this.yes_button.innerText=e.yes_text),e.no_text&&(this.no_button.innerText=e.no_text),this.yes_button.addEventListener("click",(()=>{this.dispatchEvent(new Event("confirmed")),this.closeDialog()})),this.no_button.addEventListener("click",(()=>{this.closeDialog()})))}});var zi=function(e,t,i,s){return new(i||(i=Promise))((function(a,n){function o(e){try{d(s.next(e))}catch(e){n(e)}}function r(e){try{d(s.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}d((s=s.apply(e,t||[])).next())}))};function Li(e){this.dispatchEvent(new CustomEvent("show_message_dialog",{detail:e,bubbles:!0}))}customElements.define("dwg-game",class extends L{constructor(){super(),this.players_waiting_els=new Map,this.abort_controllers=[],this.game_id=0,this.player_id=-1,this.is_player=!1,this.chatbox_lock=x(),this.htmlString=Me,this.configureElement("client_name_string"),this.configureElement("client_ping"),this.configureElement("room_name"),this.configureElement("game_name"),this.configureElement("waiting_room"),this.configureElement("players_waiting"),this.configureElement("game_container"),this.configureElement("chatbox_container"),this.configureElement("chatbox"),this.configureElement("open_chatbox_button"),this.configureElement("button_game_info"),this.configureElement("button_game_history"),this.configureElement("button_room_players"),this.configureElement("button_fullscreen"),this.configureElement("maximize_img"),this.configureElement("minimize_img"),this.configureElement("button_exit")}parsedCallback(){this.minimize_img.classList.add("hide"),document.addEventListener("keyup",(e=>{"Enter"===e.key&&this.toggleChatbox()})),this.chatbox.style.setProperty("--gray-color","rgba(220, 220, 220, 0.9)"),this.chatbox.addEventListener("chat_sent",(e=>{var t,i,s;if(!this.socketActive())return void console.error("Trying to send chat with invalid socket");const a=e.detail;a.message.startsWith("\\s")?this.setSetting(a.message.slice(2).trim()):a.message.startsWith("\\l")?(a.message=a.message.slice(2).trim(),this.socket.send(N(null!==(t=a.sender)&&void 0!==t?t:`client-${this.connection_metadata.client_id}`,"lobby-chat",a.message,a.color))):a.message.startsWith("\\u")?a.message=a.message.slice(2).trim():a.message.startsWith("\\r")?(a.message=a.message.slice(2).trim(),this.socket.send(N(null!==(i=a.sender)&&void 0!==i?i:`room-${this.connection_metadata.room_id}-${this.connection_metadata.client_id}`,"room-chat",a.message,a.color))):(a.message.startsWith("\\g")&&(a.message=a.message.slice(2).trim()),this.socket.send(N(null!==(s=a.sender)&&void 0!==s?s:`game-${this.connection_metadata.client_id}`,"game-chat",a.message,a.color)))})),this.open_chatbox_button.addEventListener("click",(()=>{this.toggleChatbox()})),this.button_game_info.addEventListener("click",(()=>{const e=document.createElement("dwg-game-info-dialog");e.setData({game:this.game,room:this.lobby_room}),this.appendChild(e)})),this.button_game_history.addEventListener("click",(()=>{var e;if(!this.launched)return;const t=document.createElement("dwg-game-history-dialog");t.setData({updates:null!==(e=this.game.game_base.updates)&&void 0!==e?e:new Map}),this.appendChild(t)})),this.button_room_players.addEventListener("click",(()=>{const e=document.createElement("dwg-players-dialog");e.setData({players:[...this.game.game_base.players.values()].sort(((e,t)=>e.player_id-t.player_id)),lobby_players:this.lobby_room.players,room_id:this.lobby_room.room_id}),this.appendChild(e)})),this.button_fullscreen.addEventListener("click",(()=>{document.fullscreenElement?(document.exitFullscreen(),this.maximize_img.classList.remove("hide"),this.minimize_img.classList.add("hide")):(this.requestFullscreen(),this.maximize_img.classList.add("hide"),this.minimize_img.classList.remove("hide"))})),this.button_exit.addEventListener("click",(()=>{const e=document.createElement("dwg-confirm-dialog");e.setData({question:"Are you sure you want to exit?"}),e.addEventListener("confirmed",(()=>{this.dispatchEvent(new Event("exit_game"))})),this.appendChild(e)})),setInterval((()=>{this.pingServer()}),2500)}toggleChatbox(){this.chatbox_lock((()=>zi(this,void 0,void 0,(function*(){this.chatbox_container.classList.toggle("showing"),this.chatbox.classList.toggle("show"),this.chatbox.classList.contains("show")&&this.chatbox.focus()}))))}setPadding(e){this.game_container.style.setProperty("--padding",e)}setSetting(e){if("help"===e)return void this.chatbox.addChat({message:"There are no commands; this feature is not yet implemented",color:"gray"},!0);const t=e.split("=",2).map((e=>e.trim()));2===t.length&&(t[0],this.chatbox.addChat({message:`Unrecognized setting key "${t[0]}", try "help" to see a list of commands`,color:"gray"},!0))}launchGame(e,t,i,s=!1){return zi(this,void 0,void 0,(function*(){if((!this.launched||s)&&e&&e.game_id&&t&&t.readyState===WebSocket.OPEN&&i&&i.client_id&&i.room_id&&e.room_id===i.room_id){this.lobby_room=e,this.socket=t,this.connection_metadata=i,this.client_name_string.innerText=this.connection_metadata.nickname,this.client_ping.innerText=` (${this.connection_metadata.ping})`,this.room_name.innerText=e.room_name,this.game_id=e.game_id,this.is_player=e.players.has(this.connection_metadata.client_id);try{for(const e of this.abort_controllers)e.abort();const e=new AbortController;return this.abort_controllers.push(e),this.socket.addEventListener("message",(e=>{try{!function(e,t){var i,s,a,n,o,r,d,c,l,h,g,m;if(e.socketActive())if(m=t.kind,["game","ping"].every((e=>!m.startsWith(`${e}-`))))console.log("not a game message",t);else switch("ping-update"!==t.kind&&console.log(t),t.kind){case"ping-update":break;case"game-chat":console.log(t.sender,null===(s=null===(i=e.game)||void 0===i?void 0:i.game_base)||void 0===s?void 0:s.viewers);const m=parseInt((null!==(a=t.sender)&&void 0!==a?a:"").replace("game-",""));if(m){const i=null!==(r=null===(o=null===(n=e.game)||void 0===n?void 0:n.game_base)||void 0===o?void 0:o.players.get(m))&&void 0!==r?r:null===(c=null===(d=e.game)||void 0===d?void 0:d.game_base)||void 0===c?void 0:c.viewers.get(m);e.chatbox.addChat({message:t.content,sender:null!==(l=null==i?void 0:i.nickname)&&void 0!==l?l:m.toString()})}break;case"game-player-connected":const u=parseInt(t.data);if(u){const t=e.players_waiting_els.get(u);t&&(t.innerText="Connected",t.classList.add("connected"));const i=null===(g=null===(h=e.game)||void 0===h?void 0:h.game_base)||void 0===g?void 0:g.players.get(u);i&&(i.connected=!0)}break;case"game-start":e.startGame();break;case"game-update":!function(e,t){Ee(this,void 0,void 0,(function*(){if(!e.game_el)return;const i=t.sender.split("-");if(i.length<3)return;const s=parseInt(i[2]);if(s)try{const i=JSON.parse(t.content),a={update_id:s,kind:t.data,update:i};e.game.game_base.updates.set(s,a),ze||function(t){Ee(this,void 0,void 0,(function*(){if(ze=!0,t.update_id-1===e.game.game_base.last_continuous_update_id)for(e.game.game_base.last_continuous_update_id=t.update_id,console.log(`applying update id ${t.update_id}`),yield e.game_el.gameUpdate(t);e.game.game_base.updates.has(e.game.game_base.last_continuous_update_id+1);){const t=e.game.game_base.updates.get(e.game.game_base.last_continuous_update_id+1);e.game.game_base.last_continuous_update_id=t.update_id,console.log(`applying update id ${t.update_id}`),yield e.game_el.gameUpdate(t)}else t.update_id-1>e.game.game_base.last_continuous_update_id&&e.socket.send(N(`client-${e.connection_metadata.client_id}`,"game-get-update","",`${e.game.game_base.last_continuous_update_id+1}`));ze=!1}))}(a)}catch(t){console.log(t),e.socket.send(N(`client-${e.connection_metadata.client_id}`,"game-get-update","",`${s}`))}}))}(e,t);break;case"game-connected-failed":case"game-update-failed":case"game-get-update-failed":console.log(t.content);try{e.refreshGame()}catch(e){console.log(e)}break;default:console.log("Unknown message type",t.kind,"from",t.sender)}}(this,JSON.parse(e.data))}catch(t){console.log("Error parsing message: ",e,t)}}),{signal:e.signal}),yield this.refreshGame()}catch(e){console.log(e)}return!1}console.log("Invalid state to launch game")}))}socketActive(){return!!this.socket&&this.socket.readyState==WebSocket.OPEN}refreshGame(){return zi(this,void 0,void 0,(function*(){const e=yield function(e,t){return S(this,void 0,void 0,(function*(){const i=t instanceof File,s=i?t.type:"application/json",a=i?t.name:void 0,n=i?t:JSON.stringify(t);try{const t=yield fetch(C(e),{method:"POST",headers:{"Content-Type":s,"X-File-Name":a},body:n});return yield t.json()}catch(e){console.log(e)}return{success:!1,error_message:"Server error; please report this bug."}}))}(`lobby/games/get/${this.game_id}`,{client_id:this.connection_metadata.client_id,viewer:this.is_player?"false":"true"});if(!e.success||!e.result)return console.log(e.error_message),!1;this.game=function(e,t){var i,s;const a=new Map(e.game_base.players.map((e=>[e.client_id,e]))),n=new Map(e.game_base.viewers.map((e=>[e.client_id,e]))),o=Object.assign(Object.assign({},e),{game_base:{game_id:e.game_base.game_id,game_type:e.game_base.game_type,game_started:e.game_base.game_started,game_ended:e.game_base.game_ended,players:a,viewers:n,player_actions:e.game_base.player_actions?new Map(e.game_base.player_actions.map((e=>[e.action_id,e]))):void 0}}),r=null!==(s=null===(i=a.get(t))||void 0===i?void 0:i.updates)&&void 0!==s?s:e.game_base.viewer_updates;return void 0!==r&&(o.game_base.updates=new Map(r.map((e=>[e.update_id,e]))),o.game_base.last_continuous_update_id=r.length),o}(e.result,this.connection_metadata.client_id);let t=!1,i=!1;const s=e=>zi(this,void 0,void 0,(function*(){const s=document.createElement(e);this.game_container.replaceChildren(s),yield v((()=>s.fully_parsed)),this.game_el=s,this.player_id=-1,this.is_player=!1;for(const[e,t]of this.game.players.entries())if(t.player.client_id===this.connection_metadata.client_id){this.player_id=e,this.is_player=!0;break}this.game_el.initialize(this,this.game).then((()=>{if(t=!0,i)return this.socket.send(N(`client-${this.connection_metadata.client_id}`,"game-connected","",this.game_id.toString())),this.launched=!0,!0})),s.addEventListener("game_update",(e=>{this.game.game_base.game_ended?console.log("Game already over"):(console.log("Sending game update",e.detail),this.socket.send(e.detail))}))}));switch(this.game.game_base.game_type){case B.FIDDLESTICKS:yield s("dwg-fiddlesticks");break;case B.EUCHRE:yield s("dwg-euchre");break;case B.RISQ:yield s("dwg-risq");break;case B.UNSPECIFIED:default:throw new Error(`Unknown game type: ${this.game.game_base.game_type}`)}if(this.game_name.innerText=f(B[this.game.game_base.game_type].toLowerCase()),this.game.game_base.game_started)this.startGame();else{this.waiting_room.classList.remove("hide"),this.game_container.classList.remove("show"),this.players_waiting_els.clear(),this.players_waiting.replaceChildren();for(const[e,t]of this.game.game_base.players){const i=document.createElement("div"),s=document.createElement("div"),a=document.createElement("div");i.appendChild(s),i.appendChild(a),i.classList.add("player-waiting"),s.innerText=t.nickname,a.innerText=t.connected?"Connected":"Connecting ...",t.connected&&a.classList.add("connected"),this.players_waiting_els.set(e,a),this.players_waiting.appendChild(i)}}return this.classList.add("show"),i=!0,t?(this.socket.send(N(`client-${this.connection_metadata.client_id}`,"game-connected","",this.game_id.toString())),this.launched=!0,!0):void 0}))}startGame(){this.game.game_base.game_started=!0,this.waiting_room.classList.add("hide"),this.game_container.classList.add("show")}pingServer(){var e,t,i,s;this.socketActive()&&((null===(t=null===(e=this.game)||void 0===e?void 0:e.game_base)||void 0===t?void 0:t.game_ended)||((null===(s=null===(i=this.game)||void 0===i?void 0:i.game_base)||void 0===s?void 0:s.game_started)?this.socket.send(N(`client-${this.connection_metadata.client_id}`,"game-resend-last-update")):this.socket.send(N(`client-${this.connection_metadata.client_id}`,"game-resend-waiting-room"))))}});var Si=i(2011),Ti={};Ti.styleTagTransform=g(),Ti.setAttributes=d(),Ti.insert=o().bind(null,"head"),Ti.domAPI=a(),Ti.insertStyleElement=l(),t()(Si.Z,Ti),Si.Z&&Si.Z.locals&&Si.Z.locals;customElements.define("dwg-lobby-connector",class extends L{constructor(){super(),this.reconnect_data={nickname:"",try_reconnect:!0,client_id:0},this.invalid_names=[D],this.htmlString='<div id="card"> <div id="reconnect-wrapper"> <div id="previous-nickname"></div> <button id="reconnect-button">Reconnect to Lobby</button> <div id="new-connection-info">If you prefer not to attempt a reconnect but instead want to start a new connection, click the button below</div> <button id="new-connection-button">New Connection</button> </div> <div id="connect-wrapper"> <input id="nickname" placeholder="Nickname"> <button id="connect-button">Connect to Lobby</button> </div> <div id="status-message"></div> </div> ',this.configureElement("card"),this.configureElement("reconnect_wrapper"),this.configureElement("previous_nickname"),this.configureElement("reconnect_button"),this.configureElement("new_connection_button"),this.configureElement("connect_wrapper"),this.configureElement("nickname"),this.configureElement("connect_button"),this.configureElement("status_message")}parsedCallback(){return e=this,t=void 0,s=function*(){this.connect_button.disabled=!0;let e=!1;const t=parseInt(A("client_id"));if(t&&t>0)this.previous_nickname.innerHTML=`<em>Client ${t}</em>`,this.reconnect_data={nickname:"!!previous!!",try_reconnect:!0,client_id:t},e=!0;else try{const t=parseInt(localStorage.getItem("client_id_time")),i=parseInt(localStorage.getItem("client_id")),s=localStorage.getItem("client_nickname");s&&this.validateName(s)&&i&&t&&Date.now()-t<864e5&&(this.previous_nickname.innerText=s,this.reconnect_data={nickname:s,try_reconnect:!0,client_id:i},e=!0)}catch(e){}e?this.reconnect_wrapper.classList.add("show"):this.connect_wrapper.classList.add("show"),(yield P("ping")).success?(this.nickname.addEventListener("keyup",(e=>{this.validateInputName()&&"Enter"===e.key&&this.connect({nickname:this.nickname.value,try_reconnect:!1})})),w(this.connect_button,(()=>{if(this.validateInputName())return this.connect({nickname:this.nickname.value,try_reconnect:!1}),"Connecting ..."}),{re_enable_button:!1}),w(this.reconnect_button,(()=>(this.connect(this.reconnect_data),"Reconnecting ...")),{re_enable_button:!1}),w(this.new_connection_button,(()=>{this.reconnect_wrapper.classList.remove("show"),this.connect_wrapper.classList.add("show")}))):this.status_message.innerHTML="Cannot connect to server at this time; you can try refreshing the page"},new((i=void 0)||(i=Promise))((function(a,n){function o(e){try{d(s.next(e))}catch(e){n(e)}}function r(e){try{d(s.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}d((s=s.apply(e,t||[])).next())}));var e,t,i,s}tryReconnecting(e,t){this.status_message.innerText=e,this.reconnect_button.disabled=!1,this.reconnect_button.innerText="Reconnect to Lobby",this.connect_button.disabled=!1,this.connect_button.innerText="Reconnect to Lobby",this.reconnect_data.nickname=t.nickname,this.reconnect_data.client_id=t.client_id,this.validateName(this.reconnect_data.nickname)&&this.reconnect_data.client_id?(this.reconnect_wrapper.classList.add("show"),this.connect_wrapper.classList.remove("show")):(this.reconnect_wrapper.classList.remove("show"),this.connect_wrapper.classList.add("show")),this.classList.remove("hide")}connect(e){this.dispatchEvent(new CustomEvent("connect",{detail:e}))}validateInputName(){const e=this.validateName(this.nickname.value);return this.connect_button.disabled=!e,e}validateName(e){return!this.invalid_names.includes(e)&&e.length>1&&e.length<17}});var Ci=function(e,t,i,s){return new(i||(i=Promise))((function(a,n){function o(e){try{d(s.next(e))}catch(e){n(e)}}function r(e){try{d(s.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}d((s=s.apply(e,t||[])).next())}))};customElements.define("dwg-page-home",class extends L{constructor(){super(),this.client_on_mobile=!1,this.htmlString='<dwg-lobby id="lobby" class="connector-open"></dwg-lobby> <dwg-game id="game"></dwg-game> <dwg-lobby-connector id="lobby-connector"></dwg-lobby-connector>',this.configureElement("lobby"),this.configureElement("game"),this.configureElement("lobby_connector")}parsedCallback(){this.client_on_mobile=k(),this.client_on_mobile&&document.body.classList.add("mobile"),this.lobby_connector.addEventListener("connect",(e=>{const t=e.detail.try_reconnect?new WebSocket(`${T()}/reconnect/${e.detail.nickname}/${e.detail.client_id}`):new WebSocket(`${T()}/connect/${e.detail.nickname}`);let i=!0;t.addEventListener("error",(e=>{console.log(e),this.tryConnectionAgain((i?"Could not connect":"Connection was lost")+". Check your connection and try again.")})),t.addEventListener("open",(()=>{i=!1,this.lobby_connector.classList.add("hide"),this.lobby.classList.remove("connector-open"),this.lobby.setNickname(e.detail.nickname),this.lobby.setPing(0),this.lobby.setSocket(t),this.game.launched=!1,this.game.classList.remove("show"),this.lobby.classList.remove("hide")}))})),this.lobby.addEventListener("connection_lost",(()=>{this.tryConnectionAgain("Connection was lost. Check your connection and try again.")})),this.lobby.addEventListener("game_launched",(e=>Ci(this,void 0,void 0,(function*(){(yield this.game.launchGame(e.detail,this.lobby.socket,this.lobby.connection_metadata))&&this.lobby.classList.add("hide")})))),this.lobby.addEventListener("rejoin_game",(e=>Ci(this,void 0,void 0,(function*(){(yield this.game.launchGame(e.detail,this.lobby.socket,this.lobby.connection_metadata,!0))&&this.lobby.classList.add("hide")})))),this.game.addEventListener("exit_game",(()=>{this.game.launched=!1,this.game.classList.remove("show"),this.lobby.returnFromGame(),this.lobby.classList.remove("hide")})),this.game.addEventListener("show_message_dialog",(e=>{const t=document.createElement("dwg-message-dialog");t.setData(e.detail),this.appendChild(t)}))}tryConnectionAgain(e){this.lobby.classList.remove("connected"),this.lobby.classList.add("connector-open"),this.lobby_connector.tryReconnecting(e,this.lobby.connection_metadata)}})})()})();