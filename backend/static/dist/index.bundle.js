(()=>{"use strict";var e,t={112:(e,t,o)=>{o.d(t,{A:()=>r});var i=o(1601),n=o.n(i),a=o(6314),s=o.n(a)()(n());s.push([e.id,"dwg-lobby-rooms{display:block}dwg-lobby-rooms.loading>#room-container{display:none}dwg-lobby-rooms:not(.loading)>#loading-message{display:none}dwg-lobby-rooms>#user-container{display:flex;flex-flow:column nowrap;flex:1 0 0}dwg-lobby-rooms>#user-container>.lobby-room{margin:2px 0;width:100%}",""]);const r=s},218:(e,t,o)=>{o.d(t,{A:()=>r});var i=o(1601),n=o.n(i),a=o(6314),s=o.n(a)()(n());s.push([e.id,"dwg-players-dialog #wrapper{--button-size: 36px;align-items:center;background-color:#646464;border-radius:8px;color:#fff;height:80vh;max-height:1200px;max-width:800px;min-height:300px;min-width:250px;padding:var(--font-size-medium);position:relative;width:80vw}dwg-players-dialog #wrapper #close-button{background-color:rgba(0,0,0,0);border:none;border-radius:0px;border-top-right-radius:8px;height:var(--button-size);margin:0;padding:0;position:absolute;right:0;top:0;width:var(--button-size)}dwg-players-dialog #wrapper #close-button:hover{background-color:rgba(255,100,100,.6)}dwg-players-dialog #wrapper #close-button:active{background-color:rgba(255,180,180,.8)}dwg-players-dialog #wrapper #players-container{--margin-top: calc(6px + var(--button-size) - var(--font-size-medium));display:flex;flex-flow:column nowrap;gap:var(--font-size-small);height:calc(100% - var(--margin-top));margin-top:var(--margin-top);overflow-y:auto;width:100%}body.mobile dwg-players-dialog #wrapper{height:80svh}",""]);const r=s},346:(e,t,o)=>{o.d(t,{A:()=>r});var i=o(1601),n=o.n(i),a=o(6314),s=o.n(a)()(n());s.push([e.id,"dwg-game-history-dialog #wrapper{--button-size: 36px;align-items:center;background-color:#646464;border-radius:8px;color:#fff;height:80vh;max-height:1200px;max-width:800px;min-height:300px;min-width:250px;padding:var(--font-size-medium);position:relative;width:80vw}dwg-game-history-dialog #wrapper #close-button{background-color:rgba(0,0,0,0);border:none;border-radius:0px;border-top-right-radius:8px;height:var(--button-size);margin:0;padding:0;position:absolute;right:0;top:0;width:var(--button-size)}dwg-game-history-dialog #wrapper #close-button:hover{background-color:rgba(255,100,100,.6)}dwg-game-history-dialog #wrapper #close-button:active{background-color:rgba(255,180,180,.8)}dwg-game-history-dialog #wrapper #updates-container{--margin-top: calc(6px + var(--button-size) - var(--font-size-medium));display:flex;flex-flow:column nowrap;gap:var(--font-size-small);height:calc(100% - var(--margin-top));margin-top:var(--margin-top);overflow-y:auto;width:100%}body.mobile dwg-game-history-dialog #wrapper{height:80svh}",""]);const r=s},540:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},575:(e,t,o)=>{o.d(t,{A:()=>r});var i=o(1601),n=o.n(i),a=o(6314),s=o.n(a)()(n());s.push([e.id,"dwg-lobby{--name-header-height: calc(1.6 * var(--font-size-small));--buttons-height: calc(1.5 * var(--font-size-large));--chat-height: calc(min(450px, max(180px, 25vh)));--lobby-users-width: 250px;--lobby-rooms-height: calc(100vh - var(--name-header-height) - var(--buttons-height) - var(--chat-height));background-color:#143c78;display:flex;flex-flow:column nowrap}dwg-lobby.hide{display:none}dwg-lobby>#page-header{background-color:#001e3c;box-sizing:border-box;display:block;font-size:var(--font-size-small);height:var(--name-header-height);line-height:var(--name-header-height);max-height:var(--name-header-height);min-height:var(--name-header-height);padding-left:1.5em;width:100%}dwg-lobby>#page-header #ping-container{margin-left:2em}dwg-lobby>#buttons{--padding: 6px;background-color:#0a3264;border-bottom:2px solid #000;box-sizing:border-box;display:flex;flex-flow:row nowrap;gap:var(--padding);height:var(--buttons-height);padding-left:var(--padding);max-height:var(--buttons-height);min-height:var(--buttons-height);width:100%}dwg-lobby>#buttons>button{background-color:rgba(0,0,0,0);border:none;border-radius:calc(2*var(--padding));color:#fff;font-size:calc(.7*(var(--buttons-height) - 2*var(--padding)));line-height:calc(var(--buttons-height) - 2*var(--padding));padding:var(--padding);transition:background-color 200ms,border-radius 200ms}dwg-lobby>#buttons>button:hover:not(:disabled){background-color:rgba(50,100,200,.2)}dwg-lobby>#buttons>button:active:not(:disabled){background-color:rgba(70,140,250,.4);border-radius:0px}dwg-lobby>#buttons>button:disabled{background-color:rgba(150,150,150,.6);border-radius:8px;transition:none}dwg-lobby>#buttons>button#lobby-users-button{display:none;margin-left:auto;z-index:2}dwg-lobby>#horizontal-container{display:flex;flex-flow:row nowrap;flex:1 0 0;width:100%}dwg-lobby>#horizontal-container>#vertical-container{display:flex;flex-flow:column nowrap;flex:1 0 0;height:100%}dwg-lobby>#horizontal-container>#vertical-container>#lobby-rooms{box-sizing:border-box;flex:0 0 var(--lobby-rooms-height);height:var(--lobby-rooms-height);max-height:var(--lobby-rooms-height);min-height:var(--lobby-rooms-height);padding:.5em}dwg-lobby>#horizontal-container>#vertical-container>#chatbox{box-sizing:border-box;flex:1 1 var(--chat-height);height:var(--chat-height);max-height:var(--chat-height);min-height:var(--chat-height);padding:.5em}dwg-lobby>#horizontal-container>#lobby-users-backdrop{background-color:rgba(150,150,150,.5);display:none;height:100vh;left:0px;position:absolute;top:0px;width:100vw}dwg-lobby>#horizontal-container>#lobby-users{background-color:#0a1e32;box-sizing:border-box;height:100%;padding:8px;width:var(--lobby-users-width)}dwg-lobby>#lobby-room-wrapper{background-color:rgba(150,150,150,.5);bottom:0;left:0;position:absolute;right:0;top:0;z-index:3}dwg-lobby>#lobby-room-wrapper:not(.show){display:none}dwg-lobby>#lobby-room-wrapper #lobby-room{--width: max(70vw, min(530px, calc(100vw - 16px)));box-sizing:border-box;height:70vh;margin:15vh auto;padding:8px;width:var(--width)}dwg-lobby>#lobby-connected-wrapper{align-items:center;background-color:rgba(150,150,150,.5);bottom:0;display:flex;font-size:3vw;justify-content:center;left:0;position:absolute;right:0;top:0;z-index:4}dwg-lobby.connected #lobby-connected-wrapper{display:none}dwg-lobby.connector-open #connecting-message{display:none}body.mobile dwg-lobby{--lobby-rooms-height: calc(100svh - var(--name-header-height) - var(--buttons-height) - var(--chat-height))}body.mobile dwg-lobby>#buttons>#lobby-users-button{display:block}body.mobile dwg-lobby>#horizontal-container{width:calc(100% + var(--lobby-users-width))}body.mobile dwg-lobby>#horizontal-container>#lobby-users-backdrop{height:100svh}body.mobile dwg-lobby>#horizontal-container>#lobby-users-backdrop.show{display:block}body.mobile dwg-lobby>#horizontal-container>#lobby-users{left:0px;position:relative;transition:left 400ms ease-in-out}body.mobile dwg-lobby>#horizontal-container>#lobby-users.show{left:calc(-1*var(--lobby-users-width))}body.mobile dwg-lobby>#lobby-room-wrapper #lobby-room{box-sizing:border-box;height:90svh;margin:5svh 5vw;padding:6px;width:90vw}",""]);const r=s},1113:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},1393:(e,t,o)=>{e.exports=o.p+"9cc772be7d4d2437a8de.png"},1400:(e,t,o)=>{o.d(t,{A:()=>r});var i=o(1601),n=o.n(i),a=o(6314),s=o.n(a)()(n());s.push([e.id,"dwg-lobby-game-settings{background-color:rgba(150,150,150,.4);bottom:0;left:0;position:absolute;right:0;top:0}dwg-lobby-game-settings:not(.show){display:none}dwg-lobby-game-settings>#game-settings-wrapper{--gap: 1.3em;--size-h: 50vh;--size-w: 50vw;background-color:#d3d3d3;box-shadow:0 0 6px 6px rgba(70,70,70,.5);box-sizing:border-box;color:#000;display:flex;flex-flow:column nowrap;font-size:var(--font-size-medium);gap:var(--gap);margin:calc(.5*(100vh - var(--size-h))) auto;overflow:hidden;padding:8px;position:relative}dwg-lobby-game-settings>#game-settings-wrapper *{font-size:var(--font-size-medium);line-height:var(--font-size-medium)}dwg-lobby-game-settings>#game-settings-wrapper>#game-settings-title{flex:0 0 fit-content;font-size:var(--font-size-large);line-height:calc(2*var(--font-size-large));text-align:center}dwg-lobby-game-settings>#game-settings-wrapper>#game-chooser{flex:0 0 fit-content}dwg-lobby-game-settings>#game-settings-wrapper>#settings-wrapper{box-sizing:border-box;flex:1 0 0;overflow-y:auto;position:relative;width:100%}dwg-lobby-game-settings>#game-settings-wrapper>#settings-wrapper label{font-size:.8rem}dwg-lobby-game-settings>#game-settings-wrapper>#settings-wrapper input{font-size:var(--font-size-medium)}dwg-lobby-game-settings>#game-settings-wrapper>#settings-wrapper .row-wrapper{display:flex;flex-flow:row nowrap;gap:8px}dwg-lobby-game-settings>#game-settings-wrapper>#settings-wrapper .row-wrapper>.input-wrapper{flex:1 0 0;min-width:0}dwg-lobby-game-settings>#game-settings-wrapper>#settings-wrapper .row-wrapper>.input-wrapper>input{min-width:0;width:100%}dwg-lobby-game-settings>#game-settings-wrapper>#settings-wrapper>#max-players-wrapper{margin-bottom:var(--gap)}dwg-lobby-game-settings>#game-settings-wrapper>#settings-wrapper>#description-wrapper{margin-top:var(--gap)}dwg-lobby-game-settings>#game-settings-wrapper>#settings-wrapper>#description-wrapper>#room-description{resize:vertical;width:100%}dwg-lobby-game-settings>#game-settings-wrapper>#settings-wrapper>#game-specific-settings{display:flex;flex-flow:column nowrap;gap:calc(.7*var(--gap));height:fit-content}dwg-lobby-game-settings>#game-settings-wrapper>#save-button{flex:0 0 fit-content;font-size:var(--font-size-medium);margin-top:.4em}body.mobile dwg-lobby-game-settings>#game-settings-wrapper{--size-h: 80vh;--size-w: 90vw;padding:8px}body.mobile dwg-lobby-game-settings>#game-settings-wrapper .row-wrapper{flex-direction:column}",""]);const r=s},1424:(e,t,o)=>{o.d(t,{A:()=>r});var i=o(1601),n=o.n(i),a=o(6314),s=o.n(a)()(n());s.push([e.id,"dwg-lobby-connector{font-size:var(--font-size-large);height:100vh;left:0px;position:absolute;top:0px;width:100vw}dwg-lobby-connector.hide{display:none}dwg-lobby-connector>#card{--width: calc(12 * var(--font-size-large));background-color:#dcdcdc;box-shadow:0 0 8px 8px rgba(60,60,60,.7);color:#000;height:calc(12.5*var(--font-size-large));left:calc(50% - 100px);padding:16px;position:relative;top:calc(50% - 150px);width:var(--width)}dwg-lobby-connector>#card button{display:block;font-size:var(--font-size-large);margin:20px auto 0;width:var(--width)}dwg-lobby-connector>#card>#reconnect-wrapper:not(.show){display:none}dwg-lobby-connector>#card>#reconnect-wrapper>#previous-nickname{height:calc(1.8*var(--font-size-large));text-align:center}dwg-lobby-connector>#card>#reconnect-wrapper>#new-connection-info{font-size:var(--font-size-small);text-align:center}dwg-lobby-connector>#card>#connect-wrapper:not(.show){display:none}dwg-lobby-connector>#card>#connect-wrapper>#nickname{display:block;font-size:var(--font-size-large);margin:20px auto 30px;width:var(--width)}dwg-lobby-connector>#card>#status-message{color:#b42828;font-size:var(--font-size-small);margin-top:.5em;text-align:center}body.mobile dwg-lobby-connector{height:100svh}body.mobile dwg-lobby-connector #card{box-sizing:border-box;left:6px;width:calc(100% - 12px)}body.mobile dwg-lobby-connector #card #nickname{width:calc(100% - 24px)}body.mobile dwg-lobby-connector #card #connect-button{width:calc(100% - 24px)}",""]);const r=s},1504:(e,t,o)=>{o.d(t,{A:()=>r});var i=o(1601),n=o.n(i),a=o(6314),s=o.n(a)()(n());s.push([e.id,"dwg-room-selector{--font-size: var(--font-size-medium);--height: calc(2 * var(--font-size));background-color:rgba(0,0,0,0);display:flex;flex-flow:row nowrap;font-size:var(--font-size);height:var(--height);line-height:var(--height);position:relative;user-select:none}dwg-room-selector:hover{background-color:rgba(180,180,180,.15)}dwg-room-selector:hover>#room-buttons{display:flex}dwg-room-selector>#room-players{margin-left:.3em;text-align:left;width:3em}dwg-room-selector>#room-game{--width: 8em;margin-left:1em;max-width:var(--width);min-width:var(--width);text-align:left;width:var(--width)}dwg-room-selector>#room-name{margin-left:1em}dwg-room-selector>#room-buttons{--margin: 6px;bottom:var(--margin);display:none;flex-flow:row nowrap;gap:var(--margin);position:absolute;right:var(--margin);top:var(--margin)}dwg-room-selector>#room-buttons>button{--width: calc(var(--height) - 2 * var(--margin));background-color:rgba(240,240,240,.8);border:none;border-radius:5px;display:inline-block;height:var(--width);margin:0;padding:0;width:var(--width)}dwg-room-selector>#room-buttons>button:hover{background-color:rgba(250,250,250,.9)}dwg-room-selector>#room-buttons>button:active{background-color:rgba(230,230,230,.7)}dwg-room-selector>#room-buttons>button>img{--size: min(24px, 100%);height:var(--size);width:var(--size)}body.mobile dwg-room-selector{--font-size: var(--font-size-small)}body.mobile dwg-room-selector>#room-players{margin-left:.2em;width:2em}body.mobile dwg-room-selector>#room-game{--width: 7em;margin-left:.4em}body.mobile dwg-room-selector>#room-name{margin-left:.4em}body.mobile dwg-room-selector>#room-buttons{--margin: 1px;display:flex}body.mobile dwg-room-selector>#room-buttons>button{background-color:rgba(240,240,240,.5)}body.mobile dwg-room-selector>#room-buttons>button:active{background-color:rgba(230,230,230,.7)}",""]);const r=s},1511:(e,t,o)=>{o.d(t,{$P:()=>l,Lq:()=>a,Vg:()=>r});var i=o(7447),n=function(e,t,o,i){return new(o||(o=Promise))(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function r(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(s,r)}l((i=i.apply(e,t||[])).next())})};function a(){var e="https:"==window.location.protocol?"wss://":"ws://";return i.IJ?`ws://${location.hostname}:6807/api/lobby`:`${e}${location.hostname}${location.port?":"+location.port:""}/api/lobby`}function s(e){return`/api/${e}/`}function r(e){return n(this,void 0,void 0,function*(){try{const t=yield fetch(s(e),{method:"GET",headers:{"Content-Type":"application/json"}});return yield t.json()}catch(e){console.log(e)}return{success:!1,error_message:"Server error; please report this bug."}})}function l(e,t){return n(this,void 0,void 0,function*(){const o=t instanceof File,i=o?t.type:"application/json",n=o?t.name:void 0,a=o?t:JSON.stringify(t);try{const t=yield fetch(s(e),{method:"POST",headers:{"Content-Type":i,"X-File-Name":n},body:a});return yield t.json()}catch(e){console.log(e)}return{success:!1,error_message:"Server error; please report this bug."}})}},1601:e=>{e.exports=function(e){return e[1]}},1846:(e,t,o)=>{o.d(t,{A:()=>r});var i=o(1601),n=o.n(i),a=o(6314),s=o.n(a)()(n());s.push([e.id,"",""]);const r=s},1869:(e,t,o)=>{e.exports=o.p+"c3cb371e1616269849ad.png"},1876:(e,t,o)=>{var i=o(1981),n=o(5072),a=o.n(n),s=o(7825),r=o.n(s),l=o(7659),d=o.n(l),c=o(5056),m=o.n(c),g=o(540),h=o.n(g),u=o(1113),b=o.n(u),p=o(2938),v={};v.styleTagTransform=b(),v.setAttributes=m(),v.insert=d().bind(null,"head"),v.domAPI=r(),v.insertStyleElement=h(),a()(p.A,v),p.A&&p.A.locals&&p.A.locals;class _ extends i.U{constructor(){super(),this.configureElement("message_container"),this.configureElement("yes_button"),this.configureElement("no_button")}getHTML(){return'<div id="wrapper"> <div id="message-container"></div> <div id="button-wrapper"> <button id="yes-button">yes</button> <button id="no-button">no</button> </div> </div> '}getData(){var e,t,o;return{question:null!==(e=this.getAttribute("question"))&&void 0!==e?e:"",yes_text:null!==(t=this.getAttribute("yes_text"))&&void 0!==t?t:"yes",no_text:null!==(o=this.getAttribute("no_text"))&&void 0!==o?o:"no"}}setData(e,t){this.setAttribute("question",e.question),(t||this.fully_parsed)&&(this.message_container.innerText=e.question,e.yes_text&&(this.yes_button.innerText=e.yes_text),e.no_text&&(this.no_button.innerText=e.no_text),this.yes_button.addEventListener("click",()=>{this.dispatchEvent(new Event("confirmed")),this.closeDialog()}),this.no_button.addEventListener("click",()=>{this.closeDialog()}))}}customElements.define("dwg-confirm-dialog",_)},1893:(e,t,o)=>{o.d(t,{A:()=>r});var i=o(1601),n=o.n(i),a=o(6314),s=o.n(a)()(n());s.push([e.id,".dwg-dialog-box{align-items:center;background-color:rgba(120,120,120,.8);bottom:0;display:flex;left:0;justify-content:center;position:absolute;right:0;top:0;z-index:100}.dwg-dialog-box #wrapper{background-color:#505050;box-shadow:0px 0px 3px 3px rgba(200,200,200,.8);color:#fff;font-size:var(--font-size-medium);padding:1em;position:relative}.dwg-dialog-box #wrapper button{border-radius:.2em;font-size:var(--font-size-medium);padding:.1em .4em}",""]);const r=s},1981:(e,t,o)=>{o.d(t,{U:()=>y});var i=o(4161),n=o(7447),a=o(5072),s=o.n(a),r=o(7825),l=o.n(r),d=o(7659),c=o.n(d),m=o(5056),g=o.n(m),h=o(540),u=o.n(h),b=o(1113),p=o.n(b),v=o(1893),_={};_.styleTagTransform=p(),_.setAttributes=g(),_.insert=c().bind(null,"head"),_.domAPI=l(),_.insertStyleElement=u(),s()(v.A,_),v.A&&v.A.locals&&v.A.locals;class y extends i.J{constructor(){super(),this.htmlString='<div id="content-container"></div> ',this.configureElement("content_container")}connectedCallback(){const e=Object.create(null,{connectedCallback:{get:()=>super.connectedCallback}});return t=this,o=void 0,a=function*(){e.connectedCallback.call(this),yield(0,n.TG)(()=>(this.content_container=this.querySelector("#content-container"),!!this.content_container)),this.classList.add("dwg-dialog-box"),this.content_container.innerHTML=this.getHTML()},new((i=void 0)||(i=Promise))(function(e,n){function s(e){try{l(a.next(e))}catch(e){n(e)}}function r(e){try{l(a.throw(e))}catch(e){n(e)}}function l(t){var o;t.done?e(t.value):(o=t.value,o instanceof i?o:new i(function(e){e(o)})).then(s,r)}l((a=a.apply(t,o||[])).next())});var t,o,i,a}parsedCallback(){this.setData(this.getData(),!0)}closeDialog(){this.remove()}}},2074:(e,t,o)=>{function i(e){var t;return null!==(t=new URL(window.location.href).searchParams.get(e))&&void 0!==t?t:""}function n(e,t){const o=new URL(window.location.href).searchParams;t?o.set(e,t):o.delete(e),window.history.replaceState(null,"",`?${o.toString()}`)}function a(e){const t=new URL(window.location.href).searchParams;t.delete(e),window.history.replaceState(null,"",`?${t.toString()}`)}o.d(t,{Bg:()=>n,P3:()=>i,Vr:()=>a})},2190:(e,t,o)=>{e.exports=o.p+"4b3f87b66da56a68a450.png"},2200:(e,t,o)=>{e.exports=o.p+"efe4c9fa82cefdec8b1d.png"},2453:(e,t,o)=>{o.d(t,{A:()=>r});var i=o(1601),n=o.n(i),a=o(6314),s=o.n(a)()(n());s.push([e.id,"dwg-game{--card-image-scale: 1.452;--header-height: calc(1.5 * var(--font-size-small));background-color:#000}dwg-game>#header{background-color:#323232;display:flex;flex-flow:row nowrap;height:var(--header-height);max-height:var(--header-height);min-height:var(--header-height);width:100%}dwg-game>#header *{line-height:var(--header-height)}dwg-game>#header>#client-name{margin-left:1em}dwg-game>#header>#room-name,dwg-game>#header #game-name{margin-left:3em}dwg-game>#header>#button-container{align-items:center;display:flex;flex-flow:row nowrap;gap:2px;justify-content:center;margin-left:auto;margin-right:4px}dwg-game>#header>#button-container>button{border-radius:0;height:var(--header-height);padding:0;width:calc(1.3*var(--header-height))}dwg-game>#header>#button-container>button>img{height:100%;width:76.9230769231%}dwg-game>#header>#button-container>button>img.hide{display:none}dwg-game>#waiting-room{align-items:center;background-color:#964007;display:flex;height:calc(100% - var(--header-height));justify-content:center}dwg-game>#waiting-room.hide{display:none}dwg-game>#waiting-room .player-waiting{display:flex;flex-flow:row nowrap;font-size:18px;gap:1em;margin:.3em 0}dwg-game>#waiting-room .player-waiting :last-child{margin-left:auto}dwg-game>#waiting-room .player-waiting .connected{color:#64ff64}dwg-game>#game-container{--padding: var(--font-size-medium);--game-height: calc(100vh - var(--header-height) - 2 * var(--padding));--game-width: calc(100vw - 2 * var(--padding));--color-background: rgb(90, 40, 10);background-color:#461e05;box-sizing:border-box;height:calc(100vh - var(--header-height));padding:var(--padding)}dwg-game>#game-container:not(.show){display:none}dwg-game>#chatbox-container{--left: 3px;background-color:rgba(0,0,0,0);height:75vh;left:var(--left);position:absolute;top:10vh;width:50vw;z-index:9}dwg-game>#chatbox-container:not(.showing){pointer-events:none}dwg-game>#chatbox-container>#open-chatbox-button{--size: 36px;--img-size: 32px;align-items:center;background-color:rgba(250,250,250,.2);border:none;border-radius:calc(2*(var(--size) - var(--img-size)));display:flex;height:var(--size);justify-content:center;left:calc(-0.9*var(--size));pointer-events:all;position:relative;top:0;transition:left .3s;width:var(--size)}dwg-game>#chatbox-container>#open-chatbox-button:hover{background-color:rgba(250,250,250,.5);left:calc(-1*var(--left))}dwg-game>#chatbox-container>#open-chatbox-button:active{background-color:rgba(250,250,250,.8)}dwg-game>#chatbox-container>#open-chatbox-button>img{height:var(--img-size);width:var(--img-size)}body.mobile dwg-game{--header-height: calc(1.5 * var(--font-size-medium))}body.mobile dwg-game>#header>#client-name{display:none}body.mobile dwg-game>#header>#room-name{margin-left:1em}body.mobile dwg-game>#header>#game-name{display:none}body.mobile dwg-game>#header>#button-container{gap:3px}body.mobile dwg-game>#game-container{--padding: var(--font-size-small);--game-height: calc(100svh - var(--header-height) - 2 * var(--padding));height:calc(100svh - var(--header-height))}body.mobile dwg-game>#chatbox-container{height:75svh;top:10svh}body.mobile dwg-game>#chatbox-container>#open-chatbox-button{--size: 24px;--img-size: 20px;left:calc(-1*var(--left))}",""]);const r=s},2500:(e,t,o)=>{e.exports=o.p+"8ce35c1f4770f46431c3.png"},2938:(e,t,o)=>{o.d(t,{A:()=>r});var i=o(1601),n=o.n(i),a=o(6314),s=o.n(a)()(n());s.push([e.id,"dwg-confirm-dialog #wrapper{align-items:center;display:flex;flex-flow:column nowrap;height:35vh;gap:1em;max-height:400px;max-width:500px;min-height:220px;min-width:220px;width:35vw}dwg-confirm-dialog #wrapper>#button-wrapper{align-items:center;display:flex;flex-flow:row nowrap;gap:.5em;margin-top:auto}dwg-confirm-dialog #wrapper>#button-wrapper>buttom{color:#000;padding:.3em .6em}body.mobile dwg-confirm-dialog #wrapper{height:50svh;width:50vw}",""]);const r=s},3142:(e,t,o)=>{e.exports=o.p+"52ee16dc6a2c63149aca.png"},3192:(e,t,o)=>{o.d(t,{A:()=>r});var i=o(1601),n=o.n(i),a=o(6314),s=o.n(a)()(n());s.push([e.id,"dwg-game-info-dialog #wrapper{--button-size: 36px;align-items:center;background-color:#646464;border-radius:8px;color:#fff;height:80vh;max-height:1200px;max-width:800px;min-height:300px;min-width:250px;padding:var(--font-size-medium);position:relative;width:80vw}dwg-game-info-dialog #wrapper #close-button{background-color:rgba(0,0,0,0);border:none;border-radius:0px;border-top-right-radius:8px;height:var(--button-size);margin:0;padding:0;position:absolute;right:0;top:0;width:var(--button-size)}dwg-game-info-dialog #wrapper #close-button:hover{background-color:rgba(255,100,100,.6)}dwg-game-info-dialog #wrapper #close-button:active{background-color:rgba(255,180,180,.8)}dwg-game-info-dialog #wrapper>#content{display:flex;flex-flow:column nowrap;margin-top:var(--button-size);padding:1em;overflow-y:auto}dwg-game-info-dialog #wrapper>#content>*{box-sizing:border-box;min-height:1em;padding:4px;width:100%}dwg-game-info-dialog #wrapper>#content .size-small{font-size:var(--font-size-small);line-height:var(--font-size-small)}dwg-game-info-dialog #wrapper>#content .size-medium{font-size:var(--font-size-medium);line-height:var(--font-size-medium)}dwg-game-info-dialog #wrapper>#content .size-large{font-size:var(--font-size-large);line-height:var(--font-size-large);margin-top:.6em}dwg-game-info-dialog #wrapper>#content .size-larger{font-size:var(--font-size-larger);line-height:var(--font-size-larger);margin:.8em 0}body.mobile dwg-game-history-dialog #wrapper{height:80svh}",""]);const r=s},3227:(e,t,o)=>{o.d(t,{A:()=>r});var i=o(1601),n=o.n(i),a=o(6314),s=o.n(a)()(n());s.push([e.id,"dwg-page-home{--margin-size: 16px;--height: calc(100vh - 2 * var(--margin-size));--width: calc(100% - 2 * var(--margin-size));background-color:#05285a;display:block;height:var(--height);max-height:var(--height);max-width:var(--width);min-height:var(--height);min-width:var(--width);padding:var(--margin-size);width:var(--width)}dwg-page-home #lobby,dwg-page-home #game{bottom:0;left:0;overflow:hidden;position:absolute;right:0;top:0}dwg-page-home #game:not(.show){display:none}dwg-page-home #lobby-connector{z-index:5}body.mobile dwg-page-home{--height: calc(100svh - 2 * var(--margin-size))}body.mobile dwg-page-home #lobby,body.mobile dwg-page-home #game{overflow-y:visible}",""]);const r=s},4161:(e,t,o)=>{o.d(t,{J:()=>_});var i=o(7447),n=o(5072),a=o.n(n),s=o(7825),r=o.n(s),l=o(7659),d=o.n(l),c=o(5056),m=o.n(c),g=o(540),h=o.n(g),u=o(1113),b=o.n(u),p=o(4605),v={};v.styleTagTransform=b(),v.setAttributes=m(),v.insert=d().bind(null,"head"),v.domAPI=r(),v.insertStyleElement=h(),a()(p.A,v),p.A&&p.A.locals&&p.A.locals;class _ extends HTMLElement{constructor(){super(...arguments),this.fully_parsed=!1,this.elsMetadata=[]}connectedCallback(){return e=this,t=void 0,n=function*(){this.classList.add("dwg-element"),this.innerHTML=this.htmlString,yield(0,i.TG)(this.elementsParsed.bind(this)),this.parsedCallback(),this.classList.add("parsed"),this.fully_parsed=!0},new((o=void 0)||(o=Promise))(function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function r(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(s,r)}l((n=n.apply(e,t||[])).next())});var e,t,o,n}elementsParsed(){let e=!0;for(const t of this.elsMetadata){let o=t.found_element?this[t.name]:null;t.found_element||(o=this.querySelector(`#${t.element_id}`),o&&(this[t.name]=o,t.found_element=!0)),t.found_element?o instanceof _&&(o.fully_parsed||(e=!1)):e=!1}return e}parsedCallback(){}configureElement(e,t){t||(t=e.replace(/_/g,"-")),this.elsMetadata.push({element_id:t,name:e})}configureElements(...e){for(const t of e)this.configureElement(t)}}},4196:(e,t,o)=>{o.d(t,{A:()=>r});var i=o(1601),n=o.n(i),a=o(6314),s=o.n(a)()(n());s.push([e.id,"dwg-players-dialog-player{display:flex;color:#fff;flex-flow:row nowrap;font-size:var(--font-size-large);gap:var(--font-size-small);height:var(--font-size-largest);line-height:var(--font-size-largest);overflow:hidden;user-select:none;width:100%}dwg-players-dialog-player>#ping{flex:0 0 calc(.8*var(--font-size-largest));padding:calc(.1*var(--font-size-largest));position:relative}dwg-players-dialog-player>#ping:not(:hover)>#ping-text{display:none}dwg-players-dialog-player>#ping>#ping-text{background-color:rgba(90,90,90,.9);bottom:calc(50% - .5*(var(--font-size-medium) + .6em));font-size:var(--font-size-medium);left:calc(100% + var(--font-size-small));line-height:var(--font-size-medium);padding:.3em;position:absolute;white-space:nowrap;z-index:2}dwg-players-dialog-player>#nickname{white-space:nowrap}dwg-players-dialog-player>#rejoin-link{background-color:rgba(0,0,0,0);border:none;border-radius:1em !important;color:#fff;display:block;font-size:var(--font-size-medium) !important;margin-left:auto;min-width:0;padding:0 1em !important;position:relative}dwg-players-dialog-player>#rejoin-link:hover{background-color:rgba(150,150,150,.2)}dwg-players-dialog-player>#rejoin-link:active{background-color:rgba(150,150,150,.4)}dwg-players-dialog-player>#rejoin-link:not(:hover)>#rejoin-link-image{display:none}dwg-players-dialog-player>#rejoin-link>#rejoin-link-text{overflow-x:hidden;text-overflow:ellipsis;white-space:nowrap}dwg-players-dialog-player>#rejoin-link>#rejoin-link-image{background-color:rgba(90,90,90,.9);height:calc(.6*var(--font-size-largest));position:absolute;right:calc(.2*var(--font-size-largest));top:calc(.2*var(--font-size-largest));width:calc(.6*var(--font-size-largest));z-index:2}",""]);const r=s},4385:e=>{e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),t.hash&&(e+=t.hash),t.maybeNeedQuotes&&/[\t\n\f\r "'=<>`]/.test(e)?'"'.concat(e,'"'):e):e}},4605:(e,t,o)=>{o.d(t,{A:()=>r});var i=o(1601),n=o.n(i),a=o(6314),s=o.n(a)()(n());s.push([e.id,".dwg-element:not(.parsed),.dwg-element.hide{display:none}.dwg-element.hidden{visibility:hidden}",""]);const r=s},4763:(e,t,o)=>{o.d(t,{A:()=>r});var i=o(1601),n=o.n(i),a=o(6314),s=o.n(a)()(n());s.push([e.id,"dwg-chatbox{--input-box-height: calc(2 * var(--font-size-medium));--gray-color: rgb(100, 100, 100);background-color:#c8c8c8;color:#000;display:block;height:100%;width:100%}dwg-chatbox #chat-container{display:flex;flex-flow:column nowrap;font-size:var(--font-size-small);height:calc(100% - var(--input-box-height));overflow-wrap:anywhere;overflow-y:scroll;width:100%;word-break:break-all}dwg-chatbox #chat-container :first-child{margin-top:auto}dwg-chatbox #chat-container>*{margin-top:.3em;transition:background-color 1s}dwg-chatbox #chat-container>*.new-message{background-color:rgba(255,255,0,.4);transition:none}dwg-chatbox #chat-container>*.color-gray{color:var(--gray-color)}dwg-chatbox #new-messages-container{height:0;position:relative;width:100%}dwg-chatbox #new-messages-container #new-messages-button{--width: max(130px, 20%);background-color:#6e8cff;bottom:0;border:0px;border-radius:1.6em;height:1.5em;left:calc(50% - .5*var(--width));margin:0;padding:0;position:absolute;width:var(--width)}dwg-chatbox #new-messages-container #new-messages-button:not(.show){display:none}dwg-chatbox #new-messages-container #new-messages-button:hover{background-color:#82a0ff}dwg-chatbox #new-messages-container #new-messages-button:active{background-color:#5a6ef0}dwg-chatbox #new-messages-container #new-messages-button #new-messages-number{font-weight:bold}dwg-chatbox #new-messages-container #new-messages-button.new-message{font-weight:bolder}dwg-chatbox #new-messages-container #new-messages-button.new-message #new-messages-number{font-weight:bolder}dwg-chatbox #input-container{--margin: 8px;--send-button-width: calc(2.2 * var(--input-box-height));display:flex;flex-flow:row nowrap;height:var(--input-box-height);width:100%}dwg-chatbox #input-container>*{box-sizing:border-box;height:calc(100% - var(--margin));margin-top:var(--margin)}dwg-chatbox #input-container #chat-input{font-size:var(--font-size-medium);flex:0 0 calc(100% - var(--send-button-width) - 2px);line-height:var(--input-box-height);padding-left:.5em}dwg-chatbox #input-container #send-chat{font-size:1rem;margin-left:auto;width:var(--send-button-width)}dwg-chatbox.transparent-fade{background-color:rgba(0,0,0,0);color:#fff}dwg-chatbox.transparent-fade #chat-container{background-color:rgba(80,80,80,.5);border-radius:1em;box-sizing:border-box;line-height:1.1em;padding:1em}dwg-chatbox.transparent-fade #chat-container>*{transition:background-color 1s}dwg-chatbox.transparent-fade #chat-container>*.new-message{background-color:rgba(70,70,70,.7);transition:none}dwg-chatbox.transparent-fade #input-container{background-color:rgba(0,0,0,0)}dwg-chatbox.transparent-fade #input-container #chat-input{background-color:rgba(90,90,90,.8);border:1px solid #fff;color:#fff}dwg-chatbox.transparent-fade #input-container #send-chat{background-color:red;color:#fff}dwg-chatbox.transparent-fade:not(.show){pointer-events:none}dwg-chatbox.transparent-fade:not(.show).new-message{color:#fff}dwg-chatbox.transparent-fade:not(.show):not(.new-message){color:rgba(0,0,0,0);transition:color 1.5s 2s}dwg-chatbox.transparent-fade:not(.show) #chat-container{background-color:rgba(0,0,0,0);scrollbar-width:none;transition:background-color 1s .1s}dwg-chatbox.transparent-fade:not(.show) #chat-container::-webkit-scrollbar{display:none}dwg-chatbox.transparent-fade:not(.show) #new-messages-container{display:none}dwg-chatbox.transparent-fade:not(.show) #input-container{display:none}",""]);const r=s},5056:(e,t,o)=>{e.exports=function(e){var t=o.nc;t&&e.setAttribute("nonce",t)}},5072:e=>{var t=[];function o(e){for(var o=-1,i=0;i<t.length;i++)if(t[i].identifier===e){o=i;break}return o}function i(e,i){for(var a={},s=[],r=0;r<e.length;r++){var l=e[r],d=i.base?l[0]+i.base:l[0],c=a[d]||0,m="".concat(d," ").concat(c);a[d]=c+1;var g=o(m),h={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==g)t[g].references++,t[g].updater(h);else{var u=n(h,i);i.byIndex=r,t.splice(r,0,{identifier:m,updater:u,references:1})}s.push(m)}return s}function n(e,t){var o=t.domAPI(t);return o.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;o.update(e=t)}else o.remove()}}e.exports=function(e,n){var a=i(e=e||[],n=n||{});return function(e){e=e||[];for(var s=0;s<a.length;s++){var r=o(a[s]);t[r].references--}for(var l=i(e,n),d=0;d<a.length;d++){var c=o(a[d]);0===t[c].references&&(t[c].updater(),t.splice(c,1))}a=l}}},5074:(e,t,o)=>{e.exports=o.p+"1276778824a946c8b04f.png"},5109:(e,t,o)=>{function i(e,t,o,i){return JSON.stringify({sender:e,kind:t,content:o,data:i})}function n(e){var t;return{client_id:parseInt(e.client_id),nickname:e.nickname,ping:parseInt(e.ping),room_id:null!==(t=parseInt(e.room_id))&&void 0!==t?t:void 0}}var a;function s(e){return{game_type:parseInt(e.game_type),max_players:parseInt(e.max_players),max_viewers:parseInt(e.max_viewers),game_specific_settings:e.game_specific_settings}}function r(e){return{room_id:parseInt(e.room_id),room_name:e.room_name,room_description:e.room_description,host:n(e.host),players:new Map(e.players.map(e=>{const t=n(e);return[t.client_id,t]})),viewers:new Map(e.viewers.map(e=>{const t=n(e);return[t.client_id,t]})),game_settings:s(e.game_settings),game_id:e.game_id?parseInt(e.game_id):void 0}}o.d(t,{LO:()=>n,T2:()=>s,VL:()=>r,ZF:()=>a,oH:()=>i}),function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.FIDDLESTICKS=1]="FIDDLESTICKS",e[e.EUCHRE=2]="EUCHRE",e[e.RISQ=3]="RISQ",e[e.TEST_GAME=4]="TEST_GAME"}(a||(a={}))},5161:(e,t,o)=>{o.d(t,{_:()=>ie});var i=o(4161),n=o(5109),a=o(1511),s=o(7447),r=o(2074),l=function(e,t,o,i){return new(o||(o=Promise))(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function r(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(s,r)}l((i=i.apply(e,t||[])).next())})};let d=0;let c=!1;var m=o(4385),g=o.n(m),h=new URL(o(6352),o.b),u=new URL(o(1393),o.b),b=new URL(o(7555),o.b),p=new URL(o(3142),o.b),v=new URL(o(2500),o.b),_=new URL(o(2200),o.b),y=new URL(o(5074),o.b);const f='<div id="header"> <div id="client-name"> <span id="client-name-string"></span> <span id="client-ping"></span> </div> <div id="room-name"></div> <div id="game-name"></div> <div id="button-container"> <button id="button-game-info"> <img src="'+g()(h)+'" alt="rename" draggable="false"> </button> <button id="button-game-history"> <img src="'+g()(u)+'" alt="rename" draggable="false"> </button> <button id="button-room-players"> <img src="'+g()(b)+'" alt="players" draggable="false"> </button> <button id="button-fullscreen"> <img id="maximize-img" src="'+g()(p)+'" alt="fullscreen" draggable="false"> <img id="minimize-img" src="'+g()(v)+'" alt="fullscreen" draggable="false"> </button> <button id="button-exit"> <img src="'+g()(_)+'" alt="close" draggable="false"> </button> </div> </div> <div id="waiting-room"> <div id="players-waiting"></div> </div> <div id="game-container"></div> <div id="chatbox-container"> <dwg-chatbox id="chatbox" class="transparent-fade"></dwg-chatbox> <button id="open-chatbox-button"> <img src="'+g()(y)+'" alt="chat" draggable="false"> </button> </div>';var w=o(5072),x=o.n(w),k=o(7825),E=o.n(k),L=o(7659),z=o.n(L),A=o(5056),C=o.n(A),S=o(540),R=o.n(S),T=o(1113),M=o.n(T),I=o(2453),P={};P.styleTagTransform=M(),P.setAttributes=C(),P.insert=z().bind(null,"head"),P.domAPI=E(),P.insertStyleElement=R(),x()(I.A,P),I.A&&I.A.locals&&I.A.locals;var U=o(1981),$=new URL(o(2200),o.b);const j='<div id="wrapper"> <button id="close-button"> <img src="'+g()($)+'" alt="close" draggable="false"> </button> <div id="updates-container"></div> </div>';var D=o(346),N={};N.styleTagTransform=M(),N.setAttributes=C(),N.insert=z().bind(null,"head"),N.domAPI=E(),N.insertStyleElement=R(),x()(D.A,N),D.A&&D.A.locals&&D.A.locals;class H extends U.U{constructor(){super(),this.configureElement("close_button"),this.configureElement("updates_container")}getHTML(){return j}getData(){return this.data}setData(e,t){if(this.data=e,!t&&!this.fully_parsed)return;const o=[...e.updates.values()].sort((e,t)=>t.update_id-e.update_id);for(const t of o){const o=e.game.updateDialogComponent(t);o.classList.add("update"),this.updates_container.appendChild(o)}this.close_button.addEventListener("click",()=>{this.closeDialog()})}}customElements.define("dwg-game-history-dialog",H);var G=new URL(o(2200),o.b);const O='<div id="wrapper"> <button id="close-button"> <img src="'+g()(G)+'" alt="close" draggable="false"> </button> <div id="content"> <div id="room-title" class="size-larger"></div> <div id="game-title" class="size-medium"></div> <div id="num-players" class="size-medium"> Players: <span id="num-players-current"></span>/<span id="num-players-max"></span> </div> <div id="settings-label" class="size-large">Settings:</div> <div id="game-specific-settings"></div> <div id="description-label" class="size-large">Description:</div> <div id="room-description" class="size-small"></div> </div> </div> ';var F=o(3192),J={};J.styleTagTransform=M(),J.setAttributes=C(),J.insert=z().bind(null,"head"),J.domAPI=E(),J.insertStyleElement=R(),x()(F.A,J),F.A&&F.A.locals&&F.A.locals;class B extends U.U{constructor(){super(),this.configureElement("close_button"),this.configureElement("room_title"),this.configureElement("game_title"),this.configureElement("num_players_current"),this.configureElement("num_players_max"),this.configureElement("game_specific_settings"),this.configureElement("room_description")}getHTML(){return O}getData(){return this.data}setData(e,t){var o,i;if(this.data=e,t||this.fully_parsed){if(this.close_button.addEventListener("click",()=>{this.closeDialog()}),this.room_title.innerText=this.data.room.room_name,this.game_title.innerText=null!==(i=n.ZF[null!==(o=this.data.room.game_settings.game_type)&&void 0!==o?o:-1])&&void 0!==i?i:"",this.num_players_current.innerText=this.data.game.players.length.toString(),this.num_players_max.innerText=this.data.room.game_settings.max_players.toString(),this.data.room.game_settings.game_specific_settings){const e=[];for(const[t,o]of Object.entries(this.data.room.game_settings.game_specific_settings)){const i=document.createElement("div");i.classList.add("setting"),i.classList.add("settings-small"),i.id=`setting-${t}`,i.innerText=`${(0,s.ZH)(t.replace("_"," "))}: ${o}`,e.push(i)}this.game_specific_settings.replaceChildren(...e)}else this.game_specific_settings.replaceChildren();this.room_description.innerText=this.data.room.room_description}}}customElements.define("dwg-game-info-dialog",B);var Z=new URL(o(2200),o.b);const V='<div id="wrapper"> <button id="close-button"> <img src="'+g()(Z)+'" alt="close" draggable="false"> </button> <div id="players-container"></div> </div>';var W=o(218),K={};K.styleTagTransform=M(),K.setAttributes=C(),K.insert=z().bind(null,"head"),K.domAPI=E(),K.insertStyleElement=R(),x()(W.A,K),W.A&&W.A.locals&&W.A.locals;var q=new URL(o(5414),o.b);const Y=' <div id="ping"> <img id="ping-image" class="max-size" draggable="false"> <div id="ping-text"></div> </div> <div id="nickname"></div> <button id="rejoin-link"> <div id="rejoin-link-text">Copy Rejoin Link</div> <img id="rejoin-link-image" src="'+g()(q)+'" alt="copy" draggable="false"> </button>';var X=o(4196),Q={};Q.styleTagTransform=M(),Q.setAttributes=C(),Q.insert=z().bind(null,"head"),Q.domAPI=E(),Q.insertStyleElement=R(),x()(X.A,Q),X.A&&X.A.locals&&X.A.locals;class ee extends i.J{constructor(){super(),this.htmlString=Y,this.configureElement("ping_text"),this.configureElement("ping_image"),this.configureElement("nickname"),this.configureElement("rejoin_link"),this.configureElement("rejoin_link_text")}parsedCallback(){this.player?(this.lobby_player&&this.player.connected?(this.ping_text.innerText=`${Math.round(this.lobby_player.ping)} ms`,this.lobby_player.ping<100?this.ping_image.src="/images/icons/ping_good24.png":this.lobby_player.ping<300?this.ping_image.src="/images/icons/ping_ok24.png":this.lobby_player.ping<1e3?this.ping_image.src="/images/icons/ping_bad24.png":this.ping_image.src="/images/icons/ping_empty24.png"):(this.ping_image.src="/images/icons/ping_disconnected24.png",this.ping_text.innerText="Disconnected"),this.nickname.innerText=this.player.nickname,this.rejoin_url=`${window.location.origin}${window.location.pathname}?room_id=${this.room_id}&client_id=${this.player.client_id}`,this.rejoin_link.addEventListener("click",()=>{return e=this,t=void 0,i=function*(){(yield(0,s.lW)(this.rejoin_url))?(this.rejoin_link_text.innerText="Copied!",this.copy_timeout&&clearTimeout(this.copy_timeout),this.copy_timeout=setTimeout(()=>{this.rejoin_link_text.innerText="Copy Again"},1500)):(this.rejoin_link_text.innerText="Failed to Copy",this.copy_timeout&&clearTimeout(this.copy_timeout),this.copy_timeout=setTimeout(()=>{this.rejoin_link_text.innerText=this.rejoin_url},1500))},new((o=void 0)||(o=Promise))(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function r(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(s,r)}l((i=i.apply(e,t||[])).next())});var e,t,o,i})):console.error("Must set player before attaching to dom")}setData(e,t,o){this.player=e,this.lobby_player=t,this.room_id=o}}customElements.define("dwg-players-dialog-player",ee);class te extends U.U{constructor(){super(),this.configureElement("close_button"),this.configureElement("players_container")}getHTML(){return V}getData(){return this.data}setData(e,t){if(this.data=e,t||this.fully_parsed){for(const e of this.data.players){const t=this.data.lobby_players.get(e.client_id),o=document.createElement("dwg-players-dialog-player");o.id=`player-${e.player_id}`,o.classList.add("player"),o.setData(e,t,this.data.room_id),this.players_container.appendChild(o)}this.close_button.addEventListener("click",()=>{this.closeDialog()})}}}customElements.define("dwg-players-dialog",te),o(8498),o(1876);var oe=function(e,t,o,i){return new(o||(o=Promise))(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function r(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(s,r)}l((i=i.apply(e,t||[])).next())})};function ie(e){this.dispatchEvent(new CustomEvent("show_message_dialog",{detail:e,bubbles:!0}))}class ne extends i.J{constructor(){super(),this.players_waiting_els=new Map,this.bundles_attached=new Set,this.abort_controllers=[],this.game_id=0,this.player_id=-1,this.is_player=!1,this.chatbox_lock=(0,s.cs)(),this.htmlString=f,this.configureElement("client_name_string"),this.configureElement("client_ping"),this.configureElement("room_name"),this.configureElement("game_name"),this.configureElement("waiting_room"),this.configureElement("players_waiting"),this.configureElement("game_container"),this.configureElement("chatbox_container"),this.configureElement("chatbox"),this.configureElement("open_chatbox_button"),this.configureElement("button_game_info"),this.configureElement("button_game_history"),this.configureElement("button_room_players"),this.configureElement("button_fullscreen"),this.configureElement("maximize_img"),this.configureElement("minimize_img"),this.configureElement("button_exit")}isPlayer(){return this.is_player}playerId(){return this.player_id}getPlayers(){var e,t;return null===(t=null===(e=this.game)||void 0===e?void 0:e.game_base)||void 0===t?void 0:t.players}getViewers(){var e,t;return null===(t=null===(e=this.game)||void 0===e?void 0:e.game_base)||void 0===t?void 0:t.viewers}addChat(e,t=!1){this.chatbox.addChat(e,t)}getLaunched(){return this.launched}getGameEl(){return this.game_el}getSocket(){return this.socket}getConnectionMetadata(){return this.connection_metadata}getGame(){return this.game}parsedCallback(){this.minimize_img.classList.add("hide"),document.addEventListener("keyup",e=>{"Enter"===e.key&&this.toggleChatbox()}),this.chatbox.style.setProperty("--gray-color","rgba(220, 220, 220, 0.9)"),this.chatbox.addEventListener("chat_sent",e=>{var t,o,i;if(!this.socketActive())return void console.error("Trying to send chat with invalid socket");const a=e.detail;a.message.startsWith("\\s")?this.setSetting(a.message.slice(2).trim()):a.message.startsWith("\\l")?(a.message=a.message.slice(2).trim(),this.socketSend((0,n.oH)(null!==(t=a.sender)&&void 0!==t?t:`client-${this.connection_metadata.client_id}`,"lobby-chat",a.message,a.color))):a.message.startsWith("\\u")?a.message=a.message.slice(2).trim():a.message.startsWith("\\r")?(a.message=a.message.slice(2).trim(),this.socketSend((0,n.oH)(null!==(o=a.sender)&&void 0!==o?o:`room-${this.connection_metadata.room_id}-${this.connection_metadata.client_id}`,"room-chat",a.message,a.color))):(a.message.startsWith("\\g")&&(a.message=a.message.slice(2).trim()),this.socketSend((0,n.oH)(null!==(i=a.sender)&&void 0!==i?i:`game-${this.connection_metadata.client_id}`,"game-chat",a.message,a.color)))}),this.open_chatbox_button.addEventListener("click",()=>{this.toggleChatbox()}),this.button_game_info.addEventListener("click",()=>{const e=document.createElement("dwg-game-info-dialog");e.setData({game:this.game,room:this.lobby_room}),this.appendChild(e)}),this.button_game_history.addEventListener("click",()=>{var e;if(!this.launched)return;const t=document.createElement("dwg-game-history-dialog");t.setData({game:this.game_el,updates:null!==(e=this.game.game_base.updates)&&void 0!==e?e:new Map}),this.appendChild(t)}),this.button_room_players.addEventListener("click",()=>{const e=document.createElement("dwg-players-dialog");e.setData({players:[...this.game.game_base.players.values()].sort((e,t)=>e.player_id-t.player_id),lobby_players:this.lobby_room.players,room_id:this.lobby_room.room_id}),this.appendChild(e)}),this.button_fullscreen.addEventListener("click",()=>{document.fullscreenElement?(document.exitFullscreen(),this.maximize_img.classList.remove("hide"),this.minimize_img.classList.add("hide")):(this.requestFullscreen(),this.maximize_img.classList.add("hide"),this.minimize_img.classList.remove("hide"))}),this.button_exit.addEventListener("click",()=>{const e=document.createElement("dwg-confirm-dialog");e.setData({question:"Are you sure you want to exit?"}),e.addEventListener("confirmed",()=>{this.dispatchEvent(new Event("exit_game"))}),this.appendChild(e)})}toggleChatbox(){this.chatbox_lock(()=>oe(this,void 0,void 0,function*(){this.chatbox_container.classList.toggle("showing"),this.chatbox.classList.toggle("show"),this.chatbox.classList.contains("show")&&this.chatbox.focus()}))}setPadding(e){this.game_container.style.setProperty("--padding",e)}setSetting(e){if("help"===e)return void this.chatbox.addChat({message:"There are no commands; this feature is not yet implemented",color:"gray"},!0);const t=e.split("=",2).map(e=>e.trim());2===t.length&&(t[0],this.chatbox.addChat({message:`Unrecognized setting key "${t[0]}", try "help" to see a list of commands`,color:"gray"},!0))}refreshRoom(e){var t,o;if(!e||!e.game_id||!(null===(t=this.connection_metadata)||void 0===t?void 0:t.room_id)||e.room_id!==(null===(o=this.connection_metadata)||void 0===o?void 0:o.room_id))return console.error("Invalid game state"),void this.exitGame();this.lobby_room=e,this.room_name.innerText=e.room_name,this.game_id=e.game_id,this.is_player=e.players.has(this.connection_metadata.client_id)}launchGame(e,t,o){return oe(this,arguments,void 0,function*(e,t,o,i=!1){if((!this.launched||i)&&e&&e.game_id&&t&&t.readyState===WebSocket.OPEN&&o&&o.client_id&&o.room_id&&e.room_id===o.room_id){this.socket=t,this.connection_metadata=o,this.refreshRoom(e),this.client_name_string.innerText=this.connection_metadata.nickname,this.client_ping.innerText=` (${this.connection_metadata.ping})`;try{for(const e of this.abort_controllers)e.abort();const e=new AbortController;return this.abort_controllers.push(e),this.socket.addEventListener("message",e=>{try{!function(e,t){var o,i,a,s,r,m;if(!e.socketActive())return;if(m=t.kind,["game","ping"].every(e=>!m.startsWith(`${e}-`)))return;let g=!1;switch("ping-update"!==t.kind&&console.log("Game message:",t),t.kind){case"ping-update":return;case"game-chat":const d=parseInt((null!==(o=t.sender)&&void 0!==o?o:"").replace("game-",""));if(d){const o=null!==(a=null===(i=e.getPlayers())||void 0===i?void 0:i.get(d))&&void 0!==a?a:null===(s=e.getViewers())||void 0===s?void 0:s.get(d);e.addChat({message:t.content,sender:null!==(r=null==o?void 0:o.nickname)&&void 0!==r?r:d.toString()})}break;case"game-player-disconnected":const m=parseInt(t.data);m&&e.playerDisconnected(m);break;case"game-player-connected":const h=parseInt(t.data);h&&e.playerConnected(h);break;case"game-start":e.startGame();break;case"game-update":!function(e,t){l(this,void 0,void 0,function*(){var o;if(!e.getGameEl()||!e.getGame)return;const i=t.sender.split("-");if(i.length<3)return;const a=parseInt(i[2]);if(!a)return;const s=e.getGame().game_base;try{const i={update_id:a,kind:t.data,content:JSON.parse(t.content)};console.log(`received game update ${a}: ${JSON.stringify(i)}`),s.updates.set(a,i),s.highest_received_update_id=Math.max(null!==(o=s.highest_received_update_id)&&void 0!==o?o:0,a),!c&&s.game_started&&!s.game_ended&&e.getLaunched()&&function(t){l(this,void 0,void 0,function*(){if(c=!0,t.update_id-1===s.last_applied_update_id)for(s.last_applied_update_id=t.update_id,console.log(`applying update id ${t.update_id}`),yield e.getGameEl().gameUpdate(t);;){const t=s.updates.get(s.last_applied_update_id+1);if(!t)break;s.last_applied_update_id=t.update_id,console.log(`applying update id ${t.update_id}`),yield e.getGameEl().gameUpdate(t)}else t.update_id-1>s.last_applied_update_id&&e.getSocket().send((0,n.oH)(`client-${e.getConnectionMetadata().client_id}`,"game-get-update","",`${s.last_applied_update_id+1}`));s.highest_received_update_id>s.last_applied_update_id&&e.getSocket().send((0,n.oH)(`client-${e.getConnectionMetadata().client_id}`,"game-get-update","",`${s.last_applied_update_id+1}`)),c=!1})}(i)}catch(t){console.log(t),e.getSocket().send((0,n.oH)(`client-${e.getConnectionMetadata().client_id}`,"game-get-update","",`${a}`))}})}(e,t);break;case"game-failed-update":case"game-connected-failed":break;case"game-get-update-failed":case"game-resend-last-update-failed":case"game-resend-waiting-room-failed":case"game-update-failed":g=!0,console.log(t.content);try{e.refreshGame()}catch(e){console.log(e)}break;default:g=!0,console.log("Unknown message type",t.kind,"from",t.sender)}g?(d++,d>=3&&e.dispatchEvent(new CustomEvent("connection_lost",{detail:"An error was encountered; please refresh your connection."}))):d=0}(this,JSON.parse(e.data))}catch(t){console.log("Error parsing message: ",e,t)}},{signal:e.signal}),yield this.refreshGame()}catch(e){console.log(e)}return!1}console.log("Invalid state to launch game")})}socketActive(){return!!this.socket&&this.socket.readyState==WebSocket.OPEN}socketSend(e){var t;this.socketActive()&&(null===(t=this.socket)||void 0===t||t.send(e))}clientId(){var e;return(null===(e=this.connection_metadata)||void 0===e?void 0:e.client_id)?this.connection_metadata.client_id:-1}refreshGame(){return oe(this,void 0,void 0,function*(){const e=yield(0,a.$P)(`lobby/games/get/${this.game_id}`,{client_id:this.clientId(),viewer:this.is_player?"false":"true"});if(!e.success||!e.result)return console.log(e.error_message),!1;this.game=function(e,t){var o,i;const n=new Map(e.game_base.players.map(e=>[e.client_id,e])),a=new Map(e.game_base.viewers.map(e=>[e.client_id,e])),s=Object.assign(Object.assign({},e),{game_base:{game_id:e.game_base.game_id,game_type:e.game_base.game_type,game_started:e.game_base.game_started,game_ended:e.game_base.game_ended,players:n,viewers:a,player_actions:e.game_base.player_actions?new Map(e.game_base.player_actions.map(e=>[e.action_id,e])):void 0}}),r=null!==(i=null===(o=n.get(t))||void 0===o?void 0:o.updates)&&void 0!==i?i:e.game_base.viewer_updates;return void 0!==r&&(s.game_base.updates=new Map(r.map(e=>[e.update_id,e])),s.game_base.last_applied_update_id=r.length,s.game_base.highest_received_update_id=Math.max(...r.map(e=>e.update_id))),s}(e.result,this.clientId());let t=!1,o=!1;const i=e=>oe(this,void 0,void 0,function*(){if(!this.bundles_attached.has(e)){const t=document.createElement("script");t.setAttribute("src",`/dist/${e.replace("dwg-","").replace("-","_")}.bundle.js?v=${(0,r.P3)("v")}`),t.async=!1;let o=!1;t.addEventListener("load",()=>{o=!0}),document.body.appendChild(t),yield(0,s.TG)(()=>o),this.bundles_attached.add(e)}const i=document.createElement(e);this.game_container.replaceChildren(i),yield(0,s.TG)(()=>i.fully_parsed),this.game_el=i,this.player_id=-1,this.is_player=!1;for(const[e,t]of this.game.players.entries())if(t.player.client_id===this.clientId()){this.player_id=e,this.is_player=!0;break}this.game_el.initialize(this,this.game).then(()=>{t=!0,o&&(this.socketSend((0,n.oH)(`client-${this.clientId()}`,"game-connected","",this.game_id.toString())),this.launched=!0)}),i.addEventListener("game_update",e=>{this.game.game_base.game_ended?console.log("Game already over"):(console.log("Sending game update",e.detail),this.socketSend(e.detail))})});switch(this.game.game_base.game_type){case n.ZF.FIDDLESTICKS:yield i("dwg-fiddlesticks");break;case n.ZF.EUCHRE:yield i("dwg-euchre");break;case n.ZF.RISQ:yield i("dwg-risq");break;case n.ZF.TEST_GAME:yield i("dwg-test-game");break;case n.ZF.UNSPECIFIED:default:throw new Error(`Unknown game type: ${this.game.game_base.game_type}`)}if(this.game_name.innerText=(0,s.ZH)(n.ZF[this.game.game_base.game_type].toLowerCase().replace("_"," ")),this.game.game_base.game_started)this.startGame();else{this.waiting_room.classList.remove("hide"),this.game_container.classList.remove("show"),this.players_waiting_els.clear(),this.players_waiting.replaceChildren();for(const[e,t]of this.game.game_base.players){const o=document.createElement("div"),i=document.createElement("div"),n=document.createElement("div");o.appendChild(i),o.appendChild(n),o.classList.add("player-waiting"),i.innerText=t.nickname,n.innerText=t.connected?"Connected":"Connecting ...",t.connected&&n.classList.add("connected"),this.players_waiting_els.set(e,n),this.players_waiting.appendChild(o)}}return this.classList.add("show"),o=!0,!!t&&(this.socketSend((0,n.oH)(`client-${this.clientId()}`,"game-connected","",this.game_id.toString())),this.ping_interval=setInterval(()=>{this.launched&&this.pingServer()},3500),this.launched=!0,!0)})}playerDisconnected(e){var t;const o=this.players_waiting_els.get(e);o&&(o.innerText="Connecting ...",o.classList.remove("connected"));const i=null===(t=this.getPlayers())||void 0===t?void 0:t.get(e);i&&(i.connected=!1)}playerConnected(e){var t;const o=this.players_waiting_els.get(e);o&&(o.innerText="Connected",o.classList.add("connected"));const i=null===(t=this.getPlayers())||void 0===t?void 0:t.get(e);i&&(i.connected=!0)}startGame(){this.game&&(this.game.game_base.game_started=!0,this.waiting_room.classList.add("hide"),this.game_container.classList.add("show"))}exitGame(){this.launched=!1,this.classList.remove("show"),this.socketSend((0,n.oH)(`client-${this.clientId()}`,"game-exit")),this.socket=void 0,this.connection_metadata=void 0,this.lobby_room=void 0,this.game_id=0,this.game=void 0,clearInterval(this.ping_interval)}pingServer(){var e,t,o,i;this.socketActive()?(null===(t=null===(e=this.game)||void 0===e?void 0:e.game_base)||void 0===t?void 0:t.game_ended)||((null===(i=null===(o=this.game)||void 0===o?void 0:o.game_base)||void 0===i?void 0:i.game_started)?this.socketSend((0,n.oH)(`client-${this.clientId()}`,"game-resend-last-update")):this.socketSend((0,n.oH)(`client-${this.clientId()}`,"game-resend-waiting-room"))):this.dispatchEvent(new CustomEvent("connection_lost",{detail:"Lost connection in game"}))}}customElements.get("dwg-game")||customElements.define("dwg-game",ne)},5279:(e,t,o)=>{o.d(t,{A:()=>r});var i=o(1601),n=o.n(i),a=o(6314),s=o.n(a)()(n());s.push([e.id,"dwg-room-user{--user-height: calc(var(--height) - 2px);display:block;font-size:calc(var(--font-size) - 1px);height:var(--user-height);line-height:var(--user-height);padding:.15em .3em;position:relative;user-select:none}dwg-room-user:hover{background-color:hsla(0,0%,100%,.2)}dwg-room-user:hover>#buttons{display:flex}dwg-room-user>#ping{height:calc(.8*var(--user-height));left:.3em;position:absolute;top:calc(.1*var(--user-height) + .15em);width:calc(.8*var(--user-height))}dwg-room-user>#ping:hover>#ping-text{display:block}dwg-room-user>#ping>#ping-text{background-color:rgba(90,90,90,.6);bottom:100%;border-radius:.3em;display:none;font-size:var(--font-size-medium);line-height:var(--font-size-medium);padding:.3em;position:absolute;white-space:nowrap}dwg-room-user>#user-name{margin-left:calc(.8*var(--user-height) + .5em)}dwg-room-user>#buttons{align-items:center;bottom:0;display:none;flex-flow:row nowrap;gap:4px;position:absolute;right:4px;top:0}dwg-room-user>#buttons>button{align-items:center;background-color:rgba(220,220,220,.5);border:none;border-radius:4px;display:inline-flex;height:var(--user-height);justify-content:center;margin:0px;padding:0px;width:var(--user-height)}dwg-room-user>#buttons>button:hover{background-color:rgba(250,250,250,.6)}dwg-room-user>#buttons>button:active{background-color:hsla(0,0%,100%,.7)}dwg-room-user>#buttons>button>img{--size: min(18px, 80%);height:var(--size);width:var(--size)}",""]);const r=s},5308:(e,t,o)=>{o.d(t,{A:()=>r});var i=o(1601),n=o.n(i),a=o(6314),s=o.n(a)()(n());s.push([e.id,"dwg-message-dialog #wrapper{align-items:center;display:flex;flex-flow:column nowrap;height:35vh;gap:1em;max-height:400px;max-width:500px;min-height:220px;min-width:220px;width:35vw}dwg-message-dialog #wrapper>#ok-button{color:#000;margin-top:auto;padding:.3em .6em}body.mobile dwg-message-dialog #wrapper{height:50svh;width:50vw}",""]);const r=s},5366:(e,t,o)=>{o.d(t,{A:()=>r});var i=o(1601),n=o.n(i),a=o(6314),s=o.n(a)()(n());s.push([e.id,"dwg-lobby-room{background-color:#5ab4fa;box-shadow:0px 0px 3px 4px rgba(70,140,210,.8),0px 0px 6px 8px rgba(50,100,170,.8),0px 0px 9px 12px rgba(30,60,130,.8);display:flex;flex-flow:column nowrap;gap:8px}dwg-lobby-room:not(.show){display:none}dwg-lobby-room #room-header{--font-size-header: min(28px, var(--font-size-large));--header-height: calc(1.6 * var(--font-size-header));background-color:#3c78d2;display:flex;flex-flow:row nowrap;height:var(--header-height);width:100%}dwg-lobby-room #room-header #room-name{flex:1 0 0;font-size:var(--font-size-header);height:100%;line-height:var(--header-height);padding-left:.35em}dwg-lobby-room #room-header #room-name:not(.show){display:none}dwg-lobby-room #room-header #rename-input{box-sizing:border-box;flex:1 0 0;font-size:var(--font-size-header);height:100%;line-height:var(--header-height);min-width:0px;padding-left:.35em}dwg-lobby-room #room-header #rename-input:not(.show){display:none}dwg-lobby-room #room-header #rename-room:not(.show){display:none}dwg-lobby-room #room-header #cancel-rename{font-size:var(--font-size-medium);width:calc(4*var(--font-size-medium))}dwg-lobby-room #room-header #cancel-rename:not(.show){display:none}dwg-lobby-room #room-header>button{background-color:rgba(0,0,0,0);border:none;border-radius:6px;height:100%;margin:0px;padding:0px;width:var(--header-height)}dwg-lobby-room #room-header>button:hover{background-color:rgba(220,220,220,.5)}dwg-lobby-room #room-header>button:active{background-color:rgba(220,220,220,.8)}dwg-lobby-room #room-header>button>img{--img-height: min(32px, 0.8 * var(--header-height));height:var(--img-height);width:var(--img-height)}dwg-lobby-room>#room-body{display:flex;flex-flow:row nowrap;flex:1 0 0;min-height:0px;width:100%}dwg-lobby-room>#room-body>#left-panel{--width: min(320px, calc(100% - 300px));background-color:#1e5ab4;display:flex;flex-flow:column nowrap;flex:0 0 var(--width);height:100%;max-width:var(--width);min-width:var(--width);width:var(--width)}dwg-lobby-room>#room-body>#left-panel>#game-settings{box-sizing:border-box;flex:3 0 0;height:100%;overflow-y:auto;padding:8px 12px 0px;width:100%}dwg-lobby-room>#room-body>#left-panel>#game-settings>*{box-sizing:border-box;min-height:1em;padding:4px;width:100%}dwg-lobby-room>#room-body>#left-panel>#game-settings .settings-small{font-size:var(--font-size-smaller);line-height:var(--font-size-smaller)}dwg-lobby-room>#room-body>#left-panel>#game-settings .settings-medium{font-size:var(--font-size-small);line-height:var(--font-size-small)}dwg-lobby-room>#room-body>#left-panel>#game-settings .settings-large{font-size:var(--font-size-medium);line-height:var(--font-size-medium);margin-top:.6em}dwg-lobby-room>#room-body>#left-panel>#game-settings>.button-container{display:flex;flex-flow:row nowrap;gap:.5em;margin-bottom:.5em}dwg-lobby-room>#room-body>#left-panel>#game-settings>.button-container.hide{display:none}dwg-lobby-room>#room-body>#left-panel>#game-settings>.button-container>button{font-size:18px;line-height:18px;height:30px;width:90px}dwg-lobby-room>#room-body>#left-panel>#game-settings>#settings-button-container>#settings-settings-button{background:linear-gradient(0deg, rgb(140, 140, 140), rgb(220, 220, 220));margin-left:auto}dwg-lobby-room>#room-body>#left-panel>#game-settings>#settings-button-container>#settings-launch-button{background:linear-gradient(0deg, rgb(40, 150, 40), rgb(80, 250, 80));margin-right:auto}dwg-lobby-room>#room-body>#left-panel>#game-settings>#settings-button-container>#settings-launch-button.launching{background:linear-gradient(0deg, rgb(50, 120, 50), rgb(100, 200, 100))}dwg-lobby-room>#room-body>#left-panel>#game-settings>#lobby-game-settings{z-index:2}dwg-lobby-room>#room-body>#left-panel>#game-settings>#game-button-container>#game-resign-button{background:linear-gradient(0deg, rgb(200, 25, 25), rgb(230, 60, 60));margin-left:auto}dwg-lobby-room>#room-body>#left-panel>#game-settings>#game-button-container>#game-rejoin-button{background:linear-gradient(0deg, rgb(180, 180, 35), rgb(210, 210, 60));margin-right:auto}dwg-lobby-room>#room-body>#left-panel>#game-settings>#settings-settings{display:flex;flex-flow:column nowrap;gap:.3em}dwg-lobby-room>#room-body>#left-panel>#user-list{--height: calc(1.5 * var(--font-size-medium));--font-size: var(--font-size-medium);background-color:rgba(220,220,220,.3);display:flex;flex-flow:column nowrap;flex:2 0 0}dwg-lobby-room>#room-body>#left-panel>#user-list .container-label{background-color:rgba(220,220,220,.4);font-size:var(--font-size);height:var(--height);line-height:var(--height);margin-bottom:2px;margin-top:.3em;padding:.2em .6em .1em}dwg-lobby-room>#room-body>#chatbox{box-sizing:border-box;flex:1 0 0;min-width:0px;padding:8px}dwg-lobby-room #kick-img,dwg-lobby-room #promote-img,dwg-lobby-room #viewer-img,dwg-lobby-room #player-img{display:none}body.mobile dwg-lobby-room>#room-body{flex-direction:column}body.mobile dwg-lobby-room>#room-body>#left-panel{--width: 100%;flex-direction:row;flex:0 0 320px}body.mobile dwg-lobby-room>#room-body>#left-panel>#game-settings{flex:1 1 0;padding:6px}body.mobile dwg-lobby-room>#room-body>#left-panel>#game-settings>.button-container{display:flex;flex-flow:row nowrap}body.mobile dwg-lobby-room>#room-body>#left-panel>#game-settings>.button-container.hide{display:none}body.mobile dwg-lobby-room>#room-body>#left-panel>#game-settings>.button-container>button{font-size:var(--font-size-smaller);line-height:var(--font-size-smaller);height:calc(2*var(--font-size-smaller))}body.mobile dwg-lobby-room>#room-body>#left-panel>#user-list{--height: calc(1.2 * var(--font-size-medium));--font-size: calc(var(--font-size-medium) - 2px);flex:1 1 0}body.mobile dwg-lobby-room>#room-body>#left-panel>#user-list .room-user>button{visibility:visible}body.mobile dwg-lobby-room>#room-body #chatbox{min-height:0px}",""]);const r=s},5414:(e,t,o)=>{e.exports=o.p+"263c69b598a2eef8b48f.png"},6224:(e,t,o)=>{e.exports=o.p+"9aed7eea9556ad2fc6b8.png"},6314:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var o="",i=void 0!==t[5];return t[4]&&(o+="@supports (".concat(t[4],") {")),t[2]&&(o+="@media ".concat(t[2]," {")),i&&(o+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),o+=e(t),i&&(o+="}"),t[2]&&(o+="}"),t[4]&&(o+="}"),o}).join("")},t.i=function(e,o,i,n,a){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(i)for(var r=0;r<this.length;r++){var l=this[r][0];null!=l&&(s[l]=!0)}for(var d=0;d<e.length;d++){var c=[].concat(e[d]);i&&s[c[0]]||(void 0!==a&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=a),o&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=o):c[2]=o),n&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=n):c[4]="".concat(n)),t.push(c))}},t}},6352:(e,t,o)=>{e.exports=o.p+"eed002a0917ccbac02e6.png"},7447:(e,t,o)=>{o.d(t,{Bd:()=>c,CW:()=>m,G0:()=>l,IJ:()=>n,RA:()=>d,TG:()=>a,U1:()=>s,ZH:()=>r,cs:()=>h,gs:()=>g,lO:()=>u,lW:()=>b});var i=function(e,t,o,i){return new(o||(o=Promise))(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function r(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(s,r)}l((i=i.apply(e,t||[])).next())})};const n=!1;function a(e,t=300){const o=i=>{e()?i():setTimeout(()=>o(i),t)};return new Promise(o)}function s(e){return i(this,void 0,void 0,function*(){yield new Promise(t=>setTimeout(t,e))})}function r(e,t=" "){return e.trim().split(t).map(e=>{const t=e.toLowerCase();return e.charAt(0).toUpperCase()+t.slice(1)}).join(" ")}function l(e){return e[Math.floor(Math.random()*e.length)]}function d(e){return e.replace(/(\r\n|\n|\r)(\s*)/gm,"")}function c(e,t,o={}){const i=Object.assign({loading_text:void 0,disable_button:!0,re_enable_button:!0},o);e.addEventListener("click",()=>{function o(t,o){"string"==typeof t&&(e.innerText=t),o&&(e.disabled=!1)}i.disable_button&&(e.disabled=!0),e.innerText,o(i.loading_text);const n=t();n instanceof Promise?n.then(e=>{o(e,i.re_enable_button)}):o(n,i.re_enable_button)})}function m(e){return Object.keys(e).filter(e=>Number.isNaN(parseInt(e)))}function g(e,t,o,i=()=>{}){let n=0;const a=setInterval(()=>{n++,n>o?(clearInterval(a),i()):e(n)},t);return a}function h(e=!1){let t=!1;const o=[];return n=>{let a,s;const r=new Promise((e,t)=>{a=e,s=t}),l=()=>i(this,void 0,void 0,function*(){yield n().then(a,s);const e=o.shift();e?yield e():t=!1});return t?e||o.push(l):(t=!0,l()),r}}function u(){return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substring(0,4))}function b(e){return i(this,void 0,void 0,function*(){const t=()=>{const t=document.createElement("textarea");t.value=e,t.style.top="0",t.style.left="0",t.style.position="fixed",document.body.appendChild(t),t.focus(),t.select();let o=!1;try{o=document.execCommand("copy")}catch(e){}return document.body.removeChild(t),o};if(!navigator.clipboard)return t();try{return yield navigator.clipboard.writeText(e),!0}catch(e){return t()}})}},7549:(e,t,o)=>{e.exports=o.p+"5c0badfd21808b14f424.png"},7555:(e,t,o)=>{e.exports=o.p+"9b22161f83ea9e9a0e76.png"},7659:e=>{var t={};e.exports=function(e,o){var i=function(e){if(void 0===t[e]){var o=document.querySelector(e);if(window.HTMLIFrameElement&&o instanceof window.HTMLIFrameElement)try{o=o.contentDocument.head}catch(e){o=null}t[e]=o}return t[e]}(e);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(o)}},7825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(o){!function(e,t,o){var i="";o.supports&&(i+="@supports (".concat(o.supports,") {")),o.media&&(i+="@media ".concat(o.media," {"));var n=void 0!==o.layer;n&&(i+="@layer".concat(o.layer.length>0?" ".concat(o.layer):""," {")),i+=o.css,n&&(i+="}"),o.media&&(i+="}"),o.supports&&(i+="}");var a=o.sourceMap;a&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),t.styleTagTransform(i,e,t.options)}(t,e,o)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},7950:(e,t,o)=>{e.exports=o.p+"3af7da2d4c114edd8c83.png"},8117:(e,t,o)=>{o.d(t,{A:()=>r});var i=o(1601),n=o.n(i),a=o(6314),s=o.n(a)()(n());s.push([e.id,'body{--font-size-title: calc(14px + 2.8vw);--font-size-largest: calc(12px + 2vw);--font-size-larger: calc(12px + 1.5vw);--font-size-large: calc(12px + 1vw);--font-size-medium: calc(12px + 0.5vw);--font-size-small: calc(10px + 0.45vw);--font-size-smaller: calc(8px + 0.4vw);--font-size-smallest: calc(7px + 035vw)}body.mobile{--font-size-title: calc(18px + 3vw);--font-size-largest: calc(17px + 2.5vw);--font-size-larger: calc(16px + 2vw);--font-size-large: calc(16px + 1.5vw);--font-size-medium: calc(14px + 1vw);--font-size-small: calc(12px + 0.75vw);--font-size-smaller: calc(10px + 0.5vw);--font-size-smallest: calc(8px + 0.4vw)}body{background-color:#000;color:#fff;font-family:"Fira Sans",sans-serif;margin:0;min-height:100vh;min-width:100%;padding:0}body button{background-color:#b4b4b4;border-bottom-color:#828282;border-left-color:#e6e6e6;border-right-color:#828282;border-top-color:#e6e6e6;border-width:1.5px;box-shadow:none;box-sizing:border-box;outline:none;user-select:none}body button:hover{background-color:#c8c8c8}body button:active{background-color:#969696;border-bottom-color:#e6e6e6;border-left-color:#828282;border-right-color:#e6e6e6;border-top-color:#828282}body button:disabled{background-color:#aaa;border:none}body input{background-color:#ebebeb;border:1px rgba(0,0,0,.5) solid;box-shadow:none;box-sizing:border-box;color:#000;font-size:var(--font-size-medium);line-height:var(--font-size-medium);outline:none}body input:hover{background-color:#f0f0f0;border:1px #000 solid}body input:active,body input:focus{background-color:#fafafa;border:1px #000 solid;outline:2px solid rgba(0,0,0,.5)}body ::-webkit-scrollbar{width:7px}body ::-webkit-scrollbar-track{background:rgba(0,0,0,0)}body ::-webkit-scrollbar-thumb{background:#7a5959;border:2px solid rgba(0,0,0,0);background-clip:padding-box;border-radius:7px}body ::-webkit-scrollbar-thumb:hover{background:#5c4646;border:none}body ::-webkit-scrollbar-thumb:active{background:#463535}body .max-size{height:100%;max-width:100%;max-height:100%;min-width:100%;min-height:100%;width:100%}body .set-size{height:var(--size);max-width:var(--size);max-height:var(--size);min-width:var(--size);min-height:var(--size);width:var(--size)}body .set-h{height:var(--size-h);max-height:var(--size-h);min-height:var(--size-h)}body .set-w{max-width:var(--size-w);min-width:var(--size-w);width:var(--size-w)}',""]);const r=s},8498:(e,t,o)=>{var i=o(1981),n=o(5072),a=o.n(n),s=o(7825),r=o.n(s),l=o(7659),d=o.n(l),c=o(5056),m=o.n(c),g=o(540),h=o.n(g),u=o(1113),b=o.n(u),p=o(5308),v={};v.styleTagTransform=b(),v.setAttributes=m(),v.insert=d().bind(null,"head"),v.domAPI=r(),v.insertStyleElement=h(),a()(p.A,v),p.A&&p.A.locals&&p.A.locals;class _ extends i.U{constructor(){super(),this.configureElement("message_container"),this.configureElement("ok_button")}getHTML(){return'<div id="wrapper"> <div id="message-container"></div> <button id="ok-button">ok</button> </div> '}getData(){var e,t;return{message:null!==(e=this.getAttribute("message"))&&void 0!==e?e:"",button_text:null!==(t=this.getAttribute("button_text"))&&void 0!==t?t:void 0}}setData(e,t){this.setAttribute("message",e.message),e.button_text&&this.setAttribute("button_text",e.button_text),(t||this.fully_parsed)&&(this.message_container.innerText=e.message,e.button_text&&(this.ok_button.innerText=e.button_text),this.ok_button.addEventListener("click",()=>{this.closeDialog()}))}}customElements.define("dwg-message-dialog",_)},8808:(e,t,o)=>{o.d(t,{A:()=>r});var i=o(1601),n=o.n(i),a=o(6314),s=o.n(a)()(n());s.push([e.id,"dwg-lobby-users{display:flex;flex-flow:column nowrap}dwg-lobby-users.loading>#user-container{display:none}dwg-lobby-users:not(.loading)>#loading-message{display:none}dwg-lobby-users>#header{height:36px}dwg-lobby-users>#header #refresh-button{background-color:rgba(0,0,0,0);border:none;border-radius:6px;height:30px;margin:0px;padding:0px;position:relative;top:3px;user-select:none;width:30px}dwg-lobby-users>#header #refresh-button:hover{background-color:rgba(180,180,180,.15)}dwg-lobby-users>#header #refresh-button:active{background-color:rgba(180,180,180,.3)}dwg-lobby-users>#header #refresh-button #refresh-img{left:3px;position:absolute;top:3px;user-select:none}dwg-lobby-users>#loading-message{color:rgba(250,250,250,.9);font-size:var(--size-medium)}dwg-lobby-users>#user-container{display:flex;flex-flow:column nowrap;flex:1 0 0}dwg-lobby-users>#user-container .lobby-user{--height: var(--font-size-larger);width:100%}",""]);const r=s},9362:(e,t,o)=>{o.d(t,{A:()=>r});var i=o(1601),n=o.n(i),a=o(6314),s=o.n(a)()(n());s.push([e.id,"dwg-lobby-user{box-sizing:border-box;display:block;font-size:calc(.6*var(--height));height:var(--height);line-height:calc(var(--height) - .3em);max-height:var(--height);max-width:100%;min-height:var(--height);min-width:100%;padding:.15em .3em;position:relative;user-select:none;width:100%}dwg-lobby-user:hover{background-color:rgba(180,180,180,.15)}dwg-lobby-user:active{background-color:rgba(180,180,180,.3)}dwg-lobby-user>#ping{height:calc(.8*var(--height) - .3em);left:.3em;position:absolute;top:calc(.1*var(--height) + .15em);width:calc(.8*var(--height) - .3em)}dwg-lobby-user>#ping:hover>#ping-text{display:block}dwg-lobby-user>#ping>#ping-text{background-color:rgba(90,90,90,.6);border-radius:.3em;display:none;font-size:var(--font-size-medium);line-height:var(--font-size-medium);padding:.3em;position:absolute;right:calc(100% + .3em);top:calc(-0.1*var(--height) - .075em);white-space:nowrap}dwg-lobby-user>#user-name{margin-left:calc(.8*var(--height) + .3em)}",""]);const r=s},9670:(e,t,o)=>{o.d(t,{A:()=>r});var i=o(1601),n=o.n(i),a=o(6314),s=o.n(a)()(n());s.push([e.id,"dwg-ai-selector>#player-wrapper{display:flex;flex-flow:column nowrap;gap:.4em}dwg-ai-selector>#player-wrapper>.player{--size-h: 1.2em;line-height:var(--size-h);padding:.2em;position:relative}dwg-ai-selector>#player-wrapper>.player:hover{background-color:rgba(120,120,120,.1)}dwg-ai-selector>#player-wrapper>.player>.remove-button{--size: calc(var(--size-h) + 0.4em);padding:2px;position:absolute;right:.5em;top:0}dwg-ai-selector>#add-player-button{margin-top:.8em}",""]);const r=s}},o={};function i(e){var n=o[e];if(void 0!==n)return n.exports;var a=o[e]={id:e,exports:{}};return t[e](a,a.exports,i),a.exports}i.m=t,e=[],i.O=(t,o,n,a)=>{if(!o){var s=1/0;for(c=0;c<e.length;c++){for(var[o,n,a]=e[c],r=!0,l=0;l<o.length;l++)(!1&a||s>=a)&&Object.keys(i.O).every(e=>i.O[e](o[l]))?o.splice(l--,1):(r=!1,a<s&&(s=a));if(r){e.splice(c--,1);var d=n();void 0!==d&&(t=d)}}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[o,n,a]},i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var o in t)i.o(t,o)&&!i.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.p="dist/",(()=>{i.b="undefined"!=typeof document&&document.baseURI||self.location.href;var e={57:0};i.O.j=t=>0===e[t];var t=(t,o)=>{var n,a,[s,r,l]=o,d=0;if(s.some(t=>0!==e[t])){for(n in r)i.o(r,n)&&(i.m[n]=r[n]);if(l)var c=l(i)}for(t&&t(o);d<s.length;d++)a=s[d],i.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return i.O(c)},o=self.webpackChunkgray_online=self.webpackChunkgray_online||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})(),i.nc=void 0;var n={},a=i(5072),s=i.n(a),r=i(7825),l=i.n(r),d=i(7659),c=i.n(d),m=i(5056),g=i.n(m),h=i(540),u=i.n(h),b=i(1113),p=i.n(b),v=i(8117),_={};_.styleTagTransform=p(),_.setAttributes=g(),_.insert=c().bind(null,"head"),_.domAPI=l(),_.insertStyleElement=u(),s()(v.A,_),v.A&&v.A.locals&&v.A.locals,document.body.ontouchstart=()=>{};var y=i(1846),f={};f.styleTagTransform=p(),f.setAttributes=g(),f.insert=c().bind(null,"head"),f.domAPI=l(),f.insertStyleElement=u(),s()(y.A,f),y.A&&y.A.locals&&y.A.locals;var w=i(4161),x=i(1511),k=i(7447),E=i(3227),L={};L.styleTagTransform=p(),L.setAttributes=g(),L.insert=c().bind(null,"head"),L.domAPI=l(),L.insertStyleElement=u(),s()(E.A,L),E.A&&E.A.locals&&E.A.locals;const z=new Map(Object.entries({":D":"",xD:"",XD:"",":'D":"",":')":"",":)":"",";)":"",":>":"","o:)":"","O:)":"",":x":"",":X":"",":*":"",":p":"",":P":"",";p":"",";P":"",xp:"",xP:"",XP:"",":l":"",":L":"",":z":"",":Z":"",":|":"",":#":"",":j":"",":?":"","8D":"","%(":"",":&":"",xo:"",XO:"","8)":"",":B":"",":/":"",":(":"",":o":"",":O":"",":$":"",":s":"",":S":"",":'(":"",":'o":"",Dx:"","x(":"","X(":"",":<":"","D:":"",":c":"",":C":"",">:/":"",":@":"",">:)":"",">:(":"",">0)":"",":3":"","</3":"","<3":"","\\m/":"","\\M/":"",":{>":"",":E":"","8#":""}));var A=i(4763),C={};C.styleTagTransform=p(),C.setAttributes=g(),C.insert=c().bind(null,"head"),C.domAPI=l(),C.insertStyleElement=u(),s()(A.A,C),A.A&&A.A.locals&&A.A.locals;const S="!!server!!";class R extends w.J{constructor(){super(),this.convert_emoticons=!0,this.last_new_messages_button_count=0,this.new_chat_elements=[],this.htmlString='<div id="chat-container"></div> <div id="new-messages-container"> <button id="new-messages-button">New Messages (<span id="new-messages-number"></span>)</button> </div> <div id="input-container"> <input id="chat-input" placeholder=""> <button id="send-chat">Send</button> </div>',this.configureElement("chat_container"),this.configureElement("chat_input"),this.configureElement("send_chat"),this.configureElement("new_messages_button"),this.configureElement("new_messages_number")}parsedCallback(){(0,k.Bd)(this.send_chat,()=>{this.sendChat()}),this.chat_input.addEventListener("keyup",e=>{"Enter"===e.key&&this.sendChat()}),this.new_messages_button.addEventListener("click",()=>{this.adjustScroll()}),this.chat_container.addEventListener("scroll",()=>{this.scrolledUp()||this.scrolledToBottom()})}scrolledUp(){return this.chat_container.scrollHeight-this.chat_container.offsetHeight-this.chat_container.scrollTop>R.adjust_scroll_limit}adjustScroll(){this.chat_container.scrollTop=this.chat_container.scrollHeight-this.chat_container.offsetHeight,this.scrolledToBottom()}scrolledToBottom(){this.last_new_messages_button_count=0,this.new_messages_button.classList.remove("show")}addChat(e,t=!1){const o=this.scrolledUp(),i=e.sender&&e.sender!==S?`${e.sender}: `:"",n=document.createElement("div");e.sender!==S&&"gray"!==e.color||n.classList.add("color-gray"),n.innerHTML=`<b>${i}</b>${e.message}`,this.chat_container.appendChild(n),n.classList.add("new-message"),this.new_chat_elements.push(n),this.classList.add("new-message"),this.last_new_messages_button_timer&&clearTimeout(this.last_new_messages_button_timer),t||!o||this.classList.contains("transparent-fade")&&!this.classList.contains("show")?this.adjustScroll():(this.new_messages_button.classList.add("show"),this.new_messages_button.classList.add("new-message"),this.last_new_messages_button_count++,this.new_messages_number.innerText=this.last_new_messages_button_count.toString()),setTimeout(()=>{this.new_messages_button.classList.remove("new-message"),this.new_chat_elements.forEach(e=>{e.classList.remove("new-message")}),this.classList.remove("new-message")},1500)}sendChat(){if(this.inputEmpty())return;const e=this.getInput();if(this.convert_emoticons)for(const[t,o]of z)e.message=e.message.replace(t,o);const t=new CustomEvent("chat_sent",{detail:e});this.dispatchEvent(t)}setPlaceholder(e){this.chat_input.placeholder=e}focus(){this.chat_input.focus()}clear(){this.chat_input.value="",this.chat_container.innerHTML=""}inputEmpty(){return!this.chat_input.value}getInput(){const e={message:this.chat_input.value};return this.chat_input.value="",e}}R.adjust_scroll_limit=5,customElements.define("dwg-chatbox",R);var T=i(2074),M=i(5109),I=i(4385),P=i.n(I),U=new URL(i(2190),i.b);const $='<span id="page-header"> <span id="name-container"></span> <span id="ping-container"></span> </span> <span id="buttons"> <button id="refresh-lobby-button">Refresh</button> <button id="create-room-button">Create Room</button> <button id="lobby-users-button"> <img src="'+P()(U)+'" alt="users" draggable="false"> </button> </span> <span id="horizontal-container"> <span id="vertical-container"> <dwg-lobby-rooms id="lobby-rooms"></dwg-lobby-rooms> <dwg-chatbox id="chatbox"></dwg-chatbox> </span> <div id="lobby-users-backdrop"></div> <dwg-lobby-users id="lobby-users"></dwg-lobby-users> </span> <div id="lobby-room-wrapper"> <dwg-lobby-room id="lobby-room"></dwg-lobby-room> </div> <div id="lobby-connected-wrapper"> <div id="connecting-message">Connecting ...</div> </div>';var j=i(575),D={};D.styleTagTransform=p(),D.setAttributes=g(),D.insert=c().bind(null,"head"),D.domAPI=l(),D.insertStyleElement=u(),s()(j.A,D),j.A&&j.A.locals&&j.A.locals;var N=new URL(i(6224),i.b);const H='<div id="header"> <button id="refresh-button"> <img id="refresh-img" src="'+P()(N)+'" alt="refresh" draggable="false"> </button> </div> <div id="loading-message"></div> <div id="user-container"></div>';var G=i(8808),O={};O.styleTagTransform=p(),O.setAttributes=g(),O.insert=c().bind(null,"head"),O.domAPI=l(),O.insertStyleElement=u(),s()(G.A,O),G.A&&G.A.locals&&G.A.locals;var F=i(9362),J={};J.styleTagTransform=p(),J.setAttributes=g(),J.insert=c().bind(null,"head"),J.domAPI=l(),J.insertStyleElement=u(),s()(F.A,J),F.A&&F.A.locals&&F.A.locals;class B extends w.J{constructor(){super(),this.htmlString=' <div id="ping"> <img id="ping-image" class="max-size" draggable="false"> <div id="ping-text"></div> </div> <div id="user-name"></div> <div id="buttons"></div>',this.configureElement("ping_image"),this.configureElement("ping_text"),this.configureElement("user_name"),this.configureElement("buttons")}parsedCallback(){this.user?this.setData():console.error("Must set user before attaching to dom")}updateUser(e){this.user=e,this.fully_parsed&&this.setData()}setData(){this.user_name.innerText=this.user.nickname,this.updatePing(this.user.ping)}updatePing(e){this.user.ping=e,this.ping_text.innerText=`${Math.round(e)} ms`,this.ping_image.src=e<100?"/images/icons/ping_good24.png":e<300?"/images/icons/ping_ok24.png":e<1e3?"/images/icons/ping_bad24.png":"/images/icons/ping_empty24.png"}}customElements.define("dwg-lobby-user",B);class Z extends w.J{constructor(){super(),this.users=new Map,this.first_load=!0,this.htmlString=H,this.configureElement("refresh_button"),this.configureElement("loading_message"),this.configureElement("user_container")}parsedCallback(){(0,k.Bd)(this.refresh_button,()=>{this.refreshUsers(!0)},{}),this.refreshUsers(),setInterval(()=>{this.updatePings()},2500)}refreshUsers(){return e=this,t=arguments,i=function*(e=!1){if(this.classList.contains("loading"))return;(this.first_load||e)&&(this.classList.add("loading"),this.loading_message.innerHTML=" ... loading",this.first_load=!1);const t=yield(0,x.Vg)("lobby/users/get");if(t.success){for(const e of this.users.values())e.refreshed=!1;for(const e of t.result){const t=(0,M.LO)(e);this.addUser(t)}const e=[...this.users.keys()];for(const t of e){const e=this.users.get(t);e&&(e.refreshed||(e.el.remove(),this.users.delete(e.data.client_id)))}this.classList.remove("loading")}else this.loading_message.innerHTML=`Error loading users: ${t.error_message}`},new((o=void 0)||(o=Promise))(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function r(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(s,r)}l((i=i.apply(e,t||[])).next())});var e,t,o,i}addUser(e){if(this.users.has(e.client_id))this.users.get(e.client_id).data=e,this.users.get(e.client_id).refreshed=!0,this.users.get(e.client_id).el.updateUser(e);else{const t=document.createElement("dwg-lobby-user");t.classList.add("lobby-user"),t.updateUser(e),this.user_container.appendChild(t),this.users.set(e.client_id,{data:e,el:t,refreshed:!0})}}updatePing(e,t){const o=this.users.get(e);o&&(o.data.ping=t,o.el.updatePing(t))}updatePings(){for(const e of this.users.values())e.el.updatePing(e.data.ping)}removeUser(e){var t;this.users.has(e)&&(null===(t=this.users.get(e))||void 0===t||t.el.remove(),this.users.delete(e))}getUser(e){var t;return null===(t=this.users.get(e))||void 0===t?void 0:t.data}joinRoom(e,t){const o=this.getUser(e);o&&(o.room_id=t)}leaveRoom(e){const t=this.getUser(e);t&&(t.room_id=void 0)}}customElements.define("dwg-lobby-users",Z);var V=i(112),W={};W.styleTagTransform=p(),W.setAttributes=g(),W.insert=c().bind(null,"head"),W.domAPI=l(),W.insertStyleElement=u(),s()(V.A,W),V.A&&V.A.locals&&V.A.locals;var K=new URL(i(2190),i.b),q=new URL(i(7950),i.b);const Y='<div id="room-players"> <span id="room-curr-players"></span>/<span id="room-max-players"></span> </div> <div id="room-game"></div> <div id="room-name"></div> <div id="room-buttons"> <button id="button-join-player"> <img src="'+P()(K)+'" alt="Join" draggable="false"> </button> <button id="button-join-viewer"> <img src="'+P()(q)+'" alt="Join" draggable="false"> </button> </div>';var X=i(1504),Q={};Q.styleTagTransform=p(),Q.setAttributes=g(),Q.insert=c().bind(null,"head"),Q.domAPI=l(),Q.insertStyleElement=u(),s()(X.A,Q),X.A&&X.A.locals&&X.A.locals;class ee extends w.J{constructor(){super(),this.htmlString=Y,this.configureElement("room_name"),this.configureElement("room_curr_players"),this.configureElement("room_max_players"),this.configureElement("room_game"),this.configureElement("button_join_player"),this.configureElement("button_join_viewer")}parsedCallback(){this.room?(this.setRoomData(),this.addEventListener("dblclick",()=>{this.dispatchEvent(new Event("join_room"))}),this.button_join_player.addEventListener("click",()=>{this.dispatchEvent(new CustomEvent("join_room",{detail:!0}))}),this.button_join_viewer.addEventListener("click",()=>{this.dispatchEvent(new CustomEvent("join_room",{detail:!1}))})):console.error("Must set room before attaching to dom")}updateRoom(e){this.room=e,this.fully_parsed&&this.setRoomData()}setRoomData(){var e,t,o,i;this.room&&(this.room_curr_players.innerText=null===(e=this.room.players)||void 0===e?void 0:e.size.toString(),this.room_max_players.innerText=null===(o=null===(t=this.room.game_settings)||void 0===t?void 0:t.max_players)||void 0===o?void 0:o.toString(),this.room_name.innerText=this.room.room_name,this.room_game.innerText=(0,k.ZH)((null!==(i=M.ZF[this.room.game_settings.game_type||-1])&&void 0!==i?i:"").toLowerCase().replace("_"," ")))}}customElements.define("dwg-room-selector",ee);var te=function(e,t,o,i){return new(o||(o=Promise))(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function r(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(s,r)}l((i=i.apply(e,t||[])).next())})};class oe extends w.J{constructor(){super(),this.lock=(0,k.cs)(),this.refreshing_rooms=!1,this.rooms=new Map,this.first_load=!0,this.htmlString=' <div id="loading-message"></div> <div id="room-container"></div> ',this.configureElement("loading_message"),this.configureElement("room_container")}parsedCallback(){}refreshRooms(e){return te(this,arguments,void 0,function*(e,t=!1){let o;return yield this.lock(()=>te(this,void 0,void 0,function*(){(this.first_load||t)&&(this.classList.add("loading"),this.loading_message.innerHTML=" ... loading",this.first_load=!1);const i=yield(0,x.Vg)("lobby/rooms/get");if(i.success){for(const e of this.rooms.values())e.refreshed=!1;for(const t of i.result){const i=(0,M.VL)(t);this.addRoom(i),(i.players.has(e)||i.viewers.has(e))&&(o=i)}const t=[...this.rooms.keys()];for(const e of t){const t=this.rooms.get(e);t&&(t.refreshed||t.el.remove())}this.classList.remove("loading")}else this.loading_message.innerHTML=`Error loading rooms: ${i.error_message}`})),o})}addRoom(e){if(this.rooms.has(e.room_id))this.rooms.get(e.room_id).data=e,this.rooms.get(e.room_id).refreshed=!0,this.rooms.get(e.room_id).el.updateRoom(e);else{const t=document.createElement("dwg-room-selector");t.classList.add("lobby-room"),t.id=`room-selector-${e.room_id}`,t.updateRoom(e),t.addEventListener("join_room",t=>{var o;const i={detail:{room_id:e.room_id,join_as_player:null===(o=t.detail)||void 0===o||o}};this.dispatchEvent(new CustomEvent("join_room",i))}),this.room_container.appendChild(t),this.rooms.set(e.room_id,{data:e,el:t,refreshed:!0})}}removeRoom(e){var t;const o=null===(t=this.getRoom(e))||void 0===t?void 0:t.el;o&&o.remove(),this.rooms.delete(e)}userDisconnected(e){const t=[];for(const o of this.rooms.values())e===o.data.host.client_id&&t.push(o.data.room_id);t.forEach(e=>this.removeRoom(e))}getRoom(e){return this.rooms.get(e)}roomUpdated(e){e.el.updateRoom(e.data)}renameRoom(e,t){const o=this.getRoom(e);o&&(o.data.room_name=t,this.roomUpdated(o))}updateRoomDescription(e,t){const o=this.getRoom(e);o&&(o.data.room_description=t,this.roomUpdated(o))}promoteUser(e,t){const o=this.getRoom(e);o&&o.data.players.has(t)&&(o.data.host=o.data.players.get(t),this.roomUpdated(o))}playerToViewer(e,t){const o=this.getRoom(e);o&&o.data.players.has(t)&&(o.data.viewers.set(t,o.data.players.get(t)),o.data.players.delete(t),this.roomUpdated(o))}viewerToPlayer(e,t){const o=this.getRoom(e);o&&o.data.viewers.has(t)&&(o.data.players.set(t,o.data.viewers.get(t)),o.data.viewers.delete(t),this.roomUpdated(o))}playerJoinsRoom(e,t){const o=this.getRoom(t.room_id);if(e===t.room_id)return void(o&&(o.data.players.set(t.client_id,t),this.roomUpdated(o)));o&&(o.data.host.client_id===t.client_id?this.removeRoom(t.room_id):o.data.players.delete(t.client_id),this.roomUpdated(o));const i=this.getRoom(e);i&&(i.data.players.set(t.client_id,t),this.roomUpdated(i))}viewerJoinsRoom(e,t){const o=this.getRoom(t.room_id);if(e===t.room_id)return void(o&&(o.data.viewers.set(t.client_id,t),this.roomUpdated(o)));o&&(o.data.host.client_id===t.client_id?this.removeRoom(t.room_id):o.data.players.delete(t.client_id),this.roomUpdated(o));const i=this.getRoom(e);i&&(i.data.viewers.set(t.client_id,t),this.roomUpdated(i))}clientLeavesRoom(e,t){const o=this.getRoom(e);o&&(o.data.host.client_id!==t||o.data.game_id?(o.data.players.delete(t),o.data.viewers.delete(t)):this.removeRoom(e),this.roomUpdated(o))}updateRoomSettings(e,t){const o=this.getRoom(e);o&&(o.data.game_settings=t,this.roomUpdated(o))}launchRoom(e,t){const o=this.getRoom(e);o&&(o.data.game_id=t,this.roomUpdated(o))}gameOver(e){const t=this.getRoom(e);t&&(t.data.game_id=void 0,this.roomUpdated(t))}}customElements.define("dwg-lobby-rooms",oe);var ie=new URL(i(1869),i.b),ne=new URL(i(7549),i.b);const ae='<div id="room-header"> <button id="rename-room"> <img src="'+P()(ie)+'" alt="rename" draggable="false"> </button> <button id="cancel-rename">cancel</button> <div id="room-name"></div> <input id="rename-input" placeholder="room name"> <button id="leave-room"> <img src="'+P()(ne)+'" alt="close" draggable="false"> </button> </div> <div id="room-body"> <div id="left-panel"> <div id="game-settings"> <div id="settings-button-container" class="hide button-container settings-medium"> <button id="settings-settings-button">Settings</button> <button id="settings-launch-button">Launch</button> </div> <div id="game-button-container" class="hide button-container settings-medium"> <button id="game-resign-button">Resign</button> <button id="game-rejoin-button">Rejoin</button> </div> <dwg-lobby-game-settings id="lobby-game-settings"></dwg-lobby-game-settings> <div id="settings-title" class="settings-medium"></div> <div id="settings-players" class="settings-medium"> Players: <span id="num-players-current"></span>/<span id="num-players-max"></span> </div> <div id="settings-game-status" class="settings-small"></div> <div id="settings-settings-label" class="settings-large">Settings:</div> <div id="settings-settings"></div> <div id="settings-description-label" class="settings-large">Description:</div> <div id="settings-description" class="settings-small"></div> </div> <div id="user-list"> <div id="host-label" class="container-label">Host</div> <div id="host-container"></div> <div id="players-label" class="container-label">Players</div> <div id="players-container"></div> <div id="viewers-label" class="container-label">Viewers</div> <div id="viewers-container"></div> </div> </div> <dwg-chatbox id="chatbox"></dwg-chatbox> </div>';var se=i(5366),re={};re.styleTagTransform=p(),re.setAttributes=g(),re.insert=c().bind(null,"head"),re.domAPI=l(),re.insertStyleElement=u(),s()(se.A,re),se.A&&se.A.locals&&se.A.locals;var le=i(1400),de={};de.styleTagTransform=p(),de.setAttributes=g(),de.insert=c().bind(null,"head"),de.domAPI=l(),de.insertStyleElement=u(),s()(le.A,de),le.A&&le.A.locals&&le.A.locals;var ce=i(9670),me={};me.styleTagTransform=p(),me.setAttributes=g(),me.insert=c().bind(null,"head"),me.domAPI=l(),me.insertStyleElement=u(),s()(ce.A,me),ce.A&&ce.A.locals&&ce.A.locals;const ge=new Map([["male",["Sir","Mr."]],["female",["Mrs.","Ms.","Maam","Mistress","Madam"]],["androgynous",["Professor","Governor","Master","Dr."]]]),he=new Map([["male",["Brother","Caliph","Chairman","Count","Earl","Goodman","His Eminence","Imam","Lord","Patriarch","Shah"]],["female",["Sister","Countess","Chairwoman","Goodwife","Lady","Shahbanu"]],["androgynous",["Admiral","General","Consul","Elder","Emeritus","Goody","Mayor","President","Princeps","Doctor"]]]),ue=new Map([["male",["Nicols","Mateo","Juan","Benicio","Daniel","Kevin","Luis","Tho","Miguel","Noah","Lucas","Paulo","Liam","Benjamin","Jack","Thomas","Nathan","Gaspar","Maximiliano","Santiago","Thiago","Inuk","Malik","Qillaq","Stevenson","Ali","Wilson","David","Ricardo","Aiden","Josiah","Santiago","Matas","Thiago","Dylan","Ramn","Csar","Gael","Ian","Oliver","Elijah","Theodore","Henry","James","John","Robert","Michael","William","Richard","Charles","Joseph","Valentn","Christopher","Matthew","Anthony","Mark","Donald","Kenneth","Mohamed","Noel","Iker","Paul","Mateo","Matsvey","Arthur","Davud","Aleksandar","Luka","Andreas","Jakub","Noah","Hugo","Bartal","Eino","Andria","Finn","Kai","Georgios","Freddie","Dominik","Leonardo","Elias","Aleksandar","Levi","Cillian","Nikodem","Andrei","Mikhail","Dmitriy","Sergei","Tommaso","Ivan","Harris","Rory","Dragan","Artem","Archie","Vladyslav","Pablo","Markuss"]],["female",["Sofa","Alysha","Martha","Helena","Maria","Olivia","Alice","Emma","Renata","Emily","Roxana","Isis","Aline","Charlotte","Amelia","Sophia","Chloe","La","Guadalupe","Ma","Aitana","Ivaana","Niviaq","Pipaluk","Widelene","Antonella","Esther","Amelia","Kyra","Sofa","Camila","Valentina","Aurora","Luna","Samantha","Camila","Julieta","Evelyn","Mary","Linda","Barbara","Elizabeth","Jennifer","Susan","Dorothy","Margaret","Patricia","Jessica","Karen","Sarah","Lisa","Nancy","Sandra","Betty","Ashley","Kimberly","Amelia","Ambra","Martina","Hannah","Sophia","Ksenia","Juliette","Iman","Viktoria","Gabriela","Nika","Eleni","Panagiota","Elika","Frida","Agnes","Isla","Sienna","Saara","Slja","Bjrg","Aino","Jade","Ambre","Mariami","Chloe","Eleni","Angeliki","Daisy","Zo","Katla","Emlija","Frieda","Marija","Jana","Anastasia","Sofija","Oliwia","Zofia","Aurora","Milica","Elsa","Ona"]],["androgynous",["Taylor","Logan","Riley","Parker","Avery","Jordan","Casey","Azariah","August"]]]),be=new Map([["male",["Omar","Mustafa","Youssef","Hamza","Hussein","Ibrahim","Ali","Lwandle","Halim","Peter","Pierre","Mina","Habib","Fadi","Djamel","Amir","Mehdi","Karim","Tareq","Mamadou","Aziz","Jos","Omphile","Ofentse","Amine","Abdullah","Fahd","Davit","Tigran","Armen","Samvel","Raul","Vugar","Mchn","Hoy","Mchn","Yz","Myng","Mohammed","Muhammad","Abdul","Vedant","Sutrisno","Herman","Amir-Ali","Samyar","Reza","Abbas","Hydar","Adam","Lavi","Moshe","Charbel","Aoi","S","Nagi","Ren","Tatsuki","Haruma","Alikhan","Aldiyar","Abdulaziz","Elie","Christian","Joe","Wan","Izz","Tenun","Tushig","Krishna","Bishal","Prem","Bilal","Ezekiel","Turki","Seo-jun","Ji-ho","Min-jun","Chun-hung","Chia-hao","Yusuf","Somchai","Somporn","Alparslan","Mira","Gktug","Mehmet","Hseyin","smail","Imronbek","Leo","Manea","Kayden","Luca","Ariki","Hiro","Teiva","Tapuarii","Kiwa"]],["female",["Imene","Yasmine","Maria","Meriem","Melissa","Lydia","Fatma","Hosniya","Fatin","Aya","Suha","Habiba","Marie","Marwa","Nada","Salma","Isabel","Mona","Assia","Ins","Doha","Irene","Shayma","Khawla","Nora","Amira","Maryam","Lyn","Hur","Lucy","Nare","Arpi","Eva","Anna","Anahit","Hasmik","Zahra","Aylin","Zeynab","nci","Nuray","Sevinj","Gunay","Rux","Yhn","Ynu","Ym","Ytng","Yx","Aditi","Aarya","Vamika","Mehar","Nurhayati","Sunarti","Fatemeh","Mersana","Zahra","Zeinab","Avigail","Yael","Adel","Tamar","Libi","Shams","Jori","Nur","Celine","Yasmin","Himari","Hinata","Hina","Uta","Sakura","Jouri","Leen","Wateen","Mdna","Aya","Tomyris","Hussa","Saliha","Marie","Amin-Erdene","Michele","Sondor","Dhia","Shristi","Binita","Fozia","Ji-an","Ha-rin","Shu-fen","Sumayah","Zeynep","Soliha","Isla","Matilda","Kiana","Ohana","Kaia","Zo","Willow","Marama","Aroha"]],["androgynous",["Rowan","Malak","Karen"]]]),pe=["Crabs","Shakealot","Greenbacks","Yoo","Arco","Astley","Baldwins","Bourbon","Burgundy","Capet","Carolingian","Collalto","Estridsen","Ernut","Ferdinand","Gravenreuth","Gusic","Habsburg","Hesse","Holstein","Kurki","Lombards","Lothbrok","Madi","Medici","Morosini","Nassau","Orange","Orsini","Pfeffel","Priuli","Querini","Rothschild","Sanudo","Schleswig","Sparneck","Strozzi","Tudor","von Schmitt","Windsor","Smith","Johnson","Williams","Garca","Davis","Martnez","Gonzlez","Anderson","Moore","Prez","White","Clark","Robinson","Nguyen","Campbell","Nelson","Green","Parker","Turner","Evans","Wang","Mahamat","Mohamed","Ali","Ahmed","Ibrahim","Hassan","Li","Zhang","Chen","Liu","Lu","Zhou","Mller","Hernndez","da Silva","Ferreira","Peter","Madden","Whitlock","Langston","Elrod","Yarbrough","Singh","Fleet","Ninomae","Darcy","Albertine","Sapphirus","Maverick","Boney","Rollapull","Whackamattus"],ve=new Map([["androgynous",["Esq.","Senior","Junior","Sr.","Jr.","II","III"]]]),_e=new Map([["androgynous",["the Elder","the Younger","JD","MA","MD","PhD","the Wise"]]]),ye=[[!0,!0,!0,!0],[!1,!0,!0,!0],[!0,!1,!0,!0],[!0,!0,!1,!0],[!0,!0,!0,!1],[!0,!0,!0,!1],[!1,!1,!0,!0],[!1,!0,!1,!0],[!1,!0,!0,!1],[!1,!0,!0,!1],[!1,!0,!0,!1],[!1,!0,!0,!1],[!1,!0,!0,!1],[!1,!0,!0,!1],[!0,!1,!0,!1],[!0,!1,!0,!1],[!0,!1,!0,!1],[!0,!0,!1,!1],[!0,!0,!1,!1],[!0,!0,!1,!1],[!1,!0,!1,!1],[!1,!0,!1,!1],[!1,!0,!1,!1],[!1,!0,!1,!1],[!1,!0,!1,!1],[!1,!0,!1,!1],[!1,!1,!0,!1],[!1,!1,!0,!1],[!1,!1,!0,!1]];function fe(e,t,o){var i,n;let a=e;Math.random()<.25&&t&&(a=t);const s=[];return s.push(...null!==(i=a.get("androgynous"))&&void 0!==i?i:[]),"male"!==o&&"female"!==o||s.push(...null!==(n=a.get(o))&&void 0!==n?n:[]),(0,k.G0)(s)}const we=new Set;const xe=[["M",1e3],["CM",900],["D",500],["CD",400],["C",100],["XC",90],["L",50],["XL",40],["X",10],["IX",9],["V",5],["IV",4],["I",1]];function ke(e){let t="";for(const[o,i]of xe)for(;e>=i;)t+=o,e-=i;return t}class Ee extends w.J{constructor(){super(),this.els=[],this.htmlString=' <div id="player-wrapper"></div> <button id="add-player-button">Add AI Player</button> ',this.configureElement("player_wrapper"),this.configureElement("add_player_button")}parsedCallback(){if(!this.data)throw new Error("Must set ai selector data before adding to dom");this.setPlayers(this.data.ai_players),this.add_player_button.addEventListener("click",()=>{if(this.data.game_type!==M.ZF.FIDDLESTICKS)throw new Error("Unknown game type in ai selector");{const e=document.createElement("div"),t=function(){const e=(0,k.G0)(ye),t=function(){const e=Math.random();return e<.2?"androgynous":e<.6?"female":"male"}();let o="";e[0]&&(o=fe(ge,he,t)),e[1]&&(o+=` ${fe(ue,be,t)}`),e[2]&&(o+=` ${(0,k.G0)(pe)}`),e[3]&&(o+=`, ${fe(ve,_e,t)}`);let i=1;for(;we.has(o);)i++,o+=` ${ke(i)}`;return we.add(o),o}();e.innerText=t,this.data.ai_players.push({nickname:t}),this.player_wrapper.appendChild(this.addPlayer(e))}})}setData(e){if(this.fully_parsed)throw new Error("Cannot set data when already added to dom");this.data=e,this.els=[]}setPlayers(e){if(this.data.ai_players=e,this.els=[],this.data.game_type!==M.ZF.FIDDLESTICKS)throw new Error("Unknown game type in ai selector");{const t=e.map(e=>{const t=document.createElement("div");return t.innerText=e.nickname,this.addPlayer(t)});this.player_wrapper.replaceChildren(...t)}}addPlayer(e){const t=document.createElement("div");t.classList.add("player"),t.classList.add("set-h");const o=document.createElement("button");o.classList.add("remove-button"),o.classList.add("set-size");const i=document.createElement("img");return i.classList.add("max-size"),i.src="/images/icons/close64.png",i.draggable=!1,o.appendChild(i),e.id=`player-${this.els.length}`,this.els.push(e),o.addEventListener("click",()=>{t.remove();const o=parseInt(e.id.replace("player-",""));console.log(this.data.ai_players,o),this.data.ai_players.splice(o,1),console.log(this.data.ai_players),this.els.splice(o,1);for(const[e,t]of this.els.entries())e<o||(t.id=`player-${e}`);console.log(this.getPlayers().length)}),t.appendChild(e),t.appendChild(o),t}getPlayers(){if(this.data.game_type===M.ZF.FIDDLESTICKS)return this.data.ai_players;throw new Error("Unknown game type in ai selector")}}customElements.define("dwg-ai-selector",Ee);class Le extends w.J{constructor(){super(),this.game_specific_settings_els=new Map,this.htmlString='<div id="game-settings-wrapper" class="set-h set-w"> <div id="game-settings-title">Game Settings</div> <select id="game-chooser"><option value="0" selected="selected" hidden>--Choose a game--</option></select> <div id="settings-wrapper"> <span id="max-players-wrapper" class="row-wrapper"> <span class="input-wrapper"> <label for="max-players-input" class="label">Max Players</label> <input id="max-players-input" type="number" min="1" max="8" placeholder="Max Players"> </span> <span class="input-wrapper"> <label for="max-viewers-input">Max Viewers</label> <input id="max-viewers-input" type="number" min="0" max="16" placeholder="Max Viewers"> </span> </span> <div id="game-specific-settings"></div> <span id="description-wrapper" class="row-wrapper"> <textarea id="room-description" placeholder="Set a description for your room"></textarea> </span> </div> <button id="save-button">Save</button> </div> ',this.configureElement("game_chooser"),this.configureElement("max_players_input"),this.configureElement("max_viewers_input"),this.configureElement("game_specific_settings"),this.configureElement("room_description"),this.configureElement("save_button")}parsedCallback(){for(const e of(0,k.CW)(M.ZF)){if(!M.ZF[e])continue;if(!k.IJ&&e===M.ZF[M.ZF.TEST_GAME].toString())continue;const t=document.createElement("option");t.value=M.ZF[e].toString(),t.innerText=e,this.game_chooser.appendChild(t)}(0,k.Bd)(this.save_button,()=>{this.dispatchEvent(new Event("saved"))}),this.game_chooser.addEventListener("change",()=>{this.setGameChooserValue(this.game_chooser.value)})}setGameChooserValue(e){var t;this.game_chooser.value=e;const o=this.getGameSpecificHTML(null!==(t=parseInt(e))&&void 0!==t?t:0);this.game_specific_settings.replaceChildren(...o)}getGameSpecificHTML(e){const t=[];if(this.game_specific_settings_els.clear(),e===M.ZF.FIDDLESTICKS){const o=this.createNumberElement("min-round","Min Round",1,17),i=this.createNumberElement("max-round","Max Round",1,17);t.push(this.createRowElement([o,i]));const n=this.createNumberElement("round-points","Round Points",0,20,10),a=this.createNumberElement("trick-points","Trick Points",0,10,1);t.push(this.createRowElement([n,a])),t.push(this.createLabelElement("AI Players"));const s=document.createElement("dwg-ai-selector");s.setData({game_type:e,ai_players:[]}),s.id="ai-players",this.game_specific_settings_els.set("ai-players",s),t.push(s)}return t}createLabelElement(e){const t=document.createElement("label");return t.innerText=e,t}createNumberElement(e,t,o,i,n){const a=document.createElement("input");a.id=e,a.type="number",a.placeholder=t,a.min=o.toString(),a.max=i.toString(),void 0!==n&&(a.value=n.toString());const s=document.createElement("label");s.setAttribute("for",e),s.innerText=t,this.game_specific_settings_els.set(e,a);const r=document.createElement("span");return r.classList.add("input-wrapper"),r.appendChild(s),r.appendChild(a),r}createRowElement(e){const t=document.createElement("div");return t.classList.add("row-wrapper"),t.replaceChildren(...e),t}setSettings(e,t){this.setGameChooserValue(e.game_type.toString()),this.max_players_input.value=e.max_players.toString(),this.max_viewers_input.value=e.max_viewers.toString();try{if(e.game_type===M.ZF.FIDDLESTICKS){const t=e.game_specific_settings;this.setNumberSetting("min-round",t.min_round),this.setNumberSetting("max-round",t.max_round),this.setNumberSetting("round-points",t.round_points),this.setNumberSetting("trick-points",t.trick_points);const o=this.game_specific_settings_els.get("ai-players");o&&o.setPlayers(t.ai_players)}}catch(e){console.error(e)}this.room_description.value=t}setNumberSetting(e,t){var o;const i=this.game_specific_settings_els.get(e);i&&(i.value=null!==(o=t.toString())&&void 0!==o?o:"0")}getNumberSetting(e){return this.game_specific_settings_els.get(e)}clearSettings(){this.game_chooser.value="",this.max_players_input.value="",this.max_viewers_input.value="",this.game_specific_settings.replaceChildren(),this.game_specific_settings_els.clear()}getSettings(){var e,t,o,i;const n={game_type:parseInt(this.game_chooser.value)||0,max_players:this.max_players_input.valueAsNumber||0,max_viewers:this.max_viewers_input.valueAsNumber||0};if(n.game_type===M.ZF.FIDDLESTICKS){const a=this.game_specific_settings_els.get("ai-players");n.game_specific_settings={min_round:(null===(e=this.getNumberSetting("min-round"))||void 0===e?void 0:e.valueAsNumber)||0,max_round:(null===(t=this.getNumberSetting("max-round"))||void 0===t?void 0:t.valueAsNumber)||0,round_points:(null===(o=this.getNumberSetting("round-points"))||void 0===o?void 0:o.valueAsNumber)||0,trick_points:(null===(i=this.getNumberSetting("trick-points"))||void 0===i?void 0:i.valueAsNumber)||0,ai_players:a.getPlayers()}}return n}getDescription(){return this.room_description.value}}customElements.define("dwg-lobby-game-settings",Le);var ze,Ae=i(5279),Ce={};Ce.styleTagTransform=p(),Ce.setAttributes=g(),Ce.insert=c().bind(null,"head"),Ce.domAPI=l(),Ce.insertStyleElement=u(),s()(Ae.A,Ce),Ae.A&&Ae.A.locals&&Ae.A.locals;class Se extends w.J{constructor(){super(),this.is_host=!1,this.is_player=!1,this.is_self=!1,this.room_launched=!1,this.htmlString=' <div id="ping"> <img id="ping-image" class="max-size" draggable="false"> <div id="ping-text"></div> </div> <div id="user-name"></div> <div id="buttons"></div>',this.configureElement("ping_image"),this.configureElement("ping_text"),this.configureElement("user_name"),this.configureElement("buttons")}parsedCallback(){this.user?(this.user_name.innerText=this.user.nickname,this.updatePing(this.user.ping),this.room_launched||(this.is_host&&!this.is_self?this.is_player?(this.buttons.appendChild(this.getUserButton(this.user.client_id,"kick","kick")),this.buttons.appendChild(this.getUserButton(this.user.client_id,"viewer","eye")),this.buttons.appendChild(this.getUserButton(this.user.client_id,"promote","promote"))):(this.buttons.appendChild(this.getUserButton(this.user.client_id,"kick","kick")),this.buttons.appendChild(this.getUserButton(this.user.client_id,"player","person"))):!this.is_host&&this.is_self&&(this.is_player?this.buttons.appendChild(this.getUserButton(this.user.client_id,"viewer","eye")):this.buttons.appendChild(this.getUserButton(this.user.client_id,"player","person"))))):console.error("Must set config before attaching to dom")}setConfig(e,t,o,i,n){this.user=e,this.is_host=t,this.is_player=o,this.is_self=i,this.room_launched=n}updatePing(e){this.user.ping=e,this.ping_text.innerText=`${Math.round(e)} ms`,this.ping_image.src=e<100?"/images/icons/ping_good24.png":e<300?"/images/icons/ping_ok24.png":e<1e3?"/images/icons/ping_bad24.png":"/images/icons/ping_empty24.png"}getUserButton(e,t,o){const i=document.createElement("button");i.id=`${t}-button-${e}`,i.classList.add(`${t}-button`);const n=document.createElement("img");return n.src=`/images/icons/${o}18.png`,n.alt=t,n.draggable=!1,i.appendChild(n),i.addEventListener("click",()=>{this.dispatchEvent(new CustomEvent(`${t}_player`,{bubbles:!0,detail:e}))}),i}}customElements.define("dwg-room-user",Se),function(e){e.NOT_STARTED="Game not started",e.LAUNCHING="Game launching ...",e.IN_PROGRESS="Game in progress",e.LAUNCH_CANCELED="Game launch canceled",e.LAUNCH_FAILED="Game launch failed",e.GAME_OVER="Game over"}(ze||(ze={}));class Re extends w.J{constructor(){super(),this.is_host=!1,this.client_id=-1,this.settings_launching=!1,this.renaming_room=!1,this.player_els=new Map,this.viewer_els=new Map,this.htmlString=ae,this.configureElement("room_name"),this.configureElement("chatbox"),this.configureElement("leave_room"),this.configureElement("rename_input"),this.configureElement("rename_room"),this.configureElement("cancel_rename"),this.configureElement("host_container"),this.configureElement("players_container"),this.configureElement("viewers_container"),this.configureElement("settings_title"),this.configureElement("num_players_current"),this.configureElement("num_players_max"),this.configureElement("settings_settings"),this.configureElement("settings_description"),this.configureElement("settings_button_container"),this.configureElement("settings_settings_button"),this.configureElement("settings_launch_button"),this.configureElement("settings_game_status"),this.configureElement("lobby_game_settings"),this.configureElement("game_button_container"),this.configureElement("game_resign_button"),this.configureElement("game_rejoin_button")}getChatbox(){return this.chatbox}parsedCallback(){this.chatbox.setPlaceholder("Chat with room"),this.chatbox.addEventListener("chat_sent",e=>{this.dispatchEvent(new CustomEvent("chat_sent",{detail:e.detail}))}),this.leave_room.addEventListener("click",()=>{this.dispatchEvent(new Event("leave_room"))}),this.rename_room.addEventListener("click",()=>{this.openRename()}),this.cancel_rename.addEventListener("click",()=>{this.cancelRename()}),this.rename_input.addEventListener("keyup",e=>{"Enter"===e.key&&this.submitRename()}),this.settings_settings_button.addEventListener("click",()=>{this.lobby_game_settings.setSettings(this.room.game_settings,this.room.room_description),this.lobby_game_settings.classList.add("show")}),this.lobby_game_settings.addEventListener("saved",()=>{this.dispatchEvent(new CustomEvent("save_settings",{detail:(0,M.oH)(`client-${this.room.host.client_id}`,"room-settings-update",JSON.stringify(this.lobby_game_settings.getSettings()),this.room.room_id.toString())})),this.dispatchEvent(new CustomEvent("save_settings",{detail:(0,M.oH)(`client-${this.room.host.client_id}`,"room-update-description",this.lobby_game_settings.getDescription(),this.room.room_id.toString())})),this.lobby_game_settings.classList.remove("show")}),this.settings_launch_button.addEventListener("click",()=>{if(this.settings_launching)this.setLaunching(!1),this.settings_game_status.innerText=ze.LAUNCH_CANCELED,this.settings_launch_interval_id&&clearInterval(this.settings_launch_interval_id),this.dispatchEvent(new CustomEvent("chat_sent",{detail:{message:"Game launch canceled",sender:S}}));else{this.setLaunching(!0);const e=5;this.dispatchEvent(new CustomEvent("chat_sent",{detail:{message:`Game is launching in ${e} ...`,sender:S}})),this.settings_launch_interval_id=(0,k.gs)(t=>{this.dispatchEvent(new CustomEvent("chat_sent",{detail:{message:e-t+" ...",sender:S}}))},1e3,e-1,()=>{this.dispatchEvent(new CustomEvent("chat_sent",{detail:{message:"Game is launching ...",sender:S}})),this.dispatchEvent(new Event("launch_game")),this.settings_launch_button.disabled=!0})}}),this.game_resign_button.disabled=!0,(0,k.Bd)(this.game_rejoin_button,()=>{this.dispatchEvent(new Event("rejoin_game"))}),this.room_name.classList.add("show"),setInterval(()=>{this.updatePings()},1500)}setLaunching(e){this.settings_launching=e,e?(this.settings_launch_button.innerText="Cancel",this.settings_launch_button.classList.add("launching"),this.settings_game_status.innerText=ze.LAUNCHING,this.settings_settings_button.disabled=!0):(this.settings_launch_button.innerText="Launch",this.settings_launch_button.classList.remove("launching"),this.settings_launch_button.disabled=!1,this.settings_settings_button.disabled=!1)}refreshRoom(e,t){this.setRoom(e,t,this.client_id,!0)}setRoom(e,t,o,i=!1){const n=!!e.game_id;this.is_host=t,this.client_id=o,this.room=e,this.room_name.innerText=e.room_name,this.lobby_game_settings.classList.contains("show")||(this.lobby_game_settings.setSettings(e.game_settings,e.room_description),this.updateSettingsDependencies()),this.num_players_current.innerText=e.players.size.toString(),i&&!n||(this.settings_game_status.innerText=n?ze.IN_PROGRESS:ze.NOT_STARTED),this.classList.add("show"),n?this.game_button_container.classList.remove("hide"):this.game_button_container.classList.add("hide"),this.renaming_room=t&&i&&this.renaming_room,t?(this.rename_room.classList.toggle("show",!this.renaming_room),n?this.settings_button_container.classList.add("hide"):this.settings_button_container.classList.remove("hide")):(this.rename_room.classList.remove("show"),this.settings_button_container.classList.add("hide")),this.setLaunching(this.settings_launching&&i),this.host_el=this.getUserElement(e.host,t,!0),this.host_container.replaceChildren(this.host_el),this.player_els.clear();for(const o of e.players.values())o.client_id!==e.host.client_id&&this.player_els.set(o.client_id,this.getUserElement(o,t,!0));this.players_container.replaceChildren(...this.player_els.values()),this.viewer_els.clear();for(const o of e.viewers.values())this.viewer_els.set(o.client_id,this.getUserElement(o,t,!1));this.viewers_container.replaceChildren(...this.viewer_els.values())}updateSettings(e){this.room&&(this.room.game_settings=e,this.updateSettingsDependencies())}updateSettingsDependencies(){var e,t;if(this.settings_title.innerText=null!==(t=M.ZF[null!==(e=this.room.game_settings.game_type)&&void 0!==e?e:-1])&&void 0!==t?t:"",this.num_players_max.innerText=this.room.game_settings.max_players.toString(),this.room.game_settings.game_specific_settings){const e=[],t=function(e,t){const o=[],i=(e,t)=>{o.push([(0,k.ZH)(e.replace("_"," ")),t.toString()])};for(const[o,n]of Object.entries(e))if(t===M.ZF.FIDDLESTICKS)if("ai_players"===o){const e=n;i("AI Players",e.length);for(const t of e)i("Theory Model 2",t.nickname)}else i(o,n);else i(o,n);return o}(this.room.game_settings.game_specific_settings,this.room.game_settings.game_type);for(const[o,i]of t){const t=document.createElement("div");t.classList.add("setting"),t.classList.add("settings-small"),t.id=`setting-${o}`,t.innerText=`${o}: ${i}`,e.push(t)}this.settings_settings.replaceChildren(...e)}else this.settings_settings.replaceChildren();this.settings_description.innerText=this.room.room_description}getUserElement(e,t,o){const i=document.createElement("dwg-room-user");return i.classList.add("room-user"),i.id=`user-${e.client_id}`,i.setConfig(e,t,o,this.client_id===e.client_id,!!this.room.game_id),i}clearRoom(){this.room=void 0,this.lobby_game_settings.clearSettings(),this.chatbox.clear(),this.classList.remove("show")}inRoom(){return!!this.room}getRoom(){return this.room}renameRoom(e,t){this.room&&(this.room.room_name=e,this.room_name.innerText=e,t===this.room.host.client_id?this.chatbox.addChat({message:`The host has renamed the room to: ${e}`,color:"gray"}):this.room.players.has(t)?this.chatbox.addChat({message:`${this.room.players.get(t).nickname} renamed the room to: ${e}`,color:"gray"}):this.chatbox.addChat({message:`The room has been renamed to: ${e}`,color:"gray"}))}updateRoomDescription(e){this.room&&(this.room.room_description=e,this.settings_description.innerText=e)}hasPlayer(e){return!(!this.classList.contains("show")||!this.room)&&this.room.players.has(e)}getClient(e){if(this.classList.contains("show")&&this.room)return this.room.players.has(e)?this.room.players.get(e):this.room.viewers.get(e)}getPlayer(e){if(this.classList.contains("show")&&this.room)return this.room.players.get(e)}getHost(){if(this.classList.contains("show")&&this.room)return this.room.host}updatePing(e,t){this.room&&this.room.players.has(e)&&(this.room.players.get(e).ping=t)}updatePings(){if(this.room){this.host_el&&this.host_el.updatePing(this.room.host.ping);for(const[e,t]of this.player_els.entries()){const o=this.room.players.get(e);o?t.updatePing(o.ping):t.remove()}for(const[e,t]of this.viewer_els.entries()){const o=this.room.viewers.get(e);o?t.updatePing(o.ping):t.remove()}}}joinRoom(e,t){if(!this.room)return;const o=this.querySelector(`#user-${e.client_id}`);if(o)o.replaceWith(this.getUserElement(e,this.is_host,t));else if(t){const t=this.getUserElement(e,this.is_host,!0);this.player_els.set(e.client_id,t),this.players_container.appendChild(t)}else{const t=this.getUserElement(e,this.is_host,!1);this.viewer_els.set(e.client_id,t),this.viewers_container.appendChild(t)}t?(this.room.players.set(e.client_id,e),this.num_players_current.innerText=this.room.players.size.toString()):this.room.viewers.set(e.client_id,e),this.chatbox.addChat({message:`${e.nickname} (${e.client_id}) joined the room`,color:"gray"})}leaveRoom(e,t){var o;if(this.room)if(this.room.host.client_id===e)this.clearRoom();else{const i=null!==(o=this.room.players.get(e))&&void 0!==o?o:this.room.viewers.get(e);this.room.players.delete(e),this.room.viewers.delete(e),this.num_players_current.innerText=this.room.players.size.toString();const n=this.querySelector(`#user-${e}`);n&&n.remove(),i&&this.chatbox.addChat({message:`${i.nickname} (client id ${i.client_id}) ${t} the room`,color:"gray"})}}promoteUser(e,t){if(!this.room)return;const o=this.room.players.get(e);o&&(this.room.host=o,this.setRoom(this.room,t,this.client_id),this.chatbox.addChat({message:`${o.nickname} (client id ${o.client_id}) was promoted as host of room`,color:"gray"}))}playerToViewer(e){this.room&&this.room.players.has(e)&&(this.room.viewers.set(e,this.room.players.get(e)),this.room.players.delete(e),this.setRoom(this.room,this.is_host,this.client_id))}viewerToPlayer(e){this.room&&this.room.viewers.has(e)&&(this.room.players.set(e,this.room.viewers.get(e)),this.room.viewers.delete(e),this.setRoom(this.room,this.is_host,this.client_id))}launchRoom(e){this.room&&(this.room.game_id=e,this.settings_game_status.innerText=ze.IN_PROGRESS,this.game_button_container.classList.remove("hide"),this.settings_button_container.classList.add("hide"),this.dispatchEvent(new CustomEvent("chat_sent",{detail:{message:"Game launched",sender:S}})))}launchFailed(){this.room&&(this.room.game_id=void 0,this.setLaunching(!1),this.settings_game_status.innerText=ze.LAUNCH_FAILED,this.dispatchEvent(new CustomEvent("chat_sent",{detail:{message:"Game launch failed",sender:S}})))}gameOver(e){this.room&&(this.room.game_id=void 0,this.settings_game_status.innerText=ze.GAME_OVER,this.game_button_container.classList.add("hide"),this.is_host&&(this.settings_launching=!1,this.settings_launch_button.classList.remove("launching"),this.settings_launch_button.innerText="Launch",this.settings_launch_button.disabled=!1,this.settings_settings_button.disabled=!1,this.settings_button_container.classList.remove("hide")),this.dispatchEvent(new CustomEvent("chat_sent",{detail:{message:`Game over: ${e}`,sender:S}})))}openRename(){this.renaming_room=!0,this.rename_room.classList.remove("show"),this.room_name.classList.remove("show"),this.rename_input.value=this.room.room_name,this.rename_input.classList.add("show"),this.cancel_rename.classList.add("show")}cancelRename(){this.renaming_room=!1,this.rename_room.classList.add("show"),this.room_name.classList.add("show"),this.rename_input.classList.remove("show"),this.cancel_rename.classList.remove("show")}submitRename(){this.dispatchEvent(new CustomEvent("rename_room",{detail:this.rename_input.value})),this.cancelRename()}}customElements.define("dwg-lobby-room",Re),i(8498),i(1876);var Te=function(e,t,o,i){return new(o||(o=Promise))(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function r(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(s,r)}l((i=i.apply(e,t||[])).next())})};const Me="room_id";class Ie extends w.J{constructor(){super(),this.connection_metadata={nickname:"Anonymous",ping:0},this.entered_game=!1,this.exited_game=!1,this.waitingOnConnectedTimes=0,this.htmlString=$,this.configureElement("name_container"),this.configureElement("ping_container"),this.configureElement("refresh_lobby_button"),this.configureElement("create_room_button"),this.configureElement("lobby_rooms"),this.configureElement("chatbox"),this.configureElement("lobby_users"),this.configureElement("lobby_room_wrapper"),this.configureElement("lobby_room"),this.configureElement("lobby_users_button"),this.configureElement("lobby_users_backdrop")}getLobbyRoom(){return this.lobby_room}getLobbyRooms(){return this.lobby_rooms}getLobbyUsers(){return this.lobby_users}parsedCallback(){this.chatbox.setPlaceholder("Chat with entire lobby"),(0,k.Bd)(this.refresh_lobby_button,()=>Te(this,void 0,void 0,function*(){yield this.refreshLobbyRooms(!1,!0)})),(0,k.Bd)(this.create_room_button,()=>Te(this,void 0,void 0,function*(){this.socket.send((0,M.oH)(`client-${this.connection_metadata.client_id}`,"room-create"))}),{loading_text:"Creating Room ...",re_enable_button:!1}),this.lobby_rooms.addEventListener("join_room",e=>Te(this,void 0,void 0,function*(){this.socket.send((0,M.oH)(`client-${this.connection_metadata.client_id}`,e.detail.join_as_player?"room-join-player":"room-join-viewer","",e.detail.room_id.toString()))})),this.chatbox.addEventListener("chat_sent",e=>{this.sendChatMessage(this.chatbox,"lobby-chat",Object.assign(Object.assign({},e.detail),{sender:`client-${this.connection_metadata.client_id}`}),this.connection_metadata.nickname)}),this.lobby_room.addEventListener("chat_sent",e=>{var t;const o=e.detail;if(o.message.startsWith("\\l"))o.message=o.message.slice(2).trim(),this.sendChatMessage(this.chatbox,"lobby-chat",Object.assign(Object.assign({},e.detail),{sender:`client-${this.connection_metadata.client_id}`}),this.connection_metadata.nickname);else if(o.message.startsWith("\\u"))o.message=o.message.slice(2).trim();else if(o.message.startsWith("\\g"))o.message=o.message.slice(2).trim(),this.lobby_room.getRoom().game_id?this.socket.send((0,M.oH)(null!==(t=o.sender)&&void 0!==t?t:`game-${this.connection_metadata.client_id}`,"game-chat",o.message,o.color)):this.lobby_room.getChatbox().addChat({message:"Cannot send message to unlaunched game",color:"gray"},!0);else{o.message.startsWith("\\r")&&(o.message=o.message.slice(2).trim());const e=o.sender===S,t=e?o.sender:this.connection_metadata.nickname,i=`room-${this.connection_metadata.room_id}-${this.connection_metadata.client_id}`;o.sender=e?`${i}-${o.sender}`:i,this.sendChatMessage(this.lobby_room.getChatbox(),"room-chat",o,t)}}),this.lobby_room.addEventListener("leave_room",()=>Te(this,void 0,void 0,function*(){var e;this.socket.send((0,M.oH)(`client-${this.connection_metadata.client_id}`,"room-leave","",null===(e=this.connection_metadata.room_id)||void 0===e?void 0:e.toString()))})),this.lobby_room.addEventListener("rename_room",e=>{var t;this.socket.send((0,M.oH)(`client-${this.connection_metadata.client_id}`,"room-rename",e.detail,null===(t=this.connection_metadata.room_id)||void 0===t?void 0:t.toString()))}),this.lobby_room.addEventListener("kick_player",e=>{var t;this.socket.send((0,M.oH)(`client-${this.connection_metadata.client_id}`,"room-kick",e.detail.toString(),null===(t=this.connection_metadata.room_id)||void 0===t?void 0:t.toString()))}),this.lobby_room.addEventListener("viewer_player",e=>{var t;this.socket.send((0,M.oH)(`client-${this.connection_metadata.client_id}`,"room-set-viewer",e.detail.toString(),null===(t=this.connection_metadata.room_id)||void 0===t?void 0:t.toString()))}),this.lobby_room.addEventListener("player_player",e=>{var t;this.socket.send((0,M.oH)(`client-${this.connection_metadata.client_id}`,"room-set-player",e.detail.toString(),null===(t=this.connection_metadata.room_id)||void 0===t?void 0:t.toString()))}),this.lobby_room.addEventListener("promote_player",e=>{var t;this.socket.send((0,M.oH)(`client-${this.connection_metadata.client_id}`,"room-promote",e.detail.toString(),null===(t=this.connection_metadata.room_id)||void 0===t?void 0:t.toString()))}),this.lobby_room.addEventListener("save_settings",e=>{this.socket.send(e.detail)}),this.lobby_room.addEventListener("launch_game",()=>{var e;this.socket.send((0,M.oH)(`client-${this.connection_metadata.client_id}`,"room-launch","",null===(e=this.connection_metadata.room_id)||void 0===e?void 0:e.toString()))}),this.lobby_room.addEventListener("rejoin_game",()=>{this.dispatchEvent(new CustomEvent("rejoin_game",{detail:this.lobby_room.getRoom()}))}),this.lobby_users_button.addEventListener("click",()=>{this.lobby_users.classList.toggle("show"),this.lobby_users_backdrop.classList.toggle("show")}),this.lobby_users_backdrop.addEventListener("click",()=>{this.lobby_users.classList.remove("show"),this.lobby_users_backdrop.classList.remove("show")}),this.refreshLobbyRooms(),this.lobby_users.refreshUsers(),setInterval(()=>{this.pingServer(),this.ping_container.innerText=`ping: ${Math.round(this.connection_metadata.ping)}`},3500)}getChatbox(){return this.chatbox}getCreateRoomButton(){return this.create_room_button}getSocket(){return this.socket}getConnectionMetadata(){return this.connection_metadata}connect(e,t){this.classList.remove("connector-open"),this.setNickname(e),this.setPing(0),this.setSocket(t),this.classList.remove("hide")}setSocket(e){this.socket&&this.socket.close(3e3,"opening new connection"),this.waitingOnConnectedTimes=Ie.DEFAULT_CONNECTION_TIMES,this.socket=e,this.socket.addEventListener("message",e=>{try{!function(e,t){var o,i,n,a,s,r,l,d,c;if(e.socketActive()&&(c=t.kind,!["room","lobby","ping"].every(e=>!c.startsWith(`${e}-`))))switch("ping-update"!==t.kind&&console.log("Lobby message:",t),t.kind){case"lobby-you-joined":const c=t.data.split("-");c.length<2&&(e.getSocket().close(3001,"you-joined-lobby message did not return properly-formed connect data"),e.dispatchEvent(new Event("connection_lost")));const m=parseInt(c[0]);m||(e.getSocket().close(3001,"you-joined-lobby message did not return properly-formed client id"),e.dispatchEvent(new Event("connection_lost")));const g="reconnect"===c[1]?"rejoined":"joined";e.getConnectionMetadata().client_id=m,e.classList.add("connected"),e.setNickname(t.content),e.getChatbox().addChat({message:`You (${t.content}) ${g} v${(0,T.P3)("v")} lobby with client id ${m}`,sender:S}),e.getLobbyUsers().addUser({client_id:m,nickname:e.getConnectionMetadata().nickname,ping:0});try{localStorage.setItem("client_id",t.data),localStorage.setItem("client_nickname",t.content),localStorage.setItem("client_id_time",Date.now().toString())}catch(e){}e.refreshLobbyRooms(!0),e.getLobbyUsers().refreshUsers();break;case"lobby-joined":const h=t.data.split("-");if(h.length<2)break;const u=parseInt(h[0]);if(!u)break;const b="reconnect"===h[1]?"rejoined":"joined";e.getChatbox().addChat({message:`${t.content} ${b} lobby with client id ${u}`,sender:S}),e.refreshLobbyRooms(),e.getLobbyUsers().addUser({client_id:u,nickname:t.content,ping:0});break;case"lobby-left":const p=parseInt(t.data);if(p){e.getChatbox().addChat({message:`${t.content} (client id ${p}) left lobby`,sender:S});const i=e.getLobbyUsers().getUser(p);e.getLobbyUsers().removeUser(p),e.getLobbyRooms().userDisconnected(p),i&&i.room_id===e.getConnectionMetadata().room_id&&i.client_id===(null===(o=e.getLobbyRoom().getHost())||void 0===o?void 0:o.client_id)?e.leaveRoom():e.getLobbyRoom().leaveRoom(p,"disconnected from")}break;case"lobby-chat":const v=parseInt(t.sender.replace("client-",""));v&&e.getChatbox().addChat({message:t.content,sender:null!==(n=null===(i=e.getLobbyUsers().getUser(v))||void 0===i?void 0:i.nickname)&&void 0!==n?n:v.toString(),color:t.data});break;case"ping-update":const _=parseInt(t.data),y=parseInt(t.content);_&&!isNaN(y)&&(e.getConnectionMetadata().client_id===_&&e.setPing(y),e.getLobbyRoom().updatePing(_,y),e.getLobbyUsers().updatePing(_,y));break;case"room-created":const f=(t,o)=>{e.getLobbyRooms().addRoom(t),e.getConnectionMetadata().client_id===o&&(e.enterRoom(t,!0),setTimeout(()=>{e.getCreateRoomButton().innerText="Room Created"},1))};try{const o=parseInt(t.sender.replace("client-","")),i=e.getLobbyUsers().getUser(o),n=JSON.parse(t.content),a=(0,M.VL)(n);i.room_id=a.room_id,f.bind(this,a,o)()}catch(e){parseInt(t.data)}break;case"room-closed":const w=parseInt(t.data);if(w){e.getConnectionMetadata().room_id===w&&e.leaveRoom();const t=null===(a=e.getLobbyRooms().getRoom(w))||void 0===a?void 0:a.data;if(e.getLobbyRooms().removeRoom(w),t)for(const o of t.players.keys())e.getLobbyUsers().leaveRoom(o)}break;case"room-left":const x=parseInt(t.sender.replace("room-","")),k=parseInt(t.data.replace("client-",""));x&&k&&e.userLeftRoom(x,k,"left");break;case"room-joined-player":const E=parseInt(t.sender.replace("room-","")),L=parseInt(t.data.replace("client-","")),z=e.getLobbyUsers().getUser(L),A=e.getLobbyRooms().getRoom(E);E&&L&&z&&A&&(e.getLobbyUsers().joinRoom(L,E),e.getLobbyRooms().playerJoinsRoom(E,z),E===e.getConnectionMetadata().room_id?e.getLobbyRoom().joinRoom(z,!0):L===e.getConnectionMetadata().client_id&&A&&e.enterRoom(null===(s=e.getLobbyRooms().getRoom(E))||void 0===s?void 0:s.data,!1));break;case"room-joined-viewer":const C=parseInt(t.sender.replace("room-","")),R=parseInt(t.data.replace("client-","")),I=e.getLobbyUsers().getUser(R),P=e.getLobbyRooms().getRoom(C);C&&R&&I&&P&&(e.getLobbyUsers().joinRoom(R,C),e.getLobbyRooms().viewerJoinsRoom(C,I),C===e.getConnectionMetadata().room_id?e.getLobbyRoom().joinRoom(I,!1):R===e.getConnectionMetadata().client_id&&P&&e.enterRoom(null===(r=e.getLobbyRooms().getRoom(C))||void 0===r?void 0:r.data,!1));break;case"room-chat":const U=t.sender.split("-");if(U.length<3)break;const $=parseInt(U[1]),j=parseInt(U[2]);if($&&j&&e.getConnectionMetadata().room_id===$&&e.getLobbyRoom().hasPlayer(j)){let o=null!==(d=null===(l=e.getLobbyRoom().getClient(j))||void 0===l?void 0:l.nickname)&&void 0!==d?d:j.toString();U.length>3&&(o=U[3]),e.getLobbyRoom().getChatbox().addChat({message:t.content,sender:o,color:t.data})}break;case"room-renamed":const D=parseInt(t.sender.replace("room-","")),N=parseInt(t.data);D&&N&&(e.getConnectionMetadata().client_id,e.getLobbyRoom().getRoom()&&e.getLobbyRoom().getRoom().room_id===D&&e.getLobbyRoom().renameRoom(t.content,N),e.getLobbyRooms().renameRoom(D,t.content));break;case"room-description-updated":const H=parseInt(t.sender.replace("room-","")),G=parseInt(t.data);H&&G&&(e.getConnectionMetadata().client_id,e.getLobbyRoom().getRoom()&&e.getLobbyRoom().getRoom().room_id===H&&e.getLobbyRoom().updateRoomDescription(t.content),e.getLobbyRooms().updateRoomDescription(H,t.content));break;case"room-kicked":const O=parseInt(t.sender.replace("room-","")),F=parseInt(t.data);O&&F&&e.userLeftRoom(O,F,"was kicked from");break;case"room-promoted":const J=parseInt(t.sender.replace("room-","")),B=parseInt(t.data);J&&B&&(J===e.getConnectionMetadata().room_id&&e.getLobbyRoom().promoteUser(B,B===e.getConnectionMetadata().client_id),e.getLobbyRooms().promoteUser(J,B));break;case"room-viewer-set":const Z=parseInt(t.sender.replace("room-","")),V=parseInt(t.data);Z&&V&&(Z===e.getConnectionMetadata().room_id&&e.getLobbyRoom().playerToViewer(V),e.getLobbyRooms().playerToViewer(Z,V));break;case"room-player-set":const W=parseInt(t.sender.replace("room-","")),K=parseInt(t.data);W&&K&&(W===e.getConnectionMetadata().room_id&&e.getLobbyRoom().viewerToPlayer(K),e.getLobbyRooms().viewerToPlayer(W,K));break;case"room-settings-updated":try{const o=parseInt(t.sender.replace("room-","")),i=JSON.parse(t.data),n=(0,M.T2)(i);e.getLobbyRooms().updateRoomSettings(o,n),o===e.getConnectionMetadata().room_id&&e.getLobbyRoom().updateSettings(n)}catch(e){}break;case"room-launched":const q=parseInt(t.sender.replace("room-","")),Y=parseInt(t.data);q&&Y&&(e.getLobbyRooms().launchRoom(q,Y),q===e.getConnectionMetadata().room_id&&(e.getLobbyRoom().launchRoom(Y),e.dispatchEvent(new CustomEvent("game_launched",{detail:e.getLobbyRoom().getRoom()}))));break;case"room-game-over":const X=parseInt(t.sender.replace("room-",""));X&&(e.getLobbyRooms().gameOver(X),X===e.getConnectionMetadata().room_id&&e.getLobbyRoom().gameOver(t.data));break;case"room-refreshed":try{const o=JSON.parse(t.content),i=(0,M.VL)(o),n=parseInt(t.data);n&&n===i.room_id&&(e.getLobbyRoom().refreshRoom(i,i.host.client_id===e.getConnectionMetadata().client_id),i.game_id&&!e.classList.contains("hide")&&e.canAutoLaunchRoom()&&e.dispatchEvent(new CustomEvent("game_launched",{detail:e.getLobbyRoom().getRoom()})))}catch(e){}break;case"room-join-failed":case"room-refresh-failed":case"room-leave-failed":e.leaveRoom();case"room-rename-failed":case"room-kick-failed":case"room-promote-failed":case"room-set-player-failed":case"room-set-viewer-failed":case"room-settings-updated-failed":case"room-launch-failed":const Q=document.createElement("dwg-message-dialog");Q.setData({message:t.content}),e.appendChild(Q),console.error(t.content),"room-launch-failed"===t.kind&&e.getLobbyRoom().launchFailed();break;default:console.error("Unknown message type",t.kind,"from",t.sender)}}(this,JSON.parse(e.data))}catch(t){console.error("Error parsing message: ",e,t)}})}userLeftRoom(e,t,o){e===this.connection_metadata.room_id&&(this.lobby_room.leaveRoom(t,o),t===this.connection_metadata.client_id&&this.leaveRoom()),this.lobby_users.leaveRoom(t),this.lobby_rooms.clientLeavesRoom(e,t)}socketActive(){return!!this.socket&&this.socket.readyState==WebSocket.OPEN}setNickname(e){this.connection_metadata.nickname=e,this.name_container.innerText=e}setPing(e){this.waitingOnConnectedTimes=Ie.DEFAULT_CONNECTION_TIMES,this.connection_metadata.ping=e}refreshLobbyRooms(){return Te(this,arguments,void 0,function*(e=!1,t=!1){var o,i,n,a;const s=yield this.lobby_rooms.refreshRooms(null!==(o=this.connection_metadata.client_id)&&void 0!==o?o:-1,t);if(e){const e=parseInt((0,T.P3)(Me)),t=null===(i=this.lobby_rooms.getRoom(e))||void 0===i?void 0:i.data;if(t&&(null==s?void 0:s.room_id)!==t.room_id)return void this.socket.send((0,M.oH)(`client-${this.connection_metadata.client_id}`,"room-join","",e.toString()));(0,T.Vr)(Me)}s&&s.room_id!==(null===(n=this.lobby_room.getRoom())||void 0===n?void 0:n.room_id)?this.enterRoom(s,s.host.client_id===(null!==(a=this.connection_metadata.client_id)&&void 0!==a?a:-1)):s?this.exited_game||this.dispatchEvent(new CustomEvent("refresh_game_lobby",{detail:s,bubbles:!0})):this.leaveRoom()})}enterRoom(e,t){this.connection_metadata.room_id=e.room_id,this.lobby_room.setRoom(e,t,this.connection_metadata.client_id),this.lobby_room_wrapper.classList.add("show"),(0,T.Bg)(Me,e.room_id.toString()),e.game_id||(this.exited_game=!1,this.entered_game=!1)}leaveRoom(){this.connection_metadata.room_id=void 0,this.lobby_room_wrapper.classList.remove("show"),this.create_room_button.disabled=!1,this.create_room_button.innerText="Create Room",this.lobby_room.inRoom()&&(this.lobby_room.clearRoom(),(0,T.Vr)(Me))}sendChatMessage(e,t,o,i){let n=!1;o.message=o.message.trim();try{this.socketActive()&&(this.socket.send((0,M.oH)(o.sender,t,o.message,o.color)),n=!0),n?e.addChat(Object.assign(Object.assign({},o),{sender:i}),!0):e.addChat({message:`Message unable to be sent: "${o.message}"`,color:"gray"},!0)}catch(t){e.addChat({message:"Error trying to send message",color:"gray"},!0)}}canAutoLaunchRoom(){return!this.exited_game&&!this.entered_game}enterGame(){this.classList.add("hide"),this.entered_game=!0}exitGame(){this.classList.remove("hide"),this.exited_game=!0}pingServer(){var e,t;this.classList.contains("connector-open")||this.classList.contains("hide")||(this.socketActive()&&this.classList.contains("connected")?(this.waitingOnConnectedTimes--,this.waitingOnConnectedTimes<1?this.dispatchEvent(new Event("connection_lost")):(this.lobby_users.refreshUsers(),this.refreshLobbyRooms(),this.lobby_room_wrapper.classList.contains("show")&&this.socket.send((0,M.oH)(`client-${this.connection_metadata.client_id}`,"room-refresh","",(null!==(t=null===(e=this.lobby_room.getRoom())||void 0===e?void 0:e.room_id)&&void 0!==t?t:0).toString())))):this.dispatchEvent(new Event("connection_lost")))}}Ie.DEFAULT_CONNECTION_TIMES=3,customElements.define("dwg-lobby",Ie),i(5161);var Pe=i(1424),Ue={};Ue.styleTagTransform=p(),Ue.setAttributes=g(),Ue.insert=c().bind(null,"head"),Ue.domAPI=l(),Ue.insertStyleElement=u(),s()(Pe.A,Ue),Pe.A&&Pe.A.locals&&Pe.A.locals;class $e extends w.J{constructor(){super(),this.reconnect_data={nickname:"",try_reconnect:!0,client_id:0},this.invalid_names=[S],this.htmlString='<div id="card"> <div id="reconnect-wrapper"> <div id="previous-nickname"></div> <button id="reconnect-button">Reconnect to Lobby</button> <div id="new-connection-info">If you prefer not to attempt a reconnect but instead want to start a new connection, click the button below</div> <button id="new-connection-button">New Connection</button> </div> <div id="connect-wrapper"> <input id="nickname" placeholder="Nickname"> <button id="connect-button">Connect to Lobby</button> </div> <div id="status-message"></div> </div> ',this.configureElement("reconnect_wrapper"),this.configureElement("previous_nickname"),this.configureElement("reconnect_button"),this.configureElement("new_connection_button"),this.configureElement("connect_wrapper"),this.configureElement("nickname"),this.configureElement("connect_button"),this.configureElement("status_message")}parsedCallback(){return e=this,t=void 0,i=function*(){this.connect_button.disabled=!0;let e=!1;const t=parseInt((0,T.P3)("client_id"));if(t&&t>0)this.previous_nickname.innerHTML=`<em>Client ${t}</em>`,this.reconnect_data={nickname:"!!previous!!",try_reconnect:!0,client_id:t},e=!0;else try{const t=parseInt(localStorage.getItem("client_id_time")),o=parseInt(localStorage.getItem("client_id")),i=localStorage.getItem("client_nickname");i&&this.validateName(i)&&o&&t&&Date.now()-t<864e5&&(this.previous_nickname.innerText=i,this.reconnect_data={nickname:i,try_reconnect:!0,client_id:o},e=!0)}catch(e){}e?this.reconnect_wrapper.classList.add("show"):this.connect_wrapper.classList.add("show"),(yield(0,x.Vg)("ping")).success?(this.nickname.addEventListener("keyup",e=>{this.validateInputName()&&"Enter"===e.key&&this.connect({nickname:this.nickname.value,try_reconnect:!1})}),(0,k.Bd)(this.connect_button,()=>{if(this.validateInputName())return this.connect({nickname:this.nickname.value,try_reconnect:!1}),"Connecting ..."},{re_enable_button:!1}),(0,k.Bd)(this.reconnect_button,()=>(this.connect(this.reconnect_data),"Reconnecting ..."),{re_enable_button:!1}),(0,k.Bd)(this.new_connection_button,()=>{this.reconnect_wrapper.classList.remove("show"),this.connect_wrapper.classList.add("show")})):this.status_message.innerHTML="Cannot connect to server at this time; you can try refreshing the page"},new((o=void 0)||(o=Promise))(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function r(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(s,r)}l((i=i.apply(e,t||[])).next())});var e,t,o,i}tryReconnecting(e,t){this.status_message.innerText=e,this.reconnect_button.disabled=!1,this.reconnect_button.innerText="Reconnect to Lobby",this.connect_button.disabled=!1,this.connect_button.innerText="Reconnect to Lobby",this.reconnect_data.nickname=t.nickname,this.reconnect_data.client_id=t.client_id,this.validateName(this.reconnect_data.nickname)&&this.reconnect_data.client_id?(this.reconnect_wrapper.classList.add("show"),this.connect_wrapper.classList.remove("show")):(this.reconnect_wrapper.classList.remove("show"),this.connect_wrapper.classList.add("show")),this.classList.remove("hide")}connect(e){this.dispatchEvent(new CustomEvent("connect",{detail:e}))}validateInputName(){const e=this.validateName(this.nickname.value);return this.connect_button.disabled=!e,e}validateName(e){return!this.invalid_names.includes(e)&&e.length>1&&e.length<17}}customElements.define("dwg-lobby-connector",$e);var je=function(e,t,o,i){return new(o||(o=Promise))(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function r(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(s,r)}l((i=i.apply(e,t||[])).next())})};class De extends w.J{constructor(){super(),this.client_on_mobile=!1,this.htmlString='<dwg-lobby id="lobby" class="connector-open"></dwg-lobby> <dwg-game id="game"></dwg-game> <dwg-lobby-connector id="lobby-connector"></dwg-lobby-connector>',this.configureElement("lobby"),this.configureElement("game"),this.configureElement("lobby_connector")}parsedCallback(){this.client_on_mobile=(0,k.lO)(),this.client_on_mobile&&document.body.classList.add("mobile"),this.lobby_connector.addEventListener("connect",e=>{const t=e.detail.try_reconnect?new WebSocket(`${(0,x.Lq)()}/reconnect/${e.detail.nickname}/${e.detail.client_id}`):new WebSocket(`${(0,x.Lq)()}/connect/${e.detail.nickname}`);let o=!0;t.addEventListener("error",e=>{console.error(e),this.tryConnectionAgain((o?"Could not connect":"Connection was lost")+". Check your connection and try again.")}),t.addEventListener("open",()=>{o=!1,this.lobby_connector.classList.add("hide"),this.lobby.connect(e.detail.nickname,t),this.game.exitGame(),this.lobby.exitGame()})}),this.lobby.addEventListener("connection_lost",()=>{this.tryConnectionAgain("Connection was lost. Check your connection and try again.")}),this.lobby.addEventListener("game_launched",e=>je(this,void 0,void 0,function*(){(yield this.game.launchGame(e.detail,this.lobby.getSocket(),this.lobby.getConnectionMetadata()))&&this.lobby.classList.add("hide")})),this.lobby.addEventListener("rejoin_game",e=>je(this,void 0,void 0,function*(){(yield this.game.launchGame(e.detail,this.lobby.getSocket(),this.lobby.getConnectionMetadata(),!0))&&this.lobby.enterGame()})),this.lobby.addEventListener("refresh_game_lobby",e=>{var t;this.game&&e.detail&&e.detail.game_id&&(null===(t=this.game)||void 0===t||t.refreshRoom(e.detail))}),this.game.addEventListener("exit_game",()=>{this.game.exitGame(),this.lobby.exitGame()}),this.game.addEventListener("show_message_dialog",e=>{const t=document.createElement("dwg-message-dialog");t.setData(e.detail),this.appendChild(t)}),this.game.addEventListener("connection_lost",e=>{this.tryConnectionAgain(e.detail)})}tryConnectionAgain(e){this.game.exitGame(),this.lobby.exitGame(),this.lobby.classList.remove("connected"),this.lobby.classList.add("connector-open"),this.lobby_connector.tryReconnecting(e,this.lobby.getConnectionMetadata())}}customElements.define("dwg-page-home",De),n=i.O(n)})();